(function(t,i){"object"==typeof exports&&"undefined"!=typeof module?i(exports,require("@aurelia/runtime"),require("@aurelia/kernel")):"function"==typeof define&&define.amd?define(["exports","@aurelia/runtime","@aurelia/kernel"],i):i((t=t||self).router={},t.runtime,t.kernel)})(this,function(t,runtime,kernel){"use strict";function i(t){const i={},s=[];if(!t||!t.length)return{t:i,list:s};const h=t.replace("+"," ").split("&");for(const t of h){const h=t.split("="),e=decodeURIComponent(h.shift());if(!h.length){s.push(e);continue}const value=decodeURIComponent(h.shift());i[e]=value}return{t:i,list:s}}function s(t,i,s,h){var e,n,r=arguments.length,o=3>r?i:null===h?h=Object.getOwnPropertyDescriptor(i,s):h;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,i,s,h);else for(n=t.length-1;n>=0;n--)(e=t[n])&&(o=(3>r?e(o):r>3?e(i,s,o):e(i,s))||o);return r>3&&o&&Object.defineProperty(i,s,o),o}class h{constructor(){this.i=(()=>{if(null!==this.s){const t=this.s;return this.s=null,void t()}const t=this.h(),i=this.o(),s={};let h,e=this.l("HistoryEntry");if(this.u&&this.u.path===t){s.p=1;const t=this.v?this.m.index:this.history.length-this.g;h=this.m,this.m=this.u,this.m.index=t,this.v?(this.$=0,this.O[this.m.index]=this.m,this.j?(s.C=1,this.j=0):this.k?(s.P=1,this.k=0):s.S=1,this.v=0):(this.$=1,this.O=this.O.slice(0,this.m.index),this.O.push(this.m)),this.R({H:this.O,V:this.g,N:this.m})}else this.O=this.O||this.l("HistoryEntries")||[],this.g=this.g||this.l("HistoryOffset")||0,e||this.m?e?this.m?e.index>this.m.index?s.A=1:this.m.index>e.index&&(s.I=1):s.P=1:s.p=1:(s.p=1,s._=1,this.g=this.history.length),e||(this.O=this.O.slice(0,(e={path:t,J:null,index:this.history.length-this.g,L:i}).index),this.O.push(e),this.R({H:this.O,V:this.g,N:e})),this.$=this.m?e.index-this.m.index:0,h=this.m,this.m=e,this.j&&(s.C=1,this.j=0);this.u=null,this.T&&this.T--,this.q(this.m,s,h)}),this.location=window.location,this.history=window.history,this.m=null,this.O=null,this.g=null,this.D=null,this.u=null,this.options=null,this.F=0,this.$=null,this.T=null,this.j=0,this.v=0,this.k=0,this.s=null}U(t){if(this.F)throw Error("History has already been activated.");return this.F=1,this.options=Object.assign({},t),window.addEventListener("popstate",this.i),Promise.resolve().then(()=>{this.B(this.h(),1)})}M(){window.removeEventListener("popstate",this.i),this.F=0}W(t,i,s){this.u={path:t,J:null,title:i,data:s},this.B(t)}replace(t,i,s){this.v=1,this.u={path:t,J:null,title:i,data:s},this.B(t,1)}G(t,i,s){this.T=this.$+1,this.replace(t,i,s)}refresh(){this.m&&(this.k=1,this.replace(this.m.path,this.m.title,this.m.data))}back(){this.history.go(-1)}forward(){this.history.go(1)}cancel(){this.j=1;const t=this.$||this.T;t?this.history.go(-t):this.replace(this.D.path,this.D.title,this.D.data)}async pop(){let t,i=new Promise(t=>{this.s=t});this.history.go(-1),await i;const s=""+this.location;t=this.history.state,i=new Promise(t=>{this.s=t}),this.history.go(-1),await i,this.history.pushState(t,null,s)}R(t,value){const{pathname:i,search:s,hash:h}=this.location;let e=Object.assign({},this.history.state);"string"==typeof t?e[t]=JSON.parse(JSON.stringify(value)):e=Object.assign({},e,JSON.parse(JSON.stringify(t))),this.history.replaceState(e,null,`${i}${s}${h}`)}l(t){return Object.assign({},this.history.state)[t]}K(t){this.m.title=t,this.O[this.m.index]=this.m,this.R({H:this.O,N:this.m})}X(t,i,s){if(s.index!==this.m.index)return;const h=`#/${t}`,{pathname:e,search:n,hash:r}=this.location;if(h===r&&this.m.path===t&&this.m.J===i)return;this.m.path=t,this.m.J=i;const o=Object.assign({},this.history.state,{N:this.m,H:this.O});this.history.replaceState(o,null,`${e}${n}${h}`)}Y(t){t.startsWith("#")||(t=`#${t}`),this.location.hash=t}get Z(){return this.O?this.O.slice(0,this.m.index+1).map(value=>value.title):[]}h(){return this.location.hash.substring(1).split("?")[0]}B(t,i=0){if(this.m&&this.m.path===t&&!this.k)return;const{pathname:s,search:h}=this.location,e=`#${t}`;i?(this.D=this.m,this.history.replaceState({},null,`${s}${h}${e}`)):this.history.pushState({},null,`${s}${h}${e}`),this.i()}o(){const t=this.location.hash.substring(1).split("?");return t.shift(),t.length>0?t.shift():""}q(t,i,s){const h=Object.assign({},t,i);h.tt=s,this.options.q&&this.options.q(h)}}class e{constructor(){this.F=0,this.it=(t=>{const i=e.st(t);i.ht&&(t.preventDefault(),this.options.q(i))}),this.document=document}static st(t){const i={ht:0,href:null,anchor:null},s=e.et(t.target);if(!s||!e.nt(s))return i;if(s.hasAttribute("external"))return i;if(t.altKey||t.ctrlKey||t.metaKey||t.shiftKey)return i;const h=s.getAttribute("href");return i.anchor=s,i.href=h,i.ht=1===t.which,i}static et(t){for(;t;){if("A"===t.tagName)return t;t=t.parentNode}}static nt(t){const i=t.getAttribute("target");return!i||i===e.window.name||"_self"===i}U(t){if(this.F)throw Error("LinkHandler has already been activated.");this.F=1,this.options=Object.assign({},t),this.document.addEventListener("click",this.it,1)}M(){this.document.removeEventListener("click",this.it,1),this.F=0}}class n{constructor(t,i){this.active="",this.rt=t,Object.assign(this,{ot:i.ot,title:i.title,children:null,lt:i.lt,active:""}),this.link=this.ct(this.ot),this.at=i.ut?this.ct(i.ut):this.link,this.ft=this.rt.router.dt.get(runtime.IObserverLocator),this.pt=this.ft.vt(runtime.LifecycleFlags.wt,this.rt.router,"activeComponents"),this.pt.subscribe(this)}get yt(){return this.children&&this.children.length?"nav-has-children":""}bt(){this.active=this.link&&this.link.length?this.gt():"nav-active"===this.active?"nav-active":this.$t()?"nav-active-child":""}gt(){const t=this.at.split(this.rt.router.Ot.add),i=this.rt.router.jt;for(const component of t)if(0>component.indexOf(this.rt.router.Ot.viewport)){if(0>i.findIndex(value=>value.replace(/\@[^=]*/,"")===component))return""}else if(0>i.indexOf(component))return"";return"nav-active"}Ct(){this.active=this.active.startsWith("nav-active")?"":"nav-active"}ct(t){return Array.isArray(t)?t.map(value=>this.kt(value)).join(this.rt.router.Ot.Pt):this.kt(t)}$t(){if(this.children)for(const t of this.children)if(t.active.startsWith("nav-active")||t.$t())return 1;return 0}kt(component){return component?"string"==typeof component?component:component.description?component.description.name:component.component?this.kt(component.component)+(component.viewport?`@${component.viewport}`:""):void 0:""}}class r{constructor(router,name){this.router=router,this.name=name,this.Et=[]}St(t){for(const i of t)this.Rt(this.Et,i)}Rt(t,i){const s=new n(this,i);if(t.push(s),i.children){s.children=[];for(const t of i.children)this.Rt(s.children,t)}}}class o{constructor(router,name,t,i,s,h,e){this.router=router,this.name=name,this.Ht=t,this.context=i,this.Vt=s,this.scope=h,this.options=e,this.clear=0,this.content=null,this.Nt=null,this.t=null,this.xt=null,this.At=null,this.It=null,this.component=null,this._t=null,this.Jt=null,this.Lt=null,this.Tt=0}qt(t,i){let s;if(this.clear=0,"string"==typeof t)if(t===this.router.Ot.clear)this.clear=1,t=null;else{const i=t.split(this.router.Ot.t);t=i.shift(),s=i.length?i.join(this.router.Ot.t):null,this.context&&(t=this.Dt(t))}return this.Nt=t,this.It=i,this.xt=s,this.Tt=0,"string"==typeof t&&this.Ft(this.content)!==t||"string"!=typeof t&&this.content!==t||this.t!==s||!this.At||this.At.L!==i.L||i.P?1:0}zt(t,i,s){this.scope&&this.scope.parent&&!this.scope.viewport&&(this.scope.viewport=this),this.scope&&!this.scope.Ht&&(this.scope.Ht=t),this.Ht!==t&&(this.Lt=Object.assign({},this),this.Ut(),this.Ht=t,s&&s.Bt&&(this.options.Bt=s.Bt),s&&s.default&&(this.options.default=s.default),s&&s.Mt&&(this.options.Mt=s.Mt),s&&s.Wt&&(this.options.Wt=s.Wt),this.Jt&&this.Jt()),this.context!==i&&(this.context=i),this.component||this._t||!this.options.default||this.router.Gt(this,this.options.default)}remove(t,i){return this.Ht===t&&this.context===i}async Kt(){if(!this.component)return 1;const component=this.component;return component.Kt?component.Kt(this.At,this.It):1}async Qt(){if(this.clear)return 1;if(!this.Nt)return 0;if(await this.loadComponent(this.Nt),!this._t)return 0;const component=this._t;return component.Qt?component.Qt(this.It,this.At):1}async Xt(){if(this.clear)return 1;if(!this._t)return 0;if(this._t.Xt){const t=(function(t,s,h){const e=i(s),n=i(t),r=Object.assign({},e.t,n.t),o=[...e.list,...n.list];if(o.length&&h&&h.length)for(const t of h)r[t]=o.shift();let l;return o.length&&Object.keys(r).length&&(r["Yt"]=o.splice(0,o.length)),{Zt:r,ti:o,ii:l=o.length?o:r}})(this.xt,this.It.L,this.Nt.t);this.It.t=t.Zt,this.It.ti=t.ti,await this._t.Xt(t.ii,this.It,this.At),this.Tt=0}return this.si(this._t),1}async hi(){return this.component&&(this.component.ei&&await this.component.ei(this.At,this.It),this._t||(this.ni(this.component),this.ri(this.component),this.oi(this.component))),this._t&&(this.component&&(this.ni(this.component),this.ri(this.component),this.oi(this.component)),this.addComponent(this._t),this.content=this.Nt,this.t=this.xt,this.At=this.It,this.component=this._t),this.clear&&(this.content=this.t=this.component=null,this.At=this.It),this.Nt=this.xt=this.It=this._t=null,1}li(){this.Lt=null}async ci(){this.Tt&&await this._t.ei(),this.Lt&&Object.assign(this,this.Lt)}description(t=0){if(this.content){const component=this.Ft(this.content),i=this.scope?this.router.Ot.ai:"",s=this.t?this.router.Ot.t+this.t:"";if(t||i.length||this.options.ui)return`${component}${this.router.Ot.viewport}${this.name}${i}${s}`;const h={};return h[component]=component,this.Vt.fi(h)?`${component}${s}`:`${component}${this.router.Ot.viewport}${this.name}${i}${s}`}}di(t=0){return[this.Vt.pi(t),this.description(t)].filter(value=>value&&value.length).join(this.router.Ot.scope)}vi(component){let t=this.options.Bt||[];return"string"==typeof t&&(t=t.split(",")),t.indexOf(component)>=0}mi(component){if("-"===component||null===component)return 1;let t=this.options.Bt;return t&&t.length?("string"==typeof t&&(t=t.split(",")),0>t.indexOf(component)?t.filter(value=>value.indexOf("*")>=0).length?1:0:1):1}wi(t){this.component&&this.component.yi(t)}bi(t){this.component&&this.component.gi(t)}$i(t){this.component&&this.component.Oi(t)}ji(t){this.component&&this.component.Ci(t)}Ft(component){return null===component?null:"string"==typeof component?component:component.description.name}Dt(component){if(null===component)return null;if("string"!=typeof component)return component;{const t=this.context||this.router.dt,i=t.get(kernel.IContainer).ki(runtime.CustomElementResource.Pi(component));return null!==i?i.Si(t.get(kernel.IContainer)).Ei:null}}Ri(component){if(null===component)return null;component=this.Ft(component);const t=this.context||this.router.dt;return"string"!=typeof component?t.get(kernel.IContainer).get(component):t.get(kernel.IContainer).get(runtime.CustomElementResource.Pi(component))}Ut(){this.options={},this.content=null,this.t=null,this.At=null,this.component=null}async loadComponent(component){await this.Hi(),this._t=this.Ri(component),this._t.Vi(runtime.LifecycleFlags.wt,this.context||this.router.dt,this.Ht)}oi(component){}si(component){component.yi(runtime.LifecycleFlags.Ni|runtime.LifecycleFlags.xi,null)}ri(component){component.Ci(runtime.LifecycleFlags.Ai|runtime.LifecycleFlags.Ii)}addComponent(component){component.gi(runtime.LifecycleFlags.Ni)}ni(component){component.Oi(runtime.LifecycleFlags.Ai)}async Hi(){return this.Ht?Promise.resolve():new Promise(t=>{this.Jt=t})}}class Scope{constructor(router,t,i,s){this.router=router,this.Ht=t,this.context=i,this.parent=s,this.viewport=null,this.children=[],this._i={},this.Ji={},this.Li=null,this.parent&&this.parent.Ti(this)}fi(t){const i=[];let s=0;t&&(this.Li={},this.Ji={}),this.Li=Object.assign({},this._i,this.Li);for(const i in t){const parts=i.split(this.router.Ot.scope),t=parts.shift();this.Ji[t]||(this.Ji[t]=[]),this.Ji[t].push(parts)}for(const h in this.Ji){const e=h.split(this.router.Ot.t),component=e.shift().split(this.router.Ot.viewport).shift(),n=component+(e.length?this.router.Ot.t+e.join(this.router.Ot.t):"");for(const name in this.Li){const e=this.Li[name];if(e&&e.vi(component)){const r=this.qi(t,this.Ji,h,n,e);i.push(...r.Di),s=s||r.Fi,this.Li[name]=null,Reflect.deleteProperty(this.Ji,h);break}}}for(const h in this.Ji){const e=h.split(this.router.Ot.t),parts=e.shift().split(this.router.Ot.viewport),component=parts.shift(),n=component+(e.length?this.router.Ot.t+e.join(this.router.Ot.t):"");let name=parts.shift();if(!name||!name.length||name.startsWith("?"))continue;let r=0;name.endsWith(this.router.Ot.ai)&&(r=1,name=name.substring(0,name.length-1)),this._i[name]||(this.zi(name,null,null,{scope:r,ui:1}),this.Li[name]=this._i[name]);const o=this.Li[name];if(o&&o.mi(component)){const e=this.qi(t,this.Ji,h,n,o);i.push(...e.Di),s=s||e.Fi,this.Li[name]=null,Reflect.deleteProperty(this.Ji,h)}}for(const h in this.Ji){const e=h.split(this.router.Ot.t),component=e.shift().split(this.router.Ot.viewport).shift(),n=component+(e.length?this.router.Ot.t+e.join(this.router.Ot.t):""),r=[];for(const name in this.Li){const t=this.Li[name];t&&t.mi(component)&&r.push(t)}if(1===r.length){const e=r.shift(),o=this.qi(t,this.Ji,h,n,e);i.push(...o.Di),s=s||o.Fi,this.Li[e.name]=null,Reflect.deleteProperty(this.Ji,h);break}}if(s=s||Object.keys(this.Ji).length>0,!t)for(const t of this.children){const h=t.fi();i.push(...h.Di),s=s||h.Fi}return{Di:i,Fi:s}}qi(t,i,s,component,h){const e=[{component,viewport:h}];let n=0;if(i[s].length){const r=h.scope||h.Vt;for(const h of i[s])if(h.length){const i=h.join(this.router.Ot.scope),o={};o[i]=t[s+this.router.Ot.scope+i];const l=r.fi(o);e.push(...l.Di),n=n||l.Fi}}return{Di:e,Fi:n}}zi(name,t,i,s){let h=this._i[name];if(!h){let e;s.scope&&(e=new Scope(this.router,t,i,this),this.router.Ui.push(e)),h=this._i[name]=new o(this.router,name,t,i,this,e,s)}return(t||i)&&h.zt(t,i,s),h}Bi(t,i,s){return(!i&&!s||t.remove(i,s))&&(t.scope&&this.router.Mi(t.scope),Reflect.deleteProperty(this._i,t.name)),Object.keys(this._i).length}Mi(){for(const t of this.children)t.Mi();for(const t in this._i)this.router.Bi(this._i[t],null,null)}Wi(t){return t.Qt().then(()=>t.hi())}Ti(t){0>this.children.indexOf(t)&&this.children.push(t)}removeChild(t){this.children.splice(this.children.indexOf(t),1)}Gi(t=0,i=0){const s=[];for(const h in this._i){const e=this._i[h];(e.options.Wt||e.options.Mt&&!t)&&!i||s.push(e.di(t))}for(const i of this.children)s.push(...i.Gi(t));return s.filter(value=>value&&value.length)}Ki(){const t=[];for(const i in this._i)t.push(this._i[i]);for(const i of this.children)t.push(...i.Ki());return t}pi(t=0){if(!this.Ht||!this.parent)return"";const i=[];this.viewport&&i.unshift(this.viewport.description(t));let s=this.parent.Qi(this.context.get(kernel.IContainer).parent);for(;s&&s.Vt===this.parent;)i.unshift(s.description(t)),s=this.Qi(s.context.get(kernel.IContainer).parent);return i.unshift(this.parent.pi(t)),i.filter(value=>value&&value.length).join(this.router.Ot.scope)}Qi(t){const i=Object.values(this._i);for(;t;){const s=i.find(i=>i.context.get(kernel.IContainer)===t);if(s)return s;t=t.parent}return null}}class l{constructor(t){this.dt=t,this._i={},this.Ui=[],this.Xi={},this.jt=[],this.Yi=[],this.F=0,this.Zi=0,this.ts=[],this.ss=null,this.hs=(t=>{let i=t.href;if(i.startsWith("#")&&(i=i.substring(1)),!i.startsWith("/")){const s=this.es(t.anchor).pi();s&&(i=`/${s}${this.Ot.scope}${i}`)}this.ns.Y(i)}),this.ns=new h,this.rs=new e}U(t){if(this.F)throw Error("Router has already been activated.");return this.F=1,this.options=Object.assign({q:t=>{this.os(t)}},t),this.Ot=Object.assign({viewport:"@",Pt:"+",scope:"/",ai:"!",t:"=",add:"+",clear:"-",action:"."},this.options.Ot),this.rs.U({q:this.hs}),this.ns.U(this.options).catch(t=>{throw t})}M(){if(!this.F)throw Error("Router has not been activated.");this.rs.M(),this.ns.M()}os(t){this.ts.push(t),this.ls().catch(t=>{throw t})}async ls(){if(null!==this.ss||!this.ts.length)return Promise.resolve();const t=this.ts.shift();if(this.ss=t,this.options.cs&&this.options.cs(t),t.C)return this.ss=null,Promise.resolve();let s=0,h=0;(t.I||t.A)&&t.J&&(t.path=t.J,h=1);let e=t.path;this.options.as&&!h&&(e=this.options.as(e,this),Array.isArray(e)&&(e=this.us(e))),(e===this.Ot.clear||e.startsWith(this.Ot.clear+this.Ot.add))&&(s=1,e.startsWith(this.Ot.clear)&&(e=e.substring(1)));const n=i(t.L);t.t=n.t,t.ti=n.list;const r=this.fs(e);if(!r&&!Object.keys(r).length&&!s)return this.ss=null,Promise.resolve();this.ds();const o=s?this.ps.Ki().filter(value=>null!==value.component):[],l=this.ps.Ki().filter(value=>value.options.default&&null===value.component),c=[];let{Di:a,Fi:u}=this.ps.fi(r),f=100;for(;a.length||u||l.length;){if(!f--)throw Error("Failed to resolve all viewports");const i=[];for(const s of a){const{component,viewport:h}=s;h.qt(component,t)&&i.push(h);const e=o.findIndex(value=>value===h);0>e||o.splice(e,1);const n=l.findIndex(value=>value===h);0>n||l.splice(n,1)}for(const s of o)s.qt(this.Ot.clear,t)&&i.push(s);let s;for(;s=l.shift();)s.qt(s.options.default,t)&&i.push(s);!i.length&&this.Zi&&(this.ns.cancel(),this.Zi=0);let h=await Promise.all(i.map(value=>value.Kt()));if(h.findIndex(value=>0==value)>=0)return this.ns.cancel(),this.ss=null,Promise.resolve();if((h=await Promise.all(i.map(async value=>{const t=await value.Qt();return"boolean"==typeof t?t?value.Xt():0:1}))).some(t=>0==t))return this.ns.cancel(),this.ss=null,Promise.resolve();await Promise.all(i.map(value=>value.hi())),c.push(...i);const e=this.ps.fi();let n;for(a=[];n=this.Yi.shift();)e.Di.find(value=>value.viewport===n.viewport)||a.push(n);a=[...a,...e.Di],u=e.Fi}this.vs(t),!t._&&c.every(t=>t.options.Wt)&&this.ns.pop().catch(t=>{throw t}),c.forEach(t=>{t.li()}),this.ss=null,this.ts.length&&this.ls().catch(t=>{throw t})}Gt(t,component){this.ss&&this.Yi.push({viewport:t,component})}fs(t){const i={};t.startsWith("/")&&(t=t.substring(1));const s=t.split(this.Ot.Pt);let h=0;for(;s.length;){const t=s.shift().split(this.Ot.scope),parts=t.pop().split(this.Ot.viewport),component=parts[0];t.push(parts.length?parts.join(this.Ot.viewport):`?${h++}`);const name=t.join(this.Ot.scope);component&&(i[name]=component)}return i}ms(t){return this.ds(),this.es(t)}zi(name,t,i,s){return this.ms(t).zi(name,t,i,s)}Bi(t,i,s){const h=t.Vt;h.Bi(t,i,s)||this.Mi(h)}Mi(t){if(t!==this.ps){t.Mi();const i=this.Ui.indexOf(t);0>i||this.Ui.splice(i,1)}}W(t,i,s){"string"==typeof t&&this.ns.W(t,i,s)}replace(t,i,s){"string"==typeof t&&this.ns.replace(t,i,s)}refresh(){this.ns.refresh()}back(){this.ns.back()}forward(){this.ns.forward()}us(t){const i=[];for(const s of t){let t=s.component;if(s.viewport&&(t+=this.Ot.viewport+s.viewport),s.t)for(const i in s.t)t+=this.Ot.t+s.t[i];i.push(t)}return i.join(this.Ot.Pt)}ws(t){const i=[],s=t.split(this.Ot.Pt);for(const t of s){let component,s,h;const[e,n]=t.split(this.Ot.viewport);void 0===n?[component,h]=e.split(this.Ot.t):(component=e,[s,h]=n.split(this.Ot.t));const r={component};s&&(r.viewport=s),h&&(r.t={id:h}),i.push(r)}return i}ys(name,t){const i=this.bs(name);i&&(i.Et=[]),this.gs(name,t)}gs(name,t){let i=this.Xi[name];i||(i=this.Xi[name]=new r(this,name)),i.St(t)}bs(name){return this.Xi[name]}ds(){if(!this.ps){const t=this.dt.get(runtime.Aurelia).root();this.ps=new Scope(this,t.$s,t.$context,null),this.Ui.push(this.ps)}}es(t){let i=(function(t){for(;t&&!t.$customElement;)t=t.parentElement;return t})(t).$customElement.$context.get(kernel.IContainer);for(;i;){const t=this.Ui.find(t=>t.context.get(kernel.IContainer)===i);if(t)return t;i=i.parent}}Os(t){let i=t.slice().sort((t,i)=>i.split(this.Ot.scope).length-t.split(this.Ot.scope).length),s=[];if((i=i.map(value=>`${this.Ot.scope}${value}${this.Ot.scope}`)).length)for(s.push(i.shift());i.length;){const t=i.shift();s.find(value=>-1===value.indexOf(t))&&s.push(t)}return(s=s.map(value=>value.substring(1,value.length-1))).sort((t,i)=>t.split(this.Ot.scope).length-i.split(this.Ot.scope).length),s}vs(t){this.jt=this.ps.Gi(1,1),this.jt=this.Os(this.jt);let i=this.ps.Gi(),s=(i=this.Os(i)).join(this.Ot.Pt);this.options.js&&(s=this.options.js(this.ws(s),this));let h=this.ps.Gi(1);(h=this.Os(h)).unshift(this.Ot.clear);const e=t.L&&t.L.length?`?${t.L}`:"";this.ns.X(s+e,h.join(this.Ot.Pt)+e,t)}}l.inject=[kernel.IContainer];class c{constructor(router,t,i){this.router=router,this.Ht=t,this.Cs=i,this.name="default",this.scope=null,this.Bt=null,this.default=null,this.Mt=null,this.Wt=null,this.viewport=null}ks(t,host,parts,i){const s=this.constructor,dom=i.get(runtime.IDOM),template=this.Cs.Ps(dom,s.description,i,s);template.Es=runtime.createRenderContext(dom,i,s.description.dependencies,s),template.ks(this,host,parts)}bound(){const t={scope:this.Ht.hasAttribute("scope")};this.Bt&&this.Bt.length&&(t.Bt=this.Bt),this.default&&this.default.length&&(t.default=this.default),this.Ht.hasAttribute("no-link")&&(t.Mt=1),this.Ht.hasAttribute("no-history")&&(t.Wt=1),this.viewport=this.router.zi(this.name,this.Ht,this.$context,t)}Ss(){this.router.Bi(this.viewport,this.Ht,this.$context)}wi(t){this.viewport&&this.viewport.wi(t)}bi(t){this.viewport&&this.viewport.bi(t)}$i(t){this.viewport&&this.viewport.$i(t)}ji(t){this.viewport&&this.viewport.ji(t)}}c.inject=[l,runtime.INode,runtime.IRenderingEngine],s([runtime.bindable],c.prototype,"name",void 0),s([runtime.bindable],c.prototype,"scope",void 0),s([runtime.bindable],c.prototype,"usedBy",void 0),s([runtime.bindable],c.prototype,"default",void 0),s([runtime.bindable],c.prototype,"noLink",void 0),s([runtime.bindable],c.prototype,"noHistory",void 0),runtime.CustomElementResource.Rs({name:"au-viewport",template:'<template><div class="viewport-header"> Viewport: <b>${name}</b> </div></template>'},c),t.Hs=class{constructor(router){this.router=router,this.name=null,this.Et=null,this.level=0}get Vs(){const t=this.router.bs(this.name);return t?t.Et:[]}active(t){return"Active"}},s([runtime.bindable],t.Hs.prototype,"name",void 0),s([runtime.bindable],t.Hs.prototype,"routes",void 0),s([runtime.bindable],t.Hs.prototype,"level",void 0),t.Hs=s([kernel.inject(l,Element),runtime.customElement({name:"au-nav",template:'<template>\n  <nav if.bind="name" class="${name}">\n    <au-nav routes.bind="navRoutes" containerless></au-nav>\n  </nav>\n  <ul if.bind="routes" class="nav-level-${level}">\n    <li repeat.for="route of routes" class="${route.active} ${route.hasChildren}">\n      <a if.bind="route.link && route.link.length" href="${route.link}">${route.title}</a>\n      <a if.bind="!route.link || !route.link.length" click.delegate="route.toggleActive()" href="">${route.title}</a>\n      <au-nav if.bind="route.children" routes.bind="route.children" level.bind="level + 1" containerless></au-nav>\n    </li>\n  </ul>\n</template>'})],t.Hs),t.Ns=h,t.xs=e,t.As=r,t.Is=l,t.Scope=Scope,t._s=o,t.Js=c,Object.defineProperty(t,"Ls",{value:1})});
