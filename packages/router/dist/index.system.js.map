{"version":3,"file":"index.system.js","sources":["../../../node_modules/tslib/tslib.es6.js","../src/history-browser.ts","../src/link-handler.ts","../src/viewport.ts","../src/scope.ts","../src/router.ts","../src/resources/viewport.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export interface IHistoryEntry {\n  path: string;\n  fullStatePath: string;\n  index?: number;\n  title?: string;\n  data?: Object;\n}\n\nexport interface IHistoryOptions {\n  callback?: Function;\n}\n\nexport interface INavigationFlags {\n  isFirst?: boolean;\n  isNew?: boolean;\n  isRefresh?: boolean;\n  isForward?: boolean;\n  isBack?: boolean;\n  isReplace?: boolean;\n  isCancel?: boolean;\n}\n\nexport interface INavigationInstruction extends IHistoryEntry, INavigationFlags { }\n\nexport class HistoryBrowser {\n  public currentEntry: IHistoryEntry;\n  public historyEntries: IHistoryEntry[];\n  public historyOffset: number;\n  public replacedEntry: IHistoryEntry;\n\n  public history: History;\n  public location: Location;\n\n  private activeEntry: IHistoryEntry = null;\n\n  private options: IHistoryOptions;\n  private isActive: boolean = false;\n\n  private lastHistoryMovement: number;\n  private cancelRedirectHistoryMovement: number;\n  private isCancelling: boolean = false;\n  private isReplacing: boolean = false;\n  private isRefreshing: boolean = false;\n\n  constructor() {\n    this.location = window.location;\n    this.history = window.history;\n  }\n\n  public activate(options?: IHistoryOptions): Promise<void> {\n    if (this.isActive) {\n      throw new Error('History has already been activated.');\n    }\n\n    this.isActive = true;\n    this.options = { ...options };\n\n    window.addEventListener('popstate', this.pathChanged);\n\n    return Promise.resolve().then(() => {\n      this.setPath(this.getPath(), true);\n    });\n  }\n\n  public deactivate(): void {\n    window.removeEventListener('popstate', this.pathChanged);\n    this.isActive = false;\n  }\n\n  public goto(path: string, title?: string, data?: Object): void {\n    this.activeEntry = {\n      path: path,\n      fullStatePath: path,\n      title: title,\n      data: data,\n    };\n    this.setPath(path);\n  }\n\n  public replace(path: string, title?: string, data?: Object): void {\n    this.isReplacing = true;\n    this.activeEntry = {\n      path: path,\n      fullStatePath: path,\n      title: title,\n      data: data,\n    };\n    this.setPath(path, true);\n  }\n  public redirect(path: string, title?: string, data?: Object): void {\n    // This makes sure we can cancel redirects from both pushes and replaces\n    this.cancelRedirectHistoryMovement = this.lastHistoryMovement + 1;\n    this.replace(path, title, data);\n  }\n\n  public refresh(): void {\n    if (!this.currentEntry) {\n      return;\n    }\n    this.isRefreshing = true;\n    this.replace(this.currentEntry.path, this.currentEntry.title, this.currentEntry.data);\n  }\n\n  public back(): void {\n    this.history.go(-1);\n  }\n\n  public forward(): void {\n    this.history.go(1);\n  }\n\n  public cancel(): void {\n    this.isCancelling = true;\n    const movement = this.lastHistoryMovement || this.cancelRedirectHistoryMovement;\n    if (movement) {\n      this.history.go(-movement);\n    } else {\n      this.replace(this.replacedEntry.path, this.replacedEntry.title, this.replacedEntry.data);\n    }\n  }\n\n  public setState(key: string | Object, value?: Object): void {\n    const { pathname, search, hash } = this.location;\n    let state = { ...this.history.state };\n    if (typeof key === 'string') {\n      state[key] = JSON.parse(JSON.stringify(value));\n    } else {\n      state = { ...state, ...JSON.parse(JSON.stringify(key)) };\n    }\n    this.history.replaceState(state, null, `${pathname}${search}${hash}`);\n  }\n\n  public getState(key: string): Object {\n    const state = { ...this.history.state };\n    return state[key];\n  }\n\n  public setEntryTitle(title: string): void {\n    this.currentEntry.title = title;\n    this.historyEntries[this.currentEntry.index] = this.currentEntry;\n    this.setState({\n      'HistoryEntries': this.historyEntries,\n      'HistoryEntry': this.currentEntry,\n    });\n  }\n\n  public replacePath(path: string, fullStatePath: string): void {\n    const newHash = `#/${path}`;\n    const { pathname, search, hash } = this.location;\n    // tslint:disable-next-line:possible-timing-attack\n    if (newHash === hash) {\n      return;\n    }\n    this.currentEntry.path = path;\n    this.currentEntry.fullStatePath = fullStatePath;\n    const state = {\n      ...this.history.state,\n      ...{\n        'HistoryEntry': this.currentEntry,\n        'HistoryEntries': this.historyEntries,\n      }\n    };\n    this.history.replaceState(state, null, `${pathname}${search}${newHash}`);\n  }\n\n  public setHash(hash: string): void {\n    if (!hash.startsWith('#')) {\n      hash = `#${hash}`;\n    }\n    this.location.hash = hash;\n  }\n\n  get titles(): string[] {\n    return (this.historyEntries ? this.historyEntries.slice(0, this.currentEntry.index + 1).map((value) => value.title) : []);\n  }\n\n  public pathChanged = (): void => {\n    const path: string = this.getPath();\n    // tslint:disable-next-line:no-console\n    console.log('path changed to', path, this.activeEntry, this.currentEntry);\n\n    const navigationFlags: INavigationFlags = {};\n\n    let historyEntry: IHistoryEntry = this.getState('HistoryEntry') as IHistoryEntry;\n    if (this.activeEntry && this.activeEntry.path === path) { // Only happens with new history entries (including replacing ones)\n      navigationFlags.isNew = true;\n      const index = (this.isReplacing ? this.currentEntry.index : this.history.length - this.historyOffset);\n      this.currentEntry = this.activeEntry;\n      this.currentEntry.index = index;\n      if (this.isReplacing) {\n        this.lastHistoryMovement = 0;\n        this.historyEntries[this.currentEntry.index] = this.currentEntry;\n        if (this.isCancelling) {\n          navigationFlags.isCancel = true;\n          this.isCancelling = false;\n          // Prevent another cancel by clearing lastHistoryMovement?\n        } else if (this.isRefreshing) {\n          navigationFlags.isRefresh = true;\n          this.isRefreshing = false;\n        } else {\n          navigationFlags.isReplace = true;\n        }\n        this.isReplacing = false;\n      } else {\n        this.lastHistoryMovement = 1;\n        this.historyEntries = this.historyEntries.slice(0, this.currentEntry.index);\n        this.historyEntries.push(this.currentEntry);\n      }\n      this.setState({\n        'HistoryEntries': this.historyEntries,\n        'HistoryOffset': this.historyOffset,\n        'HistoryEntry': this.currentEntry\n      });\n    } else { // Refresh, history navigation, first navigation, manual navigation or cancel\n      this.historyEntries = (this.historyEntries || this.getState('HistoryEntries') || []) as IHistoryEntry[];\n      // tslint:disable-next-line:strict-boolean-expressions\n      this.historyOffset = (this.historyOffset || this.getState('HistoryOffset') || 0) as number;\n      if (!historyEntry && !this.currentEntry) {\n        navigationFlags.isNew = true;\n        navigationFlags.isFirst = true;\n        this.historyOffset = this.history.length;\n      } else if (!historyEntry) {\n        navigationFlags.isNew = true;\n      } else if (!this.currentEntry) {\n        navigationFlags.isRefresh = true;\n      } else if (this.currentEntry.index < historyEntry.index) {\n        navigationFlags.isForward = true;\n      } else if (this.currentEntry.index > historyEntry.index) {\n        navigationFlags.isBack = true;\n      }\n\n      if (!historyEntry) {\n        // TODO: max history length of 50, find better new index\n        historyEntry = {\n          path: path,\n          fullStatePath: path,\n          index: this.history.length - this.historyOffset,\n        };\n        this.historyEntries = this.historyEntries.slice(0, historyEntry.index);\n        this.historyEntries.push(historyEntry);\n        this.setState({\n          'HistoryEntries': this.historyEntries,\n          'HistoryOffset': this.historyOffset,\n          'HistoryEntry': historyEntry\n        });\n      }\n      this.lastHistoryMovement = (this.currentEntry ? historyEntry.index - this.currentEntry.index : 0);\n      this.currentEntry = historyEntry;\n\n      if (this.isCancelling) {\n        navigationFlags.isCancel = true;\n        this.isCancelling = false;\n        // Prevent another cancel by clearing lastHistoryMovement?\n      }\n    }\n    this.activeEntry = null;\n\n    if (this.cancelRedirectHistoryMovement) {\n      this.cancelRedirectHistoryMovement--;\n    }\n\n    // tslint:disable-next-line:no-console\n    console.log('navigated', this.getState('HistoryEntry'), this.historyEntries, this.getState('HistoryOffset'));\n    this.callback(this.currentEntry, navigationFlags);\n  }\n\n  private getPath(): string {\n    return this.location.hash.substr(1);\n  }\n  private setPath(path: string, replace: boolean = false): void {\n    // More checks, such as parameters, needed\n    if (this.currentEntry && this.currentEntry.path === path && !this.isRefreshing) {\n      return;\n    }\n\n    const { pathname, search } = this.location;\n    const hash = `#${path}`;\n    if (replace) {\n      this.replacedEntry = this.currentEntry;\n      this.history.replaceState({}, null, `${pathname}${search}${hash}`);\n    } else {\n      // tslint:disable-next-line:no-commented-code\n      // this.location.hash = hash;\n      this.history.pushState({}, null, `${pathname}${search}${hash}`);\n    }\n    this.pathChanged();\n  }\n\n  private callback(currentEntry: IHistoryEntry, navigationFlags: INavigationFlags): void {\n    const instruction: INavigationInstruction = { ...currentEntry, ...navigationFlags };\n    // tslint:disable-next-line:no-console\n    console.log('callback', currentEntry, navigationFlags);\n    if (this.options.callback) {\n      this.options.callback(instruction);\n    }\n  }\n}\n","/**\n * Provides information about how to handle an anchor event.\n */\nexport interface ILinkHandlerOptions {\n  /**\n   * Callback method for when a link is clicked\n   */\n  callback?: Function;\n}\n\n/**\n * Provides information about how to handle an anchor event.\n */\nexport interface AnchorEventInfo {\n  /**\n   * Indicates whether the event should be handled or not.\n   */\n  shouldHandleEvent: boolean;\n  /**\n   * The href of the link or null if not-applicable.\n   */\n  href: string;\n  /**\n   * The anchor element or null if not-applicable.\n   */\n  anchor: Element;\n}\n\n/**\n * Class responsible for handling interactions that should trigger navigation.\n */\nexport class LinkHandler {\n  private static window: Window;\n\n  private options: ILinkHandlerOptions;\n  private isActive: boolean = false;\n\n  // private handler: EventListener;\n  private document: Document;\n\n  constructor() {\n    this.document = document;\n  }\n  /**\n   * Gets the href and a \"should handle\" recommendation, given an Event.\n   *\n   * @param event The Event to inspect for target anchor and href.\n   */\n  private static getEventInfo(event: Event): AnchorEventInfo {\n    const info = {\n      shouldHandleEvent: false,\n      href: null,\n      anchor: null\n    };\n\n    const target = LinkHandler.findClosestAnchor(event.target as Element);\n    if (!target || !LinkHandler.targetIsThisWindow(target)) {\n      return info;\n    }\n\n    if (target.hasAttribute('external')) {\n      return info;\n    }\n\n    if ((event as MouseEvent).altKey || (event as MouseEvent).ctrlKey || (event as MouseEvent).metaKey || (event as MouseEvent).shiftKey) {\n      return info;\n    }\n\n    const href = target.getAttribute('href');\n    info.anchor = target;\n    info.href = href;\n\n    const leftButtonClicked = (event as MouseEvent).which === 1;\n\n    info.shouldHandleEvent = leftButtonClicked;\n    return info;\n  }\n\n  /**\n   * Finds the closest ancestor that's an anchor element.\n   *\n   * @param el The element to search upward from.\n   * @returns The link element that is the closest ancestor.\n   */\n  private static findClosestAnchor(el: Element): Element {\n    while (el) {\n      if (el.tagName === 'A') {\n        return el;\n      }\n      el = el.parentNode as Element;\n    }\n  }\n\n  /**\n   * Gets a value indicating whether or not an anchor targets the current window.\n   *\n   * @param target The anchor element whose target should be inspected.\n   * @returns True if the target of the link element is this window; false otherwise.\n   */\n  private static targetIsThisWindow(target: Element): boolean {\n    const targetWindow = target.getAttribute('target');\n    const win = LinkHandler.window;\n\n    return !targetWindow ||\n      targetWindow === win.name ||\n      targetWindow === '_self';\n  }\n\n  /**\n   * Activate the instance.\n   *\n   */\n  public activate(options: ILinkHandlerOptions): void {\n    if (this.isActive) {\n      throw new Error('LinkHandler has already been activated.');\n    }\n\n    this.isActive = true;\n    this.options = { ...options };\n\n    this.document.addEventListener('click', this.handler, true);\n  }\n\n  /**\n   * Deactivate the instance. Event handlers and other resources should be cleaned up here.\n   */\n  public deactivate(): void {\n    this.document.removeEventListener('click', this.handler);\n    this.isActive = false;\n  }\n\n  private handler: EventListener = (e) => {\n    const info = LinkHandler.getEventInfo(e);\n\n    if (info.shouldHandleEvent) {\n      e.preventDefault();\n      this.options.callback(info);\n    }\n  }\n}\n","import { PLATFORM } from '@aurelia/kernel';\nimport { CustomElementResource, ICustomElement, ICustomElementType, IDOM, INode, IProjectorLocator, IRenderingEngine, LifecycleFlags } from '@aurelia/runtime';\nimport { INavigationInstruction } from './history-browser';\nimport { Router } from './router';\nimport { Scope } from './scope';\nimport { IViewportOptions } from './viewport';\n\nexport interface IRouteableCustomElement extends ICustomElement {\n  canEnter?: Function;\n  enter?: Function;\n  canLeave?: Function;\n  leave?: Function;\n}\n\nexport interface IViewportOptions {\n  scope?: boolean;\n  usedBy?: string | string[];\n  forceDescription?: boolean;\n}\n\nexport class Viewport {\n  public content: ICustomElementType;\n  public nextContent: ICustomElementType;\n\n  public instruction: INavigationInstruction;\n  public nextInstruction: INavigationInstruction;\n\n  public component: IRouteableCustomElement;\n  public nextComponent: IRouteableCustomElement;\n\n  private clear: boolean = false;\n\n  constructor(private router: Router, public name: string, public element: Element, public owningScope: Scope, public scope: Scope, public options?: IViewportOptions) {\n  }\n\n  public setNextContent(content: ICustomElementType | string, instruction: INavigationInstruction): boolean {\n    this.clear = false;\n    if (typeof content === 'string') {\n      if (content === this.router.separators.clear) {\n        this.clear = true;\n        content = null;\n      } else {\n        const resolver = this.router.container.getResolver(CustomElementResource.keyFrom(content));\n        if (resolver !== null) {\n          content = resolver.getFactory(this.router.container).Type as ICustomElementType;\n        }\n      }\n    }\n\n    this.nextContent = content as ICustomElementType;\n    this.nextInstruction = instruction;\n\n    if (this.content !== content || instruction.isRefresh) {\n      return true;\n    }\n\n    // Add comparisons against path and data here\n\n    return false;\n  }\n\n  public canLeave(): Promise<boolean> {\n    if (!this.component) {\n      return Promise.resolve(true);\n    }\n\n    const component: IRouteableCustomElement = this.component;\n    if (!component.canLeave) {\n      return Promise.resolve(true);\n    }\n    // tslint:disable-next-line:no-console\n    console.log('viewport canLeave', component.canLeave(this.instruction, this.nextInstruction));\n\n    const result = component.canLeave(this.instruction, this.nextInstruction);\n    if (typeof result === 'boolean') {\n      return Promise.resolve(result);\n    }\n    return result;\n  }\n\n  public canEnter(): Promise<boolean> {\n    if (this.clear) {\n      return Promise.resolve(true);\n    }\n\n    if (!this.nextContent) {\n      return Promise.resolve(false);\n    }\n\n    this.loadComponent(this.nextContent);\n    if (!this.nextComponent) {\n      return Promise.resolve(false);\n    }\n\n    const component: IRouteableCustomElement = this.nextComponent;\n    if (!component.canEnter) {\n      return Promise.resolve(true);\n    }\n\n    // tslint:disable-next-line:no-console\n    console.log('viewport canEnter', component.canEnter(this.nextInstruction, this.instruction));\n    const result = component.canEnter(this.nextInstruction, this.instruction);\n    if (typeof result === 'boolean') {\n      return Promise.resolve(result);\n    }\n    return result;\n  }\n\n  public async loadContent(guard?: number): Promise<boolean> {\n    // tslint:disable-next-line:no-console\n    console.log('Viewport loadContent', this.name);\n\n    if (!this.element) {\n      // TODO: Refactor this once multi level recursiveness is fixed\n      await this.waitForElement(50);\n      if (!this.element) {\n        return Promise.resolve(false);\n      }\n    }\n\n    const host: INode = this.element as INode;\n    const container = this.router.container;\n    const dom = container.get(IDOM);\n    const projectorLocator = container.get(IProjectorLocator);\n    const renderingEngine = container.get(IRenderingEngine);\n\n    if (this.component) {\n      if (this.component.leave) {\n        this.component.leave(this.instruction, this.nextInstruction);\n      }\n      this.component.$detach(LifecycleFlags.fromStopTask);\n      this.component.$unbind(LifecycleFlags.fromStopTask | LifecycleFlags.fromUnbind);\n    }\n\n    if (this.nextComponent) {\n      if (this.nextComponent.enter) {\n        this.nextComponent.enter(this.nextInstruction, this.instruction);\n      }\n      this.nextComponent.$hydrate(dom, projectorLocator, renderingEngine, host, null);\n      this.nextComponent.$bind(LifecycleFlags.fromStartTask | LifecycleFlags.fromBind, null);\n      this.nextComponent.$attach(LifecycleFlags.fromStartTask);\n\n      this.content = this.nextContent;\n      this.instruction = this.nextInstruction;\n      this.component = this.nextComponent;\n    }\n\n    if (this.clear) {\n      this.content = this.component = null;\n      this.instruction = this.nextInstruction;\n    }\n\n    this.nextContent = this.nextInstruction = this.nextComponent = null;\n\n    return Promise.resolve(true);\n  }\n\n  public description(full: boolean = false): string {\n    if (this.content) {\n      const component = this.content.description.name;\n      const newScope: string = this.scope ? this.router.separators.ownsScope : '';\n      if (full || newScope.length || this.options.forceDescription) {\n        return `${component}${this.router.separators.viewport}${this.name}${newScope}`;\n      }\n      const viewports = {};\n      viewports[component] = component;\n      const found = this.owningScope.findViewports(viewports);\n      if (!found) {\n        return `${component}${this.router.separators.viewport}${this.name}${newScope}`;\n      }\n      return component;\n    }\n  }\n\n  public scopedDescription(full: boolean = false): string {\n    const descriptions = [this.owningScope.context(full), this.description(full)];\n    return descriptions.filter((value) => value && value.length).join(this.router.separators.scope);\n  }\n\n  // TODO: Deal with non-string components\n  public wantComponent(component: ICustomElementType | string): boolean {\n    let usedBy = this.options.usedBy || [];\n    if (typeof usedBy === 'string') {\n      usedBy = usedBy.split(',');\n    }\n    return usedBy.indexOf(component as string) >= 0;\n  }\n  // TODO: Deal with non-string components\n  public acceptComponent(component: ICustomElementType | string): boolean {\n    if (component === '-' || component === null) {\n      return true;\n    }\n    let usedBy = this.options.usedBy;\n    if (!usedBy || !usedBy.length) {\n      return true;\n    }\n    if (typeof usedBy === 'string') {\n      usedBy = usedBy.split(',');\n    }\n    if (usedBy.indexOf(component as string) >= 0) {\n      return true;\n    }\n    if (usedBy.filter((value) => value.indexOf('*') >= 0).length) {\n      return true;\n    }\n    return false;\n  }\n\n  private loadComponent(component: ICustomElementType): void {\n    this.nextComponent = this.router.container.get<IRouteableCustomElement>(CustomElementResource.keyFrom(component.description.name));\n  }\n\n  private async waitForElement(guard: number): Promise<void> {\n    if (this.element) {\n      return Promise.resolve();\n    }\n    if (!guard) {\n      return Promise.resolve();\n    }\n    await this.wait(100);\n    return this.waitForElement(--guard);\n  }\n\n  private async wait(time: number = 0): Promise<void> {\n    await new Promise((resolve) => {\n      PLATFORM.global.setTimeout(resolve, time);\n    });\n  }\n}\n","import { CustomElementResource, ICustomElementType } from '@aurelia/runtime';\nimport { Router } from './router';\nimport { IFindViewportsResult } from './scope';\nimport { IViewportOptions, Viewport } from './viewport';\n\nexport interface IViewportCustomElementType extends ICustomElementType {\n  viewport?: string;\n}\n\nexport interface IComponentViewport {\n  component: ICustomElementType | string;\n  viewport: Viewport;\n}\n\nexport interface IFindViewportsResult {\n  componentViewports?: IComponentViewport[];\n  viewportsRemaining?: boolean;\n}\n\nexport class Scope {\n  public viewport: Viewport;\n\n  public children: Scope[] = [];\n  public viewports: Object = {};\n\n  private scopeViewportParts: Object = {};\n  private availableViewports: Object;\n\n  constructor(private router: Router, public element: Element, public parent: Scope) {\n    if (this.parent) {\n      this.parent.addChild(this);\n    }\n  }\n\n  public findViewports(viewports?: Object): IFindViewportsResult {\n    const componentViewports: IComponentViewport[] = [];\n    let viewportsRemaining: boolean = false;\n\n    // Get a shallow copy of all available viewports (clean if it's the first find)\n    if (viewports) {\n      this.availableViewports = {};\n      this.scopeViewportParts = {};\n    }\n    this.availableViewports = { ...this.viewports, ...this.availableViewports };\n\n    // Get the parts for this scope (pointing to the rest)\n    for (const viewport in viewports) {\n      const parts = viewport.split(this.router.separators.scope);\n      const vp = parts.shift();\n      if (!this.scopeViewportParts[vp]) {\n        this.scopeViewportParts[vp] = [];\n      }\n      this.scopeViewportParts[vp].push(parts);\n    }\n\n    // Configured viewport is ruling\n    for (const viewportPart in this.scopeViewportParts) {\n      const component = viewportPart.split(this.router.separators.viewport).shift();\n      for (const name in this.availableViewports) {\n        const viewport: Viewport = this.availableViewports[name];\n        // TODO: Also check if (resolved) component wants a specific viewport\n        if (viewport && viewport.wantComponent(component)) {\n          const found = this.foundViewport(viewports, this.scopeViewportParts, viewportPart, component, viewport);\n          componentViewports.push(...found.componentViewports);\n          viewportsRemaining = viewportsRemaining || found.viewportsRemaining;\n          this.availableViewports[name] = null;\n          delete this.scopeViewportParts[viewportPart];\n          break;\n        }\n      }\n    }\n\n    // Next in line is specified viewport\n    for (const viewportPart in this.scopeViewportParts) {\n      const parts = viewportPart.split(this.router.separators.viewport);\n      const component = parts.shift();\n      let name = parts.shift();\n      if (!name || !name.length || name.startsWith('?')) {\n        continue;\n      }\n      let newScope = false;\n      if (name.endsWith(this.router.separators.ownsScope)) {\n        newScope = true;\n        name = name.substr(0, name.length - 1);\n      }\n      if (!this.viewports[name]) {\n        this.addViewport(name, null, { scope: newScope, forceDescription: true });\n        this.availableViewports[name] = this.viewports[name];\n      }\n      const viewport = this.availableViewports[name];\n      if (viewport && viewport.acceptComponent(component)) {\n        const found = this.foundViewport(viewports, this.scopeViewportParts, viewportPart, component, viewport);\n        componentViewports.push(...found.componentViewports);\n        viewportsRemaining = viewportsRemaining || found.viewportsRemaining;\n        this.availableViewports[name] = null;\n        delete this.scopeViewportParts[viewportPart];\n      }\n    }\n\n    // Finally, only one accepting viewport left?\n    for (const viewportPart in this.scopeViewportParts) {\n      const component = viewportPart.split(this.router.separators.viewport).shift();\n      const remainingViewports = [];\n      for (const name in this.availableViewports) {\n        const viewport: Viewport = this.availableViewports[name];\n        if (viewport && viewport.acceptComponent(component)) {\n          remainingViewports.push(viewport);\n        }\n      }\n      if (remainingViewports.length === 1) {\n        const viewport = remainingViewports.shift();\n        const found = this.foundViewport(viewports, this.scopeViewportParts, viewportPart, component, viewport);\n        componentViewports.push(...found.componentViewports);\n        viewportsRemaining = viewportsRemaining || found.viewportsRemaining;\n        this.availableViewports[viewport.name] = null;\n        delete this.scopeViewportParts[viewportPart];\n        break;\n      }\n    }\n\n    viewportsRemaining = viewportsRemaining || Object.keys(this.scopeViewportParts).length > 0;\n\n    // If it's a repeat there might be remaining viewports in scope children\n    if (!viewports) {\n      for (const child of this.children) {\n        const found = child.findViewports();\n        componentViewports.push(...found.componentViewports);\n        viewportsRemaining = viewportsRemaining || found.viewportsRemaining;\n      }\n    }\n\n    return {\n      componentViewports: componentViewports,\n      viewportsRemaining: viewportsRemaining,\n    };\n  }\n\n  public foundViewport(viewports: Object, scopeViewportParts: Object, viewportPart: string, component: ICustomElementType | string, viewport: Viewport): IFindViewportsResult {\n    const componentViewports: IComponentViewport[] = [{ component: component, viewport: viewport }];\n    let viewportsRemaining: boolean = false;\n\n    if (scopeViewportParts[viewportPart].length) {\n      const scope = viewport.scope || viewport.owningScope;\n      for (const remainingParts of scopeViewportParts[viewportPart]) {\n        if (remainingParts.length) {\n          const remaining = remainingParts.join(this.router.separators.scope);\n          const vps = {};\n          vps[remaining] = viewports[viewportPart + this.router.separators.scope + remaining];\n          const scoped = scope.findViewports(vps);\n          componentViewports.push(...scoped.componentViewports);\n          viewportsRemaining = viewportsRemaining || scoped.viewportsRemaining;\n        }\n      }\n    }\n    return {\n      componentViewports: componentViewports,\n      viewportsRemaining: viewportsRemaining,\n    };\n  }\n\n  // public findViewport(name: string): Viewport {\n  //   const parts = name.split(this.router.separators.scope);\n  //   const names = parts.shift().split(this.router.separators.viewport);\n  //   const comp = names.shift();\n  //   name = names.shift();\n  //   let newScope = false;\n  //   if (name.endsWith(this.router.separators.ownsScope)) {\n  //     newScope = true;\n  //     name = name.substr(0, name.length - 1);\n  //   }\n  //   const viewport = this.resolveViewport(name, comp) || this.addViewport(name, null, { scope: newScope });\n  //   if (!parts.length) {\n  //     return viewport;\n  //   } else {\n  //     const scope = viewport.scope || viewport.owningScope;\n  //     return scope.findViewport(parts.join(this.router.separators.scope));\n  //   }\n  // }\n\n  // public resolveViewport(name: string, component: string): Viewport {\n  //   if (name.length && name.charAt(0) !== '?') {\n  //     return this.viewports[name];\n  //   }\n  //   // Need more ways to resolve viewport based on component name!\n  //   const comp = this.resolveComponent(component);\n  //   if (comp.viewport) {\n  //     name = comp.viewport;\n  //     return this.viewports[name];\n  //   }\n  //   return null;\n  // }\n\n  public addViewport(name: string, element: Element, options?: IViewportOptions): Viewport {\n    let viewport = this.viewports[name];\n    if (!viewport) {\n      let scope: Scope;\n      if (options.scope) {\n        scope = new Scope(this.router, element, this);\n        this.router.scopes.push(scope);\n      }\n\n      viewport = this.viewports[name] = new Viewport(this.router, name, element, this, scope, options);\n    }\n    if (element) {\n      // First added viewport with element is always scope viewport (except for root scope)\n      if (viewport.scope && viewport.scope.parent && !viewport.scope.viewport) {\n        viewport.scope.viewport = viewport;\n      }\n      if (viewport.scope && !viewport.scope.element) {\n        viewport.scope.element = element;\n      }\n      if (!viewport.element) {\n        viewport.element = element;\n        if (!viewport.element.children) {\n          this.renderViewport(viewport).catch(error => { throw error; });\n        }\n      }\n    }\n    return viewport;\n  }\n  public removeViewport(viewport: Viewport): number {\n    if (viewport.scope) {\n      this.router.removeScope(viewport.scope);\n    }\n    delete this.viewports[viewport.name];\n    return Object.keys(this.viewports).length;\n  }\n\n  public removeScope(): void {\n    for (const child of this.children) {\n      child.removeScope();\n    }\n    for (const viewport in this.viewports) {\n      this.router.removeViewport(this.viewports[viewport]);\n    }\n  }\n\n  public renderViewport(viewport: Viewport): Promise<boolean> {\n    return viewport.canEnter().then(() => viewport.loadContent());\n  }\n\n  public addChild(child: Scope): void {\n    if (this.children.indexOf(child) < 0) {\n      this.children.push(child);\n    }\n  }\n  public removeChild(child: Scope): void {\n    this.children.splice(this.children.indexOf(child), 1);\n  }\n\n  public viewportStates(full: boolean = false): string[] {\n    const states: string[] = [];\n    for (const viewport in this.viewports) {\n      states.push((this.viewports[viewport] as Viewport).scopedDescription(full));\n    }\n    for (const scope of this.children) {\n      states.push(...scope.viewportStates(full));\n    }\n    return states.filter((value) => value && value.length);\n  }\n\n  public allViewports(): Viewport[] {\n    const viewports: Viewport[] = [];\n    for (const viewport in this.viewports) {\n      viewports.push(this.viewports[viewport]);\n    }\n    for (const scope of this.children) {\n      viewports.push(...scope.allViewports());\n    }\n    return viewports;\n  }\n\n  public context(full: boolean = false): string {\n    if (!this.element || !this.parent) {\n      return '';\n    }\n    const parents: string[] = [];\n    if (this.viewport) {\n      parents.unshift(this.viewport.description(full));\n    }\n    let viewport: Viewport = this.parent.closestViewport(this.element.parentElement);\n    while (viewport && viewport.owningScope === this.parent) {\n      parents.unshift(viewport.description(full));\n      viewport = this.closestViewport(viewport.element.parentElement);\n    }\n    parents.unshift(this.parent.context(full));\n\n    return parents.filter((value) => value && value.length).join(this.router.separators.scope);\n  }\n\n  private resolveComponent(component: ICustomElementType | string): IViewportCustomElementType {\n    if (typeof component === 'string') {\n      const resolver = this.router.container.getResolver(CustomElementResource.keyFrom(component));\n      if (resolver !== null) {\n        component = resolver.getFactory(this.router.container).Type as ICustomElementType;\n      }\n    }\n    return component as ICustomElementType;\n  }\n\n  // This is not an optimal way of doing this\n  private closestViewport(element: Element): Viewport {\n    let closest: number = Number.MAX_SAFE_INTEGER;\n    let viewport: Viewport;\n    for (const vp in this.viewports) {\n      const viewportElement = this.viewports[vp].element;\n      let el = element;\n      let i = 0;\n      while (el) {\n        if (el === viewportElement) {\n          break;\n        }\n        i++;\n        el = el.parentElement;\n      }\n      if (i < closest) {\n        closest = i;\n        viewport = this.viewports[vp];\n      }\n    }\n    return viewport;\n  }\n}\n","import { IContainer } from '@aurelia/kernel';\nimport { Aurelia, ICustomElementType } from '@aurelia/runtime';\nimport { HistoryBrowser, IHistoryEntry, IHistoryOptions, INavigationInstruction } from './history-browser';\nimport { AnchorEventInfo, LinkHandler } from './link-handler';\nimport { Scope } from './scope';\nimport { IViewportOptions, Viewport } from './viewport';\n\nexport interface IRouterOptions extends IHistoryOptions {\n  reportCallback?: Function;\n  separators?: IRouteSeparators;\n}\n\nexport interface IRoute {\n  name?: string;\n  path: string;\n  redirect?: string;\n  title?: string;\n  viewports?: Object;\n  meta?: Object;\n}\n\nexport interface IRouteViewport {\n  name: string;\n  component: ICustomElementType | string;\n}\n\nexport interface IRouteSeparators {\n  viewport: string;\n  sibling: string;\n  scope: string;\n  ownsScope: string;\n  parameters: string;\n  add: string;\n  clear: string;\n  action: string;\n}\n\nexport class Router {\n  public static readonly inject: ReadonlyArray<Function> = [IContainer];\n\n  public routes: IRoute[] = [];\n  public viewports: Object = {};\n\n  public rootScope: Scope;\n  public scopes: Scope[] = [];\n\n  public separators: IRouteSeparators;\n\n  public historyBrowser: HistoryBrowser;\n  public linkHandler: LinkHandler;\n\n  private options: IRouterOptions;\n  private isActive: boolean = false;\n  private isRedirecting: boolean = false;\n\n  constructor(public container: IContainer) {\n    this.historyBrowser = new HistoryBrowser();\n    this.linkHandler = new LinkHandler();\n  }\n\n  public activate(options?: IRouterOptions): Promise<void> {\n    if (this.isActive) {\n      throw new Error('Router has already been activated.');\n    }\n\n    this.isActive = true;\n    this.options = {\n      ...{\n        callback: (navigationInstruction) => {\n          this.historyCallback(navigationInstruction).catch(error => { throw error; });\n        }\n      }, ...options\n    };\n\n    this.separators = {\n      ... {\n        viewport: '@', // ':',\n        sibling: '+', // '/',\n        scope: '/', // '+',\n        ownsScope: '!',\n        parameters: '=',\n        add: '+',\n        clear: '-',\n        action: '.',\n      }, ...this.options.separators\n    };\n\n    this.linkHandler.activate({ callback: this.linkCallback });\n    return this.historyBrowser.activate(this.options).catch(error => { throw error; });\n  }\n\n  public deactivate(): void {\n    if (!this.isActive) {\n      throw new Error('Router has not been activated.');\n    }\n    this.linkHandler.deactivate();\n    this.historyBrowser.deactivate();\n    return;\n  }\n\n  public linkCallback = (info: AnchorEventInfo): void => {\n    let href = info.href;\n    if (href.startsWith('#')) {\n      href = href.substr(1);\n    }\n    if (!href.startsWith('/')) {\n      const scope = this.closestScope(info.anchor);\n      const context = scope.context();\n      if (context) {\n        href = `/${context}${this.separators.scope}${href}`;\n      }\n    }\n    this.historyBrowser.setHash(href);\n  }\n\n  public async historyCallback(instruction: INavigationInstruction): Promise<void> {\n    if (this.options.reportCallback) {\n      this.options.reportCallback(instruction);\n    }\n\n    if (instruction.isCancel) {\n      return Promise.resolve();\n    }\n\n    let clearViewports: boolean = false;\n    if (instruction.isBack || instruction.isForward) {\n      instruction.path = instruction.fullStatePath;\n    }\n    const path = instruction.path;\n    if (path === this.separators.clear || path.startsWith(this.separators.clear + this.separators.add)) {\n      clearViewports = true;\n      if (path.startsWith(this.separators.clear)) {\n        instruction.path = path.substr(1);\n      }\n    }\n\n    let title;\n    let views: Object;\n    let route: IRoute = this.findRoute(instruction);\n    if (route) {\n      if (route.redirect) {\n        route = this.resolveRedirect(route, instruction.data);\n        this.isRedirecting = true;\n        this.historyBrowser.redirect(route.path, route.title, instruction.data);\n        return Promise.resolve();\n      }\n\n      if (route.title) {\n        title = route.title;\n      }\n\n      views = route.viewports;\n    } else {\n      views = this.findViews(instruction);\n    }\n\n    if (!views && !Object.keys(views).length && !clearViewports) {\n      return Promise.resolve();\n    }\n\n    if (title) {\n      this.historyBrowser.setEntryTitle(title);\n    }\n\n    const usedViewports = (clearViewports ? this.rootScope.allViewports().filter((value) => value.component !== null) : []);\n\n    // TODO: Take care of cancellations down in subsets/iterations\n    let { componentViewports, viewportsRemaining } = this.rootScope.findViewports(views);\n    let guard = 100;\n    while (componentViewports.length || viewportsRemaining) {\n      // Guard against endless loop\n      if (!guard--) {\n        break;\n      }\n      const changedViewports: Viewport[] = [];\n      for (const componentViewport of componentViewports) {\n        const { component, viewport } = componentViewport;\n        if (viewport.setNextContent(component, instruction)) {\n          changedViewports.push(viewport);\n        }\n        const usedIndex = usedViewports.findIndex((value) => value === viewport);\n        if (usedIndex >= 0) {\n          usedViewports.splice(usedIndex, 1);\n        }\n      }\n      for (const viewport of usedViewports) {\n        if (viewport.setNextContent(this.separators.clear, instruction)) {\n          changedViewports.push(viewport);\n        }\n      }\n\n      // We've gone via a redirected route back to same viewport status so\n      // we need to remove the added history entry for the redirect\n      // TODO: Take care of empty subsets/iterations where previous has length\n      if (!changedViewports.length && this.isRedirecting) {\n        this.historyBrowser.cancel();\n        this.isRedirecting = false;\n      }\n\n      let results = await Promise.all(changedViewports.map((value) => value.canLeave()));\n      if (results.findIndex((value) => value === false) >= 0) {\n        this.historyBrowser.cancel();\n        return Promise.resolve();\n      }\n      results = await Promise.all(changedViewports.map((value) => value.canEnter()));\n      if (results.findIndex((value) => value === false) >= 0) {\n        this.historyBrowser.cancel();\n        return Promise.resolve();\n      }\n      results = await Promise.all(changedViewports.map((value) => value.loadContent()));\n      // TODO: Remove this once multi level recursiveness has been fixed\n      // if (results.findIndex((value) => value === false) >= 0) {\n      //   this.historyBrowser.cancel();\n      //   return Promise.resolve();\n      // }\n\n      // TODO: Fix multi level recursiveness!\n      const remaining = this.rootScope.findViewports();\n      componentViewports = remaining.componentViewports;\n      viewportsRemaining = remaining.viewportsRemaining;\n    }\n    // TODO: Make sure replace paths isn't called on wrong (later) navigation\n    this.replacePaths();\n  }\n\n  // public view(views: Object, title?: string, data?: Object): Promise<void> {\n  //   console.log('Router.view:', views, title, data);\n\n  // tslint:disable-next-line:no-commented-code\n  //   if (title) {\n  //     this.historyBrowser.setEntryTitle(title);\n  //   }\n\n  // tslint:disable-next-line:no-commented-code\n  //   const viewports: Viewport[] = [];\n  //   for (const v in views) {\n  //     const component: ICustomElementType = views[v];\n  //     const viewport = this.findViewport(`${v}:${component}`);\n  //     if (viewport.setNextContent(component, { path: '' })) {\n  //       viewports.push(viewport);\n  //     }\n  //   }\n\n  // tslint:disable-next-line:no-commented-code\n  //   // We've gone via a redirected route back to same viewport status so\n  //   // we need to remove the added history entry for the redirect\n  //   if (!viewports.length && this.isRedirecting) {\n  //     this.historyBrowser.cancel();\n  //     this.isRedirecting = false;\n  //   }\n\n  // tslint:disable-next-line:no-commented-code\n  //   let cancel: boolean = false;\n  //   return Promise.all(viewports.map((value) => value.canLeave()))\n  //     .then((promises: boolean[]) => {\n  //       if (cancel || promises.findIndex((value) => value === false) >= 0) {\n  //         cancel = true;\n  //         return Promise.resolve([]);\n  //       } else {\n  //         return Promise.all(viewports.map((value) => value.canEnter()));\n  //       }\n  //     }).then((promises: boolean[]) => {\n  //       if (cancel || promises.findIndex((value) => value === false) >= 0) {\n  //         cancel = true;\n  //         return Promise.resolve([]);\n  //       } else {\n  //         return Promise.all(viewports.map((value) => value.loadContent()));\n  //       }\n  //     }).then(() => {\n  //       if (cancel) {\n  //         this.historyBrowser.cancel();\n  //       }\n  //     }).then(() => {\n  //       const viewports = Object.values(this.viewports).map((value) => value.description()).filter((value) => value && value.length);\n  //       this.historyBrowser.history.replaceState({}, null, '#/' + viewports.join('/'));\n  //     });\n  // }\n\n  public findRoute(entry: IHistoryEntry): IRoute {\n    return this.routes.find((value) => value.path === entry.path);\n  }\n  public resolveRedirect(route: IRoute, data?: Object): IRoute {\n    while (route.redirect) {\n      const redirectRoute: IRoute = this.findRoute({\n        path: route.redirect,\n        fullStatePath: route.redirect,\n        data: data,\n      });\n      if (redirectRoute) {\n        route = redirectRoute;\n      } else {\n        break;\n      }\n    }\n    return route;\n  }\n\n  public findViews(entry: IHistoryEntry): Object {\n    const views: Object = {};\n    let path = entry.path;\n    // TODO: Let this govern start of scope\n    if (path.startsWith('/')) {\n      path = path.substr(1);\n    }\n    let sections: string[] = path.split(this.separators.sibling);\n\n    // TODO: Remove this once multi level recursiveness is fixed\n    // Expand with instances for all containing views\n    // const expandedSections: string[] = [];\n    // while (sections.length) {\n    //   const part = sections.shift();\n    //   const parts = part.split(this.separators.scope);\n    //   for (let i = 1; i <= parts.length; i++) {\n    //     expandedSections.push(parts.slice(0, i).join(this.separators.scope));\n    //   }\n    // }\n    // sections = expandedSections;\n\n    let index = 0;\n    while (sections.length) {\n      const view = sections.shift();\n      // TODO: implement parameters\n      // As a = part at the end of the view!\n      const scopes = view.split(this.separators.scope);\n      const leaf = scopes.pop();\n      const parts = leaf.split(this.separators.viewport);\n      // Noooooo?\n      const component = parts[0];\n      scopes.push(parts.length ? parts.join(this.separators.viewport) : `?${index++}`);\n      const name = scopes.join(this.separators.scope);\n      if (component) {\n        views[name] = component;\n      }\n    }\n    return views;\n  }\n\n  // public findViewport(name: string): Viewport {\n  //   return this.rootScope.findViewport(name);\n  // }\n\n  public findScope(element: Element): Scope {\n    if (!this.rootScope) {\n      const aureliaRootElement = this.container.get(Aurelia).root().$host;\n      this.rootScope = new Scope(this, aureliaRootElement as Element, null);\n      this.scopes.push(this.rootScope);\n    }\n    return this.closestScope(element);\n  }\n\n  // Called from the viewport custom element in attached()\n  public addViewport(name: string, element: Element, options?: IViewportOptions): Viewport {\n    // tslint:disable-next-line:no-console\n    console.log('Viewport added', name, element);\n    const parentScope = this.findScope(element);\n    return parentScope.addViewport(name, element, options);\n  }\n  // Called from the viewport custom element\n  public removeViewport(viewport: Viewport): void {\n    // TODO: There's something hinky with remove!\n    const scope = viewport.owningScope;\n    if (!scope.removeViewport(viewport)) {\n      this.removeScope(scope);\n    }\n  }\n\n  public removeScope(scope: Scope): void {\n    if (scope !== this.rootScope) {\n      scope.removeScope();\n      const index = this.scopes.indexOf(scope);\n      if (index >= 0) {\n        this.scopes.splice(index, 1);\n      }\n    }\n  }\n\n  public addRoute(route: IRoute): void {\n    this.routes.push(route);\n  }\n\n  public goto(pathOrViewports: string | Object, title?: string, data?: Object): void {\n    if (typeof pathOrViewports === 'string') {\n      this.historyBrowser.goto(pathOrViewports, title, data);\n    }\n    // else {\n    //   this.view(pathOrViewports, title, data);\n    // }\n  }\n\n  public replace(pathOrViewports: string | Object, title?: string, data?: Object): void {\n    if (typeof pathOrViewports === 'string') {\n      this.historyBrowser.replace(pathOrViewports, title, data);\n    }\n  }\n\n  public refresh(): void {\n    this.historyBrowser.refresh();\n  }\n\n  public back(): void {\n    this.historyBrowser.back();\n  }\n\n  public forward(): void {\n    this.historyBrowser.forward();\n  }\n\n  private closestScope(element: Element): Scope {\n    let closest: number = Number.MAX_SAFE_INTEGER;\n    let scope: Scope;\n    for (const sc of this.scopes) {\n      let el = element;\n      let i = 0;\n      while (el) {\n        if (el === sc.element) {\n          break;\n        }\n        i++;\n        el = el.parentElement;\n      }\n      if (i < closest) {\n        closest = i;\n        scope = sc;\n      }\n    }\n    return scope;\n  }\n\n  private removeStateDuplicates(states: string[]): string[] {\n    let sorted: string[] = states.slice().sort((a, b) => b.split(this.separators.scope).length - a.split(this.separators.scope).length);\n    sorted = sorted.map((value) => `${this.separators.scope}${value}${this.separators.scope}`);\n\n    let unique: string[] = [];\n    if (sorted.length) {\n      unique.push(sorted.shift());\n      while (sorted.length) {\n        const state = sorted.shift();\n        if (unique.find((value) => {\n          return value.indexOf(state) === -1;\n        })) {\n          unique.push(state);\n        }\n      }\n    }\n    unique = unique.map((value) => value.substring(1, value.length - 1));\n    unique.sort((a, b) => a.split(this.separators.scope).length - b.split(this.separators.scope).length);\n\n    return unique;\n  }\n\n  private replacePaths(): void {\n    let viewportStates = this.rootScope.viewportStates();\n    viewportStates = this.removeStateDuplicates(viewportStates);\n    let fullViewportStates = this.rootScope.viewportStates(true);\n    fullViewportStates = this.removeStateDuplicates(fullViewportStates);\n    fullViewportStates.unshift(this.separators.clear);\n    this.historyBrowser.replacePath(viewportStates.join(this.separators.sibling), fullViewportStates.join(this.separators.sibling));\n  }\n}\n","import { bindable, CustomElementResource, INode } from '@aurelia/runtime';\nimport { Router } from '../router';\nimport { IViewportOptions, Viewport } from '../viewport';\n\nexport class ViewportCustomElement {\n  public static readonly inject: ReadonlyArray<Function> = [Router, INode];\n\n  @bindable public name: string = 'default';\n  @bindable public scope: boolean;\n  @bindable public usedBy: string;\n\n  public viewport: Viewport;\n\n  constructor(private router: Router, private element: Element) { }\n\n  public attached(): void {\n    const options: IViewportOptions = { scope: this.element.hasAttribute('scope') };\n    if (this.usedBy && this.usedBy.length) {\n      options.usedBy = this.usedBy;\n    }\n    this.viewport = this.router.addViewport(this.name, this.element, options);\n  }\n  public unbound(): void {\n    this.router.removeViewport(this.viewport);\n  }\n}\n// tslint:disable-next-line:no-invalid-template-strings\nCustomElementResource.define({ name: 'au-viewport', template: '<template><div class=\"viewport-header\"> Viewport: <b>${name}</b> </div></template>' }, ViewportCustomElement);\n"],"names":["tslib_1.__decorate"],"mappings":"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"}