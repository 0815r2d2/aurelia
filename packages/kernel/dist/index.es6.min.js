function createResolver(e){return function(n){const Key=function Key(e,n,t){DI.inject(Key)(e,n,t)};return Key.resolve=function(t,i){return e(n,t,i)},Key}}function transientDecorator(e){return DI.transient(e)}function transient(e){return void 0===e?transientDecorator:transientDecorator(e)}function singletonDecorator(e){return DI.singleton(e)}function singleton(e){return void 0===e?singletonDecorator:singletonDecorator(e)}function isRegistry(e){return"function"==typeof e.register}function validateKey(e){if(null==e||e===Object)throw Reporter.error(5)}function buildAllResponse(e,n,t){if(e instanceof Resolver&&4===e.strategy){const i=e.state;let o=i.length;const r=Array(o);for(;o--;)r[o]=i[o].resolve(n,t);return r}return[e.resolve(n,t)]}function invokeWithDynamicDependencies(e,n,t,i){let o,r=t.length,l=Array(r);for(;r--;){if(null==(o=t[r]))throw Reporter.error(7,`Index ${r}.`);l[r]=e.get(o)}return void 0!==i&&(l=l.concat(i)),Reflect.construct(n,l)}const $global=(function(){if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;try{return Function("","return this")()}catch(e){return{}}})(),$now=(function(){let e,n,t,i,o,r;if(null!=$global.performance&&$global.performance.now){const e=$global.performance;return function(){return e.now()}}if(null!=$global.process&&$global.process.t){const t=function(){return(e()-o)/1e6};return n=$global.process.t,i=(e=function(){let e;return 1e9*(e=n())[0]+e[1]})(),r=1e9*$global.process.i(),o=i-r,t}if(Date.now){const e=function(){return Date.now()-t};return t=Date.now(),e}{const e=function(){return(new Date).getTime()-t};return t=(new Date).getTime(),e}})(),$raf=(function(){const e=["moz","webkit"],n="AnimationFrame";let t=$global[`request${n}`],i=$global[`cancel${n}`]||$global[`cancelRequest${n}`];for(let o=0;!t&&2>o;++o)t=$global[`${e[o]}Request${n}`],i=$global[`${e[o]}Cancel${n}`]||$global[`${e[o]}CancelRequest${n}`];if(!t||!i){let e=0,n=0;const o=[],r=1e3/60;t=function(t){let i,l;return 0===o.length&&(i=$now(),e=(l=Math.max(0,r-(i-e)))+i,setTimeout(function(){const n=o.slice(0);o.length=0;for(let t=0;n.length>t;++t)if(!n[t].o)try{n[t].l(e)}catch(e){setTimeout(function(){throw e},0)}},Math.round(l))),o.push({s:++n,l:t,o:0}),n},i=function(e){for(let n=0;o.length>n;++n)o[n].s===e&&(o[n].o=1)}}const o=function(e){return t.call($global,e)};return o.cancel=function(){i.apply($global,arguments)},$global.requestAnimationFrame=t,$global.cancelAnimationFrame=i,o})(),camelCaseLookup={},kebabCaseLookup={},PLATFORM={global:$global,u:Object.freeze([]),h:Object.freeze({}),v(){},now:$now,R(e){let value=camelCaseLookup[e];if(void 0!==value)return value;value="";let n,t=1,i=0;for(let o=0,r=e.length;r>o;++o)"-"===(n=e.charAt(o))||"."===n||"_"===n?i=1:(value+=t?n.toLowerCase():i?n.toUpperCase():n,i=0),t=0;return camelCaseLookup[e]=value},D(e){let value=kebabCaseLookup[e];if(void 0!==value)return value;value="";let n,t,i=1;for(let o=0,r=e.length;r>o;++o)t=(n=e.charAt(o)).toLowerCase(),value+=i?t:n!==t?`-${t}`:t,i=0;return kebabCaseLookup[e]=value},toArray(e){const n=e.length,t=Array(n);for(let i=0;n>i;++i)t[i]=e[i];return t},requestAnimationFrame:e=>$raf(e),clearInterval(e){$global.clearInterval(e)},clearTimeout(e){$global.clearTimeout(e)},setInterval:(e,n,...t)=>$global.setInterval(e,n,...t),setTimeout:(e,n,...t)=>$global.setTimeout(e,n,...t)},Reporter={write(e,...n){},error:e=>Error(`Code ${e}`)},Tracer={enabled:0,k:0,$:null,m(name,e){},g(){},I(e){},p(e){},C(e){},L(){}};"getOwnMetadata"in Reflect||(Reflect.W=function(e,n){return n[e]},Reflect.A=function(e,n){return function(t){t[e]=n}});const DI={O:()=>new Container,F:e=>Reflect.W("design:paramtypes",e)||PLATFORM.u,M(e){let dependencies;if(void 0===e.inject)dependencies=DI.F(e);else{dependencies=[];let n=e;for(;"function"==typeof n;)n.hasOwnProperty("inject")&&dependencies.push(...n.inject),n=Object.getPrototypeOf(n)}return dependencies},q(e){const Key=function(n,t,i){if(void 0===n)throw Reporter.error(16,Key);return Key.K=e||"Interface",(n.inject||(n.inject=[]))[i]=Key,n};return Key.S=function(){return Key},Key.j=function(e){return Key.j=function(){throw Reporter.error(17,Key)},Key.register=function(n,t){const i=t||Key;return e({T:value=>n._(i,new Resolver(i,0,value)),singleton:value=>n._(i,new Resolver(i,1,value)),transient:value=>n._(i,new Resolver(i,2,value)),l:value=>n._(i,new Resolver(i,3,value)),B:e=>n._(i,new Resolver(i,5,e))})},Key},Key},inject:(...dependencies)=>(function(e,n,t){if("number"==typeof t){if(!e.hasOwnProperty("inject")){const n=DI.F(e);e.inject=n.slice()}1===dependencies.length&&(e.inject[t]=dependencies[0])}else if(n){const t=e.constructor;(t.inject||(t.inject={}))[n]=dependencies[0]}else if(t)t.value.inject=dependencies;else if(0===dependencies.length){const n=DI.F(e);e.inject=n.slice()}else e.inject=dependencies}),transient:e=>(e.register=function(n){return Registration.transient(e,e).register(n,e)},e),singleton:e=>(e.register=function(n){return Registration.singleton(e,e).register(n,e)},e)},IContainer=DI.q("IContainer").S(),IServiceLocator=IContainer,inject=DI.inject,all=createResolver((e,n,t)=>t.getAll(e)),lazy=createResolver((e,n,t)=>{let i=null;return()=>(null===i&&(i=t.get(e)),i)}),optional=createResolver((e,n,t)=>t.has(e,1)?t.get(e):null);class Resolver{constructor(e,strategy,n){this.key=e,this.strategy=strategy,this.state=n}register(e,n){return e._(n||this.key,this)}resolve(e,n){switch(this.strategy){case 0:return this.state;case 1:{this.strategy=0;const n=e.G(this.state);return this.state=n.construct(e)}case 2:return e.G(this.state).construct(n);case 3:return this.state(e,n,this);case 4:return this.state[0].resolve(e,n);case 5:return e.get(this.state);default:throw Reporter.error(6,this.strategy)}}G(e){switch(this.strategy){case 1:case 2:return e.G(this.state);default:return null}}}class Factory{constructor(e,n,dependencies){this.H=e,this.J=n,this.dependencies=dependencies,this.N=null}static create(e){const dependencies=DI.M(e);return new Factory(e,classInvokers[dependencies.length]||fallbackInvoker,dependencies)}construct(e,n){const t=this.N;let i=void 0!==n?this.J.U(e,this.H,this.dependencies,n):this.J.V(e,this.H,this.dependencies);if(null===t)return i;for(let e=0,n=t.length;n>e;++e)i=t[e](i);return i}X(e){return null===this.N&&(this.N=[]),this.N.push(e),1}}const containerResolver={resolve:(e,n)=>n};class Container{constructor(e={}){this.parent=null,this.Y=new Map,this.Z=e,this.P=e.P||(e.P=new Map),this.ee=e.ee||(e.ee=Object.create(null)),this.Y.set(IContainer,containerResolver)}register(...e){for(let n=0,t=e.length;t>n;++n){const t=e[n];if(isRegistry(t))t.register(this);else{const e=Object.keys(t);for(let n=0,i=e.length;i>n;++n){const value=t[e[n]];isRegistry(value)?value.register(this):this.register(value)}}}}_(e,n){validateKey(e);const t=this.Y,i=t.get(e);return void 0===i?(t.set(e,n),"string"==typeof e&&(this.ee[e]=n)):i instanceof Resolver&&4===i.strategy?i.state.push(n):t.set(e,new Resolver(e,4,[i,n])),n}X(e,n){const t=this.ne(e);if(null===t)return 0;if(t.G){const e=t.G(this);return null===e?0:e.X(n)}return 0}ne(e,n=1){if(validateKey(e),e.resolve)return e;let t=this;for(;null!==t;){const i=t.Y.get(e);if(void 0!==i)return i;if(null===t.parent)return n?this.te(e,t):null;t=t.parent}return null}has(e,n=0){return this.Y.has(e)?1:n&&null!==this.parent?this.parent.has(e,1):0}get(e){if(validateKey(e),e.resolve)return e.resolve(this,this);let n=this;for(;null!==n;){let t=n.Y.get(e);if(void 0!==t)return t.resolve(n,this);if(null===n.parent)return(t=this.te(e,n)).resolve(n,this);n=n.parent}}getAll(e){validateKey(e);let n=this;for(;null!==n;){const t=n.Y.get(e);if(void 0!==t)return buildAllResponse(t,n,this);if(null===this.parent)return PLATFORM.u;n=n.parent}return PLATFORM.u}G(e){let n=this.P.get(e);return void 0===n&&(n=Factory.create(e),this.P.set(e,n)),n}ie(){const e=this.Z,n={P:e.P,ee:Object.assign({},e.ee)},t=new Container(n);return t.parent=this,t}te(e,n){if(e.register){const t=e.register(n,e);if(!t||!t.resolve)throw Reporter.error(40);return t}const t=new Resolver(e,1,e);return n.Y.set(e,t),t}}const Registration={T:(e,value)=>new Resolver(e,0,value),singleton:(e,value)=>new Resolver(e,1,value),transient:(e,value)=>new Resolver(e,2,value),l:(e,n)=>new Resolver(e,3,n),oe:(e,n)=>new Resolver(n,5,e),re:(e,...n)=>({register(t){const i=t.ne(e);if(null!==i){let e=null;if(i.G){const o=i.G(t);null!==o&&(e=o.construct(t,n))}else e=i.resolve(t,t);null!==e&&e.register(t)}}})},classInvokers=[{V:(e,n)=>new n,U:invokeWithDynamicDependencies},{V:(e,n,t)=>new n(e.get(t[0])),U:invokeWithDynamicDependencies},{V:(e,n,t)=>new n(e.get(t[0]),e.get(t[1])),U:invokeWithDynamicDependencies},{V:(e,n,t)=>new n(e.get(t[0]),e.get(t[1]),e.get(t[2])),U:invokeWithDynamicDependencies},{V:(e,n,t)=>new n(e.get(t[0]),e.get(t[1]),e.get(t[2]),e.get(t[3])),U:invokeWithDynamicDependencies},{V:(e,n,t)=>new n(e.get(t[0]),e.get(t[1]),e.get(t[2]),e.get(t[3]),e.get(t[4])),U:invokeWithDynamicDependencies}],fallbackInvoker={V:invokeWithDynamicDependencies,U:invokeWithDynamicDependencies};class RuntimeCompilationResources{constructor(e){this.context=e}find(e,name){const n=e.le(name),t=this.context.ee;let i=t[n];if(void 0===i&&(i=t[n]=this.context.ne(n,0)),null!==i&&i.G){const e=i.G(this.context);if(null!==e){const n=e.H.description;return void 0===n?null:n}}return null}create(e,name){const n=e.le(name),t=this.context.ee;let i=t[n];if(void 0===i&&(i=t[n]=this.context.ne(n,0)),null!==i){const e=i.resolve(this.context,this.context);return void 0===e?null:e}return null}}export{all,DI,IContainer,inject,IServiceLocator,lazy,optional,Registration,singleton,transient,PLATFORM,Reporter,Tracer,RuntimeCompilationResources};
