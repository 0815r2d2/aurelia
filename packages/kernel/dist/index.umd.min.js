(function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.t?define(["exports"],n):n((t=t||self).kernel={})})(this,function(t){"use strict";function n(){}function e(t){return function(n){const e=function(t,n,i){DI.inject(e)(t,n,i)};return e.resolve=function(e,i){return t(n,e,i)},e}}function i(t){return DI.transient(t)}function s(t){return DI.singleton(t)}function r(t){return"function"==typeof t.register}function l(t){if(null==t||t===Object)throw Reporter.error(5)}function u(t,n,e){if(t instanceof R&&4===t.strategy){const i=t.state;let s=i.length;const r=Array(s);for(;s--;)r[s]=i[s].resolve(n,e);return r}return[t.resolve(n,e)]}function o(t,n,e,i){let s,r=e.length,l=Array(r);for(;r--;){if(null==(s=e[r]))throw Reporter.error(7,`Index ${r}.`);l[r]=t.get(s)}return void 0!==i&&(l=l.concat(i)),Reflect.construct(n,l)}const h=(function(){if("undefined"!=typeof global)return global;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;try{return Function("","return this")()}catch(t){return{}}})(),c=(function(){let t,n,e,i,s;if(null!=h.performance&&h.performance.now){const t=h.performance;return function(){return t.now()}}if(null!=h.process&&h.process.i){const r=function(){return(t()-i)/1e6};return n=h.process.i,e=(t=function(){let t;return 1e9*(t=n())[0]+t[1]})(),s=1e9*h.process.s(),i=e-s,r}})(),{l:f,u:a,o:w,h:v,v:m,m:d}=(function(){if(null!=h.performance&&h.performance.mark&&h.performance.measure&&h.performance.getEntriesByName&&h.performance.getEntriesByType&&h.performance.clearMarks&&h.performance.clearMeasures){const t=h.performance;return{l(name){t.mark(name)},u(name,n,e){t.measure(name,n,e)},o:name=>t.getEntriesByName(name),h:type=>t.getEntriesByType(type),v(name){t.clearMarks(name)},m(name){t.clearMeasures(name)}}}if(null!=h.process&&h.process.i){const t=[],n={},e=function(n,value){let e=0;const i=t.length,s=[];for(;i>e;e++)t[e][n]===value&&s.push(t[e]);return s},i=function(type,name){let n,e=t.length;for(;e--;)(n=t[e]).entryType!==type||void 0!==name&&n.name!==name||t.splice(e,1)};return{l(name){const e={name,entryType:"mark",startTime:c(),duration:0};t.push(e),n[name]=e},u(name,e,i){let s,r;if(void 0!==i&&void 0===n[i])throw new SyntaxError(`Failed to execute 'measure' on 'Performance': The mark '${i}' does not exist.`);if(void 0!==e&&void 0===n[e])throw new SyntaxError(`Failed to execute 'measure' on 'Performance': The mark '${e}' does not exist.`);s=n[e]?n[e].startTime:0,r=n[i]?n[i].startTime:c(),t.push({name,entryType:"measure",startTime:s,duration:r-s})},o:name=>e("name",name),h:type=>e("entryType",type),v(name){i("mark",name)},m(name){i("measure",name)}}}})(),{$,k}=(function(){const t=["moz","webkit"],n="AnimationFrame";let e=h[`request${n}`],i=h[`cancel${n}`]||h[`cancelRequest${n}`];for(let s=0;!e&&2>s;++s)e=h[`${t[s]}Request${n}`],i=h[`${t[s]}Cancel${n}`]||h[`${t[s]}CancelRequest${n}`];if(!e||!i){let t=0,n=0;const s=[],r=1e3/60;e=function(e){let i,l;return 0===s.length&&(i=c(),t=(l=Math.max(0,r-(i-t)))+i,setTimeout(function(){const n=s.slice(0);s.length=0;for(let e=0;n.length>e;++e)if(!n[e].M)try{n[e].R(t)}catch(t){setTimeout(function(){throw t},0)}},Math.round(l))),s.push({A:++n,R:e,M:0}),n},i=function(t){for(let n=0;s.length>n;++n)s[n].A===t&&(s[n].M=1)}}const s=function(t){return e.call(h,t)};return s.cancel=function(){i.apply(h,arguments)},h.requestAnimationFrame=e,h.cancelAnimationFrame=i,{$:s,k:i}})();class b{constructor(t,n=null){this.C=t,this.context=n,this.next=null,this.O=null,this.B=0}W(t,n){return this.C===t&&this.context===(void 0===n?null:n)}q(t){null!==this.C&&(null!==this.context?this.C.call(this.context,t):this.C(t));const n=this.next;return this.B&&(this.next=null),n}connect(t){this.O=t,null!==t.next&&(t.next.O=this),this.next=t.next,t.next=this}disconnect(t=0){this.B=1,this.C=null,this.context=null,null!==this.O&&(this.O.next=this.next),null!==this.next&&(this.next.O=this.O);const n=this.next;return this.next=t?null:n,this.O=null,n}}const y={},E={},PLATFORM={global:h,L:new class{constructor(){this.head=new b(null,null),this.p=-1,this.F=1,this.N=-1,this.j=0,this.T=null,this.resolve=n,this._=(t=>{this.p=-1,this.j&&(this.update(t),this.j&&-1===this.p&&null!==this.head.next&&(this.p=$(this._))),this.resolve(t),this.resolve=n,this.T=null})}add(t,n){const e=new b(t,n);let i=this.head.next,s=this.head;if(null===i)e.connect(s);else{for(;null!==i;)s=i,i=i.next;null===e.O&&e.connect(s)}return this.j?this.g():this.start(),this}remove(t,n){let e=this.head.next;for(;null!==e;)e=e.W(t,n)?e.disconnect():e.next;return null===this.head.next&&this.S(),this}start(){this.j||(this.j=1,this.g())}stop(){this.j&&(this.j=0,this.S())}update(t=c()){let n;if(t>this.N){this.F=~~(60*(n=t-this.N)+.5)/1e3;const e=this.head;let i=e.next;for(;null!==i;)i=i.q(this.F);null===e.next&&this.S()}else this.F=0;this.N=t}D(){return null===this.T&&(this.T=new Promise(t=>{this.resolve=t})),this.T}g(){-1===this.p&&null!==this.head.next&&(this.N=c(),this.p=$(this._))}S(){-1!==this.p&&(k(this.p),this.p=-1)}},G:Object.freeze([]),H:Object.freeze({}),I:n,now:c,mark:f,measure:a,getEntriesByName:w,getEntriesByType:v,clearMarks:m,clearMeasures:d,J(t){let value=y[t];if(void 0!==value)return value;value="";let n,e=1,i=0;for(let s=0,r=t.length;r>s;++s)"-"===(n=t.charAt(s))||"."===n||"_"===n?i=1:(value+=e?n.toLowerCase():i?n.toUpperCase():n,i=0),e=0;return y[t]=value},K(t){let value=E[t];if(void 0!==value)return value;value="";let n,e,i=1;for(let s=0,r=t.length;r>s;++s)e=(n=t.charAt(s)).toLowerCase(),value+=i?e:n!==e?`-${e}`:e,i=0;return E[t]=value},toArray(t){const n=t.length,e=Array(n);for(let i=0;n>i;++i)e[i]=t[i];return e},requestAnimationFrame:t=>$(t),clearInterval(t){h.clearInterval(t)},clearTimeout(t){h.clearTimeout(t)},setInterval:(t,n,...e)=>h.setInterval(t,n,...e),setTimeout:(t,n,...e)=>h.setTimeout(t,n,...e)},Reporter={write(t,...n){},error:t=>Error(`Code ${t}`)},Tracer={enabled:0,U:0,V:null,X(name,t){},Y(){},Z(t){},P(t){},tt(t){},nt(){}};"getOwnMetadata"in Reflect||(Reflect.et=function(t,n){return n[t]},Reflect.it=function(t,n){return function(e){e[t]=n}});const DI={st(...t){return 0===arguments.length?new O:(new O).register(...t)},rt:t=>Reflect.et("design:paramtypes",t)||PLATFORM.G,lt(t){let dependencies;if(void 0===t.inject)dependencies=DI.rt(t);else{dependencies=[];let n=t;for(;"function"==typeof n;)n.hasOwnProperty("inject")&&dependencies.push(...n.inject),n=Object.getPrototypeOf(n)}return dependencies},ut(t){const n=function(e,i,s){if(n.ot=t||"Interface",void 0===e)throw Reporter.error(16,n.ot,n);return(e.inject||(e.inject=[]))[s]=n,e};return n.ht=function(){return n},n.ct=function(t){return n.ct=function(){throw Reporter.error(17,n)},n.register=function(e,i){const s=i||n;return t({ft:value=>e.at(s,new R(s,0,value)),singleton:value=>e.at(s,new R(s,1,value)),transient:value=>e.at(s,new R(s,2,value)),R:value=>e.at(s,new R(s,3,value)),wt:t=>e.at(s,new R(s,5,t))})},n},n},inject:(...dependencies)=>(function(t,n,e){if("number"==typeof e){if(!t.hasOwnProperty("inject")){const n=DI.rt(t);t.inject=n.slice()}1===dependencies.length&&(t.inject[e]=dependencies[0])}else if(n){const e=t.constructor;(e.inject||(e.inject={}))[n]=dependencies[0]}else if(e)e.value.inject=dependencies;else if(0===dependencies.length){const n=DI.rt(t);t.inject=n.slice()}else t.inject=dependencies}),transient:t=>(t.register=function(n){return Registration.transient(t,t).register(n,t)},t),singleton:t=>(t.register=function(n){return Registration.singleton(t,t).register(n,t)},t)},IContainer=DI.ut("IContainer").ht(),IServiceLocator=IContainer,inject=DI.inject,all=e((t,n,e)=>e.getAll(t)),lazy=e((t,n,e)=>{let i=null;return()=>(null===i&&(i=e.get(t)),i)}),optional=e((t,n,e)=>e.has(t,1)?e.get(t):null);var M;(function(t){t[t.ft=0]="instance",t[t.singleton=1]="singleton",t[t.transient=2]="transient",t[t.R=3]="callback",t[t.vt=4]="array",t[t.dt=5]="alias"})(M||(M={}));class R{constructor(t,strategy,n){this.key=t,this.strategy=strategy,this.state=n}register(t,n){return t.at(n||this.key,this)}resolve(t,n){switch(this.strategy){case 0:return this.state;case 1:{this.strategy=0;const n=t.$t(this.state);return this.state=n.construct(t)}case 2:return t.$t(this.state).construct(n);case 3:return this.state(t,n,this);case 4:return this.state[0].resolve(t,n);case 5:return t.get(this.state);default:throw Reporter.error(6,this.strategy)}}$t(t){switch(this.strategy){case 1:case 2:return t.$t(this.state);default:return null}}}class A{constructor(t,n,dependencies){this.kt=t,this.bt=n,this.dependencies=dependencies,this.yt=null}static create(t){const dependencies=DI.lt(t);return new A(t,B[dependencies.length]||W,dependencies)}construct(t,n){const e=this.yt;let i=void 0!==n?this.bt.Et(t,this.kt,this.dependencies,n):this.bt.Mt(t,this.kt,this.dependencies);if(null===e)return i;for(let t=0,n=e.length;n>t;++t)i=e[t](i);return i}Rt(t){return null===this.yt&&(this.yt=[]),this.yt.push(t),1}}const C={resolve:(t,n)=>n};class O{constructor(t={}){this.parent=null,this.At=new Map,this.Ct=t,this.Ot=t.Ot||(t.Ot=new Map),this.Bt=t.Bt||(t.Bt=Object.create(null)),this.At.set(IContainer,C)}register(...t){for(let n=0,e=t.length;e>n;++n){const e=t[n];if(r(e))e.register(this);else{const t=Object.keys(e);for(let n=0,i=t.length;i>n;++n){const value=e[t[n]];r(value)?value.register(this):this.register(value)}}}return this}at(t,n){l(t);const e=this.At,i=e.get(t);return void 0===i?(e.set(t,n),"string"==typeof t&&(this.Bt[t]=n)):i instanceof R&&4===i.strategy?i.state.push(n):e.set(t,new R(t,4,[i,n])),n}Rt(t,n){const e=this.Wt(t);if(null===e)return 0;if(e.$t){const t=e.$t(this);return null===t?0:t.Rt(n)}return 0}Wt(t,n=1){if(l(t),t.resolve)return t;let e=this;for(;null!==e;){const i=e.At.get(t);if(void 0!==i)return i;if(null===e.parent)return n?this.qt(t,e):null;e=e.parent}return null}has(t,n=0){return this.At.has(t)?1:n&&null!==this.parent?this.parent.has(t,1):0}get(t){if(l(t),t.resolve)return t.resolve(this,this);let n=this;for(;null!==n;){let e=n.At.get(t);if(void 0!==e)return e.resolve(n,this);if(null===n.parent)return(e=this.qt(t,n)).resolve(n,this);n=n.parent}}getAll(t){l(t);let n=this;for(;null!==n;){const e=n.At.get(t);if(void 0!==e)return u(e,n,this);if(null===this.parent)return PLATFORM.G;n=n.parent}return PLATFORM.G}$t(t){let n=this.Ot.get(t);return void 0===n&&(n=A.create(t),this.Ot.set(t,n)),n}xt(){const t=this.Ct,n={Ot:t.Ot,Bt:Object.assign({},t.Bt)},e=new O(n);return e.parent=this,e}qt(t,n){if(t.register){const e=t.register(n,t);if(!e||!e.resolve)throw Reporter.error(40);return e}const e=new R(t,1,t);return n.At.set(t,e),e}}const Registration={ft:(t,value)=>new R(t,0,value),singleton:(t,value)=>new R(t,1,value),transient:(t,value)=>new R(t,2,value),R:(t,n)=>new R(t,3,n),dt:(t,n)=>new R(n,5,t),Lt:(t,...n)=>({register(e){const i=e.Wt(t);if(null!==i){let t=null;if(i.$t){const s=i.$t(e);null!==s&&(t=s.construct(e,n))}else t=i.resolve(e,e);null!==t&&t.register(e)}}})},B=[{Mt:(t,n)=>new n,Et:o},{Mt:(t,n,e)=>new n(t.get(e[0])),Et:o},{Mt:(t,n,e)=>new n(t.get(e[0]),t.get(e[1])),Et:o},{Mt:(t,n,e)=>new n(t.get(e[0]),t.get(e[1]),t.get(e[2])),Et:o},{Mt:(t,n,e)=>new n(t.get(e[0]),t.get(e[1]),t.get(e[2]),t.get(e[3])),Et:o},{Mt:(t,n,e)=>new n(t.get(e[0]),t.get(e[1]),t.get(e[2]),t.get(e[3]),t.get(e[4])),Et:o}],W={Mt:o,Et:o},Profiler=(function(){const t=PLATFORM.now,n=[];let e;const i={pt(name){n.push(name);let i=0,s=0;return{X(){1==++i&&(s=t(),++e[name].Ft),++e[name].Nt},Y(){0==--i&&(e[name].duration+=t()-s)}}},enable(){e={};for(const t of n)e[t]={name:t,duration:0,Ft:0,Nt:0};i.enabled=1},disable(){i.enabled=0},jt(t){Object.keys(e).map(t=>e[t]).sort((t,n)=>n.duration-t.duration).forEach(n=>{t(n.name,n.duration,n.Ft,n.Nt)})},enabled:0};return i})();t.all=all,t.DI=DI,t.IContainer=IContainer,t.inject=inject,t.IServiceLocator=IServiceLocator,t.lazy=lazy,t.optional=optional,t.Registration=Registration,t.singleton=function(t){return void 0===t?s:s(t)},t.transient=function(t){return void 0===t?i:i(t)},t.PLATFORM=PLATFORM,t.Reporter=Reporter,t.Tracer=Tracer,t.Profiler=Profiler,t.RuntimeCompilationResources=class{constructor(t){this.context=t}find(t,name){const n=t.Tt(name),e=this.context.Bt;let i=e[n];if(void 0===i&&(i=e[n]=this.context.Wt(n,0)),null!==i&&i.$t){const t=i.$t(this.context);if(null!==t){const n=t.kt.description;return void 0===n?null:n}}return null}create(t,name){const n=t.Tt(name),e=this.context.Bt;let i=e[n];if(void 0===i&&(i=e[n]=this.context.Wt(n,0)),null!==i){const t=i.resolve(this.context,this.context);return void 0===t?null:t}return null}},Object.defineProperty(t,"_t",{value:1})});
