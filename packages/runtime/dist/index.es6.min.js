function stringifyLifecycleFlags(t){const e=[];return t&LifecycleFlags.t&&e.push("mustEvaluate"),t&LifecycleFlags.i&&e.push("isCollectionMutation"),t&LifecycleFlags.s&&e.push("isInstanceMutation"),t&LifecycleFlags.o&&e.push("updateTargetObserver"),t&LifecycleFlags.h&&e.push("updateTargetInstance"),t&LifecycleFlags.l&&e.push("updateSourceExpression"),t&LifecycleFlags.u&&e.push("fromAsyncFlush"),t&LifecycleFlags.g&&e.push("fromSyncFlush"),t&LifecycleFlags.p&&e.push("fromStartTask"),t&LifecycleFlags.v&&e.push("fromStopTask"),t&LifecycleFlags.m&&e.push("fromBind"),t&LifecycleFlags.R&&e.push("fromUnbind"),t&LifecycleFlags.L&&e.push("fromAttach"),t&LifecycleFlags.O&&e.push("fromDetach"),t&LifecycleFlags.B&&e.push("fromCache"),t&LifecycleFlags.F&&e.push("fromDOMEvent"),t&LifecycleFlags.C&&e.push("fromObserverSetter"),t&LifecycleFlags.I&&e.push("fromBindableHandler"),t&LifecycleFlags.T&&e.push("fromLifecycleTask"),t&LifecycleFlags.P&&e.push("parentUnmountQueued"),t&LifecycleFlags.S&&e.push("doNotUpdateDOM"),t&LifecycleFlags.$&&e.push("isTraversingParentScope"),t&LifecycleFlags.A&&e.push("allowParentScopeTraversal"),t&LifecycleFlags.M&&e.push("useProxies"),e.join("|")}function __decorate(t,e,i,s){var r,n,o=arguments.length,h=3>o?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)h=Reflect.decorate(t,e,i,s);else for(n=t.length-1;n>=0;n--)(r=t[n])&&(h=(3>o?r(h):o>3?r(e,i,h):r(e,i))||h);return o>3&&h&&Object.defineProperty(e,i,h),h}function subscriberCollection(t){return function(e){const i=e.prototype;switch(i.k=0,i.D=null,i.V=null,i.j=null,i._=null,i.N=addSubscriber,i.K=removeSubscriber,i.U=hasSubscriber,i.q=hasSubscribers,t){case MutationKind.W:i.H=callPropertySubscribers;break;case MutationKind.G:i.H=callCollectionSubscribers;break;case MutationKind.X:i.H=callProxySubscribers}}}function addSubscriber(t){if(this.U(t))return 0;const e=this.k;return 1&e?2&e?4&e?8&e?(this._.push(t),1):(this._=[t],this.k|=8,1):(this.j=t,this.k|=4,1):(this.V=t,this.k|=2,1):(this.D=t,this.k|=1,1)}function removeSubscriber(t){const e=this.k;if(1&e&&this.D===t)return this.D=null,this.k&=-2,1;if(2&e&&this.V===t)return this.V=null,this.k&=-3,1;if(4&e&&this.j===t)return this.j=null,this.k&=-5,1;if(8&e){const e=this._;for(let i=0,s=e.length;s>i;++i)if(e[i]===t)return e.splice(i,1),1===s&&(this.k&=-9),1}return 0}function callPropertySubscribers(t,e,i){const s=this.D,r=this.V,n=this.j;let o=this._;null!==o&&(o=o.slice()),null!==s&&s.J(t,e,i),null!==r&&r.J(t,e,i),null!==n&&n.J(t,e,i);const h=o&&o.length;if(void 0!==h&&h>0)for(let s=0;h>s;++s){const r=o[s];null!==r&&r.J(t,e,i)}}function callCollectionSubscribers(t,e,i){const s=this.D,r=this.V,n=this.j;let o=this._;null!==o&&(o=o.slice()),null!==s&&s.J(t,e,i),null!==r&&r.J(t,e,i),null!==n&&n.J(t,e,i);const h=o&&o.length;if(void 0!==h&&h>0)for(let s=0;h>s;++s){const r=o[s];null!==r&&r.J(t,e,i)}this.Z.Y(this).catch(t=>{throw t})}function callProxySubscribers(t,e,i,s){const r=this.D,n=this.V,o=this.j;let h=this._;null!==h&&(h=h.slice()),null!==r&&r.J(t,e,i,s),null!==n&&n.J(t,e,i,s),null!==o&&o.J(t,e,i,s);const l=h&&h.length;if(void 0!==l&&l>0)for(let r=0;l>r;++r){const n=h[r];null!==n&&n.J(t,e,i,s)}}function hasSubscribers(){return 0!==this.k}function hasSubscriber(t){const e=this.k;if(1&e&&this.D===t)return 1;if(2&e&&this.V===t)return 1;if(4&e&&this.j===t)return 1;if(8&e){const e=this._;for(let i=0,s=e.length;s>i;++i)if(e[i]===t)return 1}return 0}function batchedSubscriberCollection(){return function(t){const e=t.prototype;e.tt=0,e.et=null,e.it=null,e.st=null,e.rt=null,e.nt=addBatchedSubscriber,e.ot=removeBatchedSubscriber,e.ht=hasBatchedSubscriber,e.lt=hasBatchedSubscribers,e.ct=callBatchedCollectionSubscribers}}function addBatchedSubscriber(t){if(this.ht(t))return 0;const e=this.tt;return 1&e?2&e?4&e?8&e?(this.rt.push(t),1):(this.rt=[t],this.tt|=8,1):(this.st=t,this.tt|=4,1):(this.it=t,this.tt|=2,1):(this.et=t,this.tt|=1,1)}function removeBatchedSubscriber(t){const e=this.tt;if(1&e&&this.et===t)return this.et=null,this.tt&=-2,1;if(2&e&&this.it===t)return this.it=null,this.tt&=-3,1;if(4&e&&this.st===t)return this.st=null,this.tt&=-5,1;if(8&e){const e=this.rt;for(let i=0,s=e.length;s>i;++i)if(e[i]===t)return e.splice(i,1),1===s&&(this.tt&=-9),1}return 0}function callBatchedCollectionSubscribers(t,e){const i=this.et,s=this.it,r=this.st;let n=this.rt;null!==n&&(n=n.slice()),null!==i&&i.at(t,e),null!==s&&s.at(t,e),null!==r&&r.at(t,e);const o=n&&n.length;if(void 0!==o&&o>0)for(let i=0;o>i;++i){const s=n[i];null!==s&&s.at(t,e)}}function hasBatchedSubscribers(){return 0!==this.tt}function hasBatchedSubscriber(t){const e=this.tt;if(1&e&&this.et===t)return 1;if(2&e&&this.it===t)return 1;if(4&e&&this.st===t)return 1;if(8&e){const e=this.rt;for(let i=0,s=e.length;s>i;++i)if(e[i]===t)return 1}return 0}function subscribe(t){if(0==this.ut){this.ut=1;const{dt:t,ft:e}=this;this.gt=t[e],observedPropertyDescriptor.get=(()=>this.bt()),observedPropertyDescriptor.set=(value=>{this.pt(value,LifecycleFlags.h)}),defineProperty(t,e,observedPropertyDescriptor)||Reporter.write(1,e,t)}this.N(t)}function dispose(){delete this.dt[this.ft],this.dt=null,this.ft=null,this.gt=null}function propertyObserver(){return function(t){subscriberCollection(MutationKind.W)(t);const e=t.prototype;e.ut=0,e.dt=null,e.ft=null,e.gt=Symbol(),e.subscribe=e.subscribe||subscribe,e.unsubscribe=e.unsubscribe||e.K,e.vt=e.vt||dispose}}function register(t){const e=BindingBehaviorResource.yt(this.description.name);t.register(Registration.singleton(e,this))}function bindingBehavior(t){return e=>BindingBehaviorResource.Rt(t,e)}function keyFrom(name){return`${this.name}:${name}`}function isType(t){return t.kind===this}function define(t,e){const i=e,s="string"==typeof t?{name:t}:t;return i.kind=BindingBehaviorResource,i.description=s,i.register=register,i}function register$1(t){const e=this.kind.yt(this.description.name);t.register(Registration.singleton(e,this))}function valueConverter(t){return e=>ValueConverterResource.Rt(t,e)}function keyFrom$1(name){return`${this.name}:${name}`}function isType$1(t){return t.kind===this}function define$1(t,e){const i=e,s="string"==typeof t?{name:t}:t;return i.kind=ValueConverterResource,i.description=s,i.register=register$1,i}function connects(t){return 32==(32&t.Lt)}function observes(t){return 64==(64&t.Lt)}function callsFunction(t){return 128==(128&t.Lt)}function hasAncestor(t){return 256==(256&t.Lt)}function isAssignable(t){return 8192==(8192&t.Lt)}function isLeftHandSide(t){return 1024==(1024&t.Lt)}function isPrimary(t){return 512==(512&t.Lt)}function isResource(t){return 32768==(32768&t.Lt)}function hasBind(t){return 2048==(2048&t.Lt)}function hasUnbind(t){return 4096==(4096&t.Lt)}function isLiteral(t){return 16384==(16384&t.Lt)}function arePureLiterals(t){if(void 0===t||0===t.length)return 1;for(let e=0;t.length>e;++e)if(!isPureLiteral(t[e]))return 0;return 1}function isPureLiteral(t){if(isLiteral(t))switch(t.Lt){case 17955:return arePureLiterals(t.elements);case 17956:return arePureLiterals(t.values);case 17958:return arePureLiterals(t.Ot);case 17925:return 1}return 0}function evalList(t,e,i,s){const r=s.length,n=Array(r);for(let o=0;r>o;++o)n[o]=s[o].evaluate(t,e,i);return n}function getFunction(t,e,name){const i=null==e?null:e[name];if("function"==typeof i)return i;if(!(t&LifecycleFlags.t)&&null==i)return null;throw Reporter.error(207,e,name,i)}function isNumeric(value){const t=typeof value;if("number"===t)return 1;if("string"!==t)return 0;const e=value.length;if(0===e)return 0;for(let t=0;e>t;++t){const e=value.charCodeAt(t);if(48>e||e>57)return 0}return 1}function ensureEnoughSlotNames(t){if(t===lastSlot){const e=slotNames.length=versionSlotNames.length=(lastSlot+=5)+1;for(let i=t+1;e>i;++i)slotNames[i]=`_observer${i}`,versionSlotNames[i]=`_observerVersion${i}`}}function addObserver(t){const e=void 0===this.Bt?0:this.Bt;let i=e;for(;i--&&this[slotNames[i]]!==t;);if(-1===i){for(i=0;this[slotNames[i]];)i++;this[slotNames[i]]=t,t.subscribe(this),i===e&&(this.Bt=i+1)}void 0===this.version&&(this.version=0),this[versionSlotNames[i]]=this.version,ensureEnoughSlotNames(i)}function observeProperty(t,e,i){const s=this.Ct.Ft(t,e,i);this.It(s)}function unobserve(t){const e=this.Bt;let i,s;if(1==t)for(let t=0;e>t;++t)null!=(s=this[i=slotNames[t]])&&(this[i]=null,s.unsubscribe(this));else{const t=this.version;for(let r=0;e>r;++r)this[versionSlotNames[r]]!==t&&null!=(s=this[i=slotNames[r]])&&(this[i]=null,s.unsubscribe(this))}}function connectableDecorator(t){const e=t.prototype;return e.hasOwnProperty("observeProperty")||(e.wt=observeProperty),e.hasOwnProperty("unobserve")||(e.unobserve=unobserve),e.hasOwnProperty("addObserver")||(e.It=addObserver),t}function connectable(t){return void 0===t?connectableDecorator:connectableDecorator(t)}function setValue(t,e){if(this.gt!==(t=null==t?this.defaultValue:t)){if(this.gt=t,!(e&(LifecycleFlags.Tt|LifecycleFlags.m))||this.Pt&&e&LifecycleFlags.S)return this.St=e,this.Z.Y(this);this.$t(t,e)}return Promise.resolve()}function flush(t){if(this.Pt&&t&LifecycleFlags.S)return void this.Z.Y(this).catch(t=>{throw t});const e=this.gt;this.oldValue!==e&&(this.$t(e,this.St|t|LifecycleFlags.h),this.oldValue=this.gt)}function dispose$1(){this.gt=null,this.oldValue=null,this.defaultValue=null,this.dt=null,this.ft=""}function targetObserver(t=null){return function(e){subscriberCollection(MutationKind.W)(e);const i=e.prototype;i.At=null,i.gt=t,i.oldValue=t,i.defaultValue=t,i.dt=null,i.ft="",i.pt=i.pt||setValue,i.flush=i.flush||flush,i.vt=i.vt||dispose$1}}function flush$1(t){this.ct(this.Mt,t|this.kt),this.Dt&&this.Dt.Vt(LifecycleFlags.Tt|LifecycleFlags.h|this.kt),this.Et()}function dispose$2(){this.G.xt=void 0,this.G=null,this.Mt=null}function resetIndexMapIndexed(){const t=this.G.length,e=this.Mt=Array(t);let i=0;for(;t>i;)e[i]=i++;e.jt=[]}function resetIndexMapKeyed(){const t=this.G.size,e=this.Mt=Array(t);let i=0;for(;t>i;)e[i]=i++;e.jt=[]}function getLengthObserver(){return void 0===this.Dt?this.Dt=new CollectionLengthObserver(this,this._t):this.Dt}function collectionObserver(t){return function(e){subscriberCollection(MutationKind.G)(e),batchedSubscriberCollection()(e);const i=e.prototype;i.At=null,i.G=null,i.Mt=null,i.Nt=0,i._t=8&t?"length":"size",i.Kt=t,i.Et=8&t?resetIndexMapIndexed:resetIndexMapKeyed,i.flush=flush$1,i.vt=dispose$2,i.Ut=getLengthObserver,i.subscribe=i.subscribe||i.N,i.unsubscribe=i.unsubscribe||i.K,i.qt=i.qt||i.nt,i.Wt=i.Wt||i.ot}}function sortCompare(t,e){return t===e?0:(e=null===e?"null":""+e)>(t=null===t?"null":""+t)?-1:1}function preSortCompare(t,e){return void 0===t?void 0===e?0:1:void 0===e?-1:0}function insertionSort(t,e,from,to,i){let s,r,n,o,h,l,c;for(l=from+1;to>l;l++){for(s=t[l],r=e[l],c=l-1;c>=from&&(o=e[c],(h=i(n=t[c],s))>0);c--)t[c+1]=n,e[c+1]=o;t[c+1]=s,e[c+1]=r}}function quickSort(t,e,from,to,i){let s,r,n,o,h,l,c,a,u,d,f,g,b,p,v,y,m,R,L,O=0,B=0;for(;;){if(10>=to-from)return void insertionSort(t,e,from,to,i);o=e[from],h=e[to-1],n=t[O=from+(to-from>>1)],l=e[O],(c=i(s=t[from],r=t[to-1]))>0&&(d=s,f=o,s=r,o=h,r=d,h=f),0>(a=i(s,n))?(u=i(r,n))>0&&(d=r,f=h,r=n,h=l,n=d,l=f):(d=s,f=o,s=n,o=l,n=r,l=h,r=d,h=f),t[from]=s,e[from]=o,t[to-1]=n,e[to-1]=l,g=r,b=h,v=to-1,t[O]=t[p=from+1],e[O]=e[p],t[p]=g,e[p]=b;t:for(B=p+1;v>B;B++)if(m=e[B],0>(R=i(y=t[B],g)))t[B]=t[p],e[B]=e[p],t[p]=y,e[p]=m,p++;else if(R>0){do{if(--v==B)break t;R=i(L=t[v],g)}while(R>0);t[B]=t[v],e[B]=e[v],t[v]=y,e[v]=m,0>R&&(y=t[B],m=e[B],t[B]=t[p],e[B]=e[p],t[p]=y,e[p]=m,p++)}p-from>to-v?(quickSort(t,e,v,to,i),to=p):(quickSort(t,e,from,p,i),from=v)}}function enableArrayObservation(){for(const t of methods)1!=proto[t].ut&&def(proto,t,Object.assign({},descriptorProps,{value:observe[t]}))}function disableArrayObservation(){for(const t of methods)1==proto[t].ut&&def(proto,t,Object.assign({},descriptorProps,{value:native[t]}))}function getArrayObserver(t,e,i){return i.xt||new ArrayObserver(t,e,i)}function enableMapObservation(){for(const t of methods$1)1!=proto$1[t].ut&&def$1(proto$1,t,Object.assign({},descriptorProps$1,{value:observe$1[t]}))}function disableMapObservation(){for(const t of methods$1)1==proto$1[t].ut&&def$1(proto$1,t,Object.assign({},descriptorProps$1,{value:native$1[t]}))}function getMapObserver(t,e,i){return i.xt||new MapObserver(t,e,i)}function enableSetObservation(){for(const t of methods$2)1!=proto$2[t].ut&&def$2(proto$2,t,Object.assign({},descriptorProps$2,{value:observe$2[t]}))}function disableSetObservation(){for(const t of methods$2)1==proto$2[t].ut&&def$2(proto$2,t,Object.assign({},descriptorProps$2,{value:native$2[t]}))}function getSetObserver(t,e,i){return i.xt||new SetObserver(t,e,i)}function computed(t){return function(e,i){(e.computed||(e.computed={}))[i]=t}}function createComputedObserver(t,e,i,s,r,n,o){if(0==o.zt)return i.Ht(r,n);if(o.get){const i=r.constructor.computed&&r.constructor.computed[n]||computedOverrideDefaults;return o.set?i.Gt?new GetterObserver(t,i,r,n,o,e,s):new CustomSetterObserver(r,n,o):new GetterObserver(t,i,r,n,o,e,s)}throw Reporter.error(18,n)}function createGetterTraps(t,e,i){return{get(s,r,n){if(i.Qt(r))return Reflect.get(s,r,n);switch(toStringTag$1.call(s)){case"[object Array]":if(i.Xt(e.Jt(t,s)),"length"===r)return Reflect.get(s,r,s);case"[object Map]":if(i.Xt(e.Yt(t,s)),"size"===r)return Reflect.get(s,r,s);case"[object Set]":if(i.Xt(e.Zt(t,s)),"size"===r)return Reflect.get(s,r,s);default:i.te(e.Ft(t,s,r))}return proxyOrValue(t,s,r,e,i)}}}function proxyOrValue(t,e,i,s,r){const value=Reflect.get(e,i,e);return"function"==typeof value?e[i].bind(e):"object"!=typeof value||null===value?value:new Proxy(value,createGetterTraps(t,s,r))}function getPropertyDescriptor(t,name){let e=Object.getOwnPropertyDescriptor(t,name),i=Object.getPrototypeOf(t);for(;void 0===e&&null!==i;)e=Object.getOwnPropertyDescriptor(i,name),i=Object.getPrototypeOf(i);return e}function getCollectionObserver(t,e,i){switch(toStringTag$2.call(i)){case"[object Array]":return getArrayObserver(t,e,i);case"[object Map]":return getMapObserver(t,e,i);case"[object Set]":return getSetObserver(t,e,i)}return null}function isBindingContext(t){return 1==t.ee}function debounceCallSource(t,e,i){const s=this.ie;PLATFORM.global.clearTimeout(s.se),s.se=PLATFORM.global.setTimeout(()=>{this.re(t,e,i)},s.ne)}function debounceCall(t,e,i){const s=this.ie;if(PLATFORM.global.clearTimeout(s.se),!(i&s.oe))return s.oldValue=unset,void this.re(t,e,i);s.oldValue===unset&&(s.oldValue=e);const r=PLATFORM.global.setTimeout(()=>{const e=s.oldValue;s.oldValue=unset,this.re(t,e,i)},s.ne);s.se=r}function throttle(t){const e=this.he,i=+new Date-e.le;if(i>=e.ne)return PLATFORM.global.clearTimeout(e.se),e.se=-1,e.le=+new Date,void this.ce(t);if(e.newValue=t,-1===e.se){const t=PLATFORM.global.setTimeout(()=>{e.se=-1,e.le=+new Date,this.ce(e.newValue)},e.ne-i);e.se=t}}function customElementKey(name){return`${customElementName}:${name}`}function customElementBehavior(t){return void 0===t.$customElement?null:t.$customElement}function customAttributeKey(name){return`${customAttributeName}:${name}`}function isTargetedInstruction(value){const type=value.type;return"string"==typeof type&&2===type.length}function buildTemplateDefinition(t,e,template,cache,build,bindables,instructions,dependencies,surrogates,containerless,shadowOptions,hasSlots,i){const def=new DefaultTemplateDefinition,s=arguments.length;switch(s){case 13:null!==i&&(def.M=i);case 12:null!==hasSlots&&(def.hasSlots=hasSlots);case 11:null!==shadowOptions&&(def.shadowOptions=shadowOptions);case 10:null!==containerless&&(def.containerless=containerless);case 9:null!==surrogates&&(def.surrogates=PLATFORM.toArray(surrogates));case 8:null!==dependencies&&(def.dependencies=PLATFORM.toArray(dependencies));case 7:null!==instructions&&(def.instructions=PLATFORM.toArray(instructions));case 6:null!==bindables&&(def.bindables=Object.assign({},bindables));case 5:null!==build&&(def.build=1==build?buildRequired:0==build?buildNotRequired:Object.assign({},build));case 4:null!==cache&&(def.cache=cache);case 3:null!==template&&(def.template=template);case 2:null!==t&&(t.bindables&&(def.bindables=Object.assign({},t.bindables)),t.containerless&&(def.containerless=t.containerless),t.shadowOptions&&(def.shadowOptions=t.shadowOptions)),"string"==typeof e?e.length>0&&(def.name=e):null!==e&&(templateDefinitionAssignables.forEach(t=>{e[t]&&(def[t]=e[t])}),templateDefinitionArrays.forEach(t=>{e[t]&&(def[t]=PLATFORM.toArray(e[t]))}),e.bindables&&(def.bindables===PLATFORM.ae?def.bindables=Object.assign({},e.bindables):Object.assign(def.bindables,e.bindables)))}return 2!==s||null===t||"string"!=typeof e&&"build"in e||(def.build=buildRequired),def}function $attachAttribute(t){if(8&this.$state)return;const e=this.$lifecycle;e.ue(),this.$state|=4,t|=LifecycleFlags.L;const i=this.$hooks;16&i&&this.de(t),this.$state|=8,this.$state&=-5,32&i&&e.fe(this),e.ge(t)}function $attachElement(t){if(8&this.$state)return;const e=this.$lifecycle;e.ue(),this.$state|=4,t|=LifecycleFlags.L;const i=this.$hooks;16&i&&this.de(t);let s=this.be;for(;null!==s;)s.pe(t),s=s.ve;e.ye(this),this.$state|=8,this.$state&=-5,32&i&&e.fe(this),e.ge(t)}function $attachView(t){if(8&this.$state)return;this.$state|=4,t|=LifecycleFlags.L;let e=this.be;for(;null!==e;)e.pe(t),e=e.ve;this.$lifecycle.ye(this),this.$state|=8,this.$state&=-5}function $detachAttribute(t){if(8&this.$state){const e=this.$lifecycle;e.me(),this.$state|=32,t|=LifecycleFlags.O;const i=this.$hooks;64&i&&this.Re(t),this.$state&=-41,128&i&&e.Le(this),e.Oe(t)}}function $detachElement(t){if(8&this.$state){const e=this.$lifecycle;e.me(),this.$state|=32,(t|=LifecycleFlags.O)&LifecycleFlags.P^LifecycleFlags.P|t&LifecycleFlags.v&&(e.Be(this),t|=LifecycleFlags.P);const i=this.$hooks;64&i&&this.Re(t);let s=this.Fe;for(;null!==s;)s.Ce(t),s=s.Ie;this.$state&=-41,128&i&&e.Le(this),e.Oe(t)}}function $detachView(t){if(8&this.$state){this.$state|=32,(t|=LifecycleFlags.O)&LifecycleFlags.P^LifecycleFlags.P|t&LifecycleFlags.v&&(this.$lifecycle.Be(this),t|=LifecycleFlags.P);let e=this.Fe;for(;null!==e;)e.Ce(t),e=e.Ie;this.$state&=-41}}function $cacheAttribute(t){2048&this.$hooks&&this.we(t|=LifecycleFlags.B)}function $cacheElement(t){t|=LifecycleFlags.B,2048&this.$hooks&&this.we(t);let e=this.Fe;for(;null!==e;)e.Te(t),e=e.Ie}function $cacheView(t){t|=LifecycleFlags.B;let e=this.Fe;for(;null!==e;)e.Te(t),e=e.Ie}function $mountElement(){16&this.$state||(this.$state|=16,this.Se.Pe(this.$nodes))}function $unmountElement(){16&this.$state&&(this.$state&=-17,this.Se.$e(this.$nodes))}function $mountView(){16&this.$state||(this.$state|=16,this.$nodes.insertBefore(this.location))}function $unmountView(){return 16&this.$state?(this.$state&=-17,this.$nodes.remove(),this.Ae&&(this.Ae=0,this.cache.Me(this))?(this.$state|=128,1):0):0}function $bindAttribute(t,e){if(t|=LifecycleFlags.m,2&this.$state){if(this.$scope===e)return;this.ke(t)}const i=this.$lifecycle;i.De(),this.$state|=1;const s=this.$hooks;8&s&&i.Ve(this),this.$scope=e,4&s&&this.Ee(t),this.$state|=2,this.$state&=-2,i.xe(t)}function $bindElement(t,e){if(2&this.$state)return;const i=this.$scope;i.je=e;const s=this.$lifecycle;s.De(),this.$state|=1;const r=this.$hooks;t|=LifecycleFlags.m,8&r&&s.Ve(this);let n=this._e;for(;null!==n;)n.Ne(t,i),n=n.Ke;4&r&&this.Ee(t);let component=this.be;for(;null!==component;)component.Ne(t,i),component=component.ve;this.$state|=2,this.$state&=-2,s.xe(t)}function $bindView(t,e){if(t|=LifecycleFlags.m,2&this.$state){if(this.$scope===e)return;this.ke(t)}this.$state|=1,this.$scope=e;let i=this._e;for(;null!==i;)i.Ne(t,e),i=i.Ke;let component=this.be;for(;null!==component;)component.Ne(t,e),component=component.ve;this.$state|=2,this.$state&=-2}function $lockedBind(t){if(t|=LifecycleFlags.m,2&this.$state)return;this.$state|=1;const e=this.$scope;let i=this._e;for(;null!==i;)i.Ne(t,e),i=i.Ke;let component=this.be;for(;null!==component;)component.Ne(t,e),component=component.ve;this.$state|=2,this.$state&=-2}function $unbindAttribute(t){if(2&this.$state){const e=this.$lifecycle;e.Ue(),this.$state|=64;const i=this.$hooks;t|=LifecycleFlags.R,512&i&&e.qe(this),256&i&&this.We(t),this.$state&=-67,e.ze(t)}}function $unbindElement(t){if(2&this.$state){const e=this.$lifecycle;e.Ue(),this.$state|=64;const i=this.$hooks;t|=LifecycleFlags.R,512&i&&e.qe(this),256&i&&this.We(t);let component=this.Fe;for(;null!==component;)component.ke(t),component=component.Ie;let s=this.He;for(;null!==s;)s.ke(t),s=s.Ge;this.$scope.je=null,this.$state&=-67,e.ze(t)}}function $unbindView(t){if(2&this.$state){this.$state|=64,t|=LifecycleFlags.R;let component=this.Fe;for(;null!==component;)component.ke(t),component=component.Ie;let e=this.He;for(;null!==e;)e.ke(t),e=e.Ge;this.$state&=-67,this.$scope=null}}function $lockedUnbind(t){if(2&this.$state){this.$state|=64,t|=LifecycleFlags.R;let component=this.Fe;for(;null!==component;)component.ke(t),component=component.Ie;let e=this.He;for(;null!==e;)e.ke(t),e=e.Ge;this.$state&=-67}}function createRenderContext(dom,t,dependencies,e){const i=t.Qe(),s=new InstanceProvider,r=new InstanceProvider,n=new InstanceProvider,o=new ViewFactoryProvider,h=new InstanceProvider,l=i.get(IRenderer);return dom.Xe(i,r),i.Je(IViewFactory,o),i.Je(IRenderable,s),i.Je(ITargetedInstruction,n),i.Je(IRenderLocation,h),dependencies&&i.register(...dependencies),e&&e.register(i),i.Ye=function(t,e,targets,i,host,parts){l.Ye(t,dom,this,e,targets,i,host,parts)},i.Ze=function(t,e,l,c,parts,a){return s.ti(t),r.ti(e),n.ti(l),c&&o.ti(c,parts),a&&h.ti(a),i},i.vt=function(){o.vt(),s.vt(),n.vt(),r.vt(),h.vt()},i}function findElements(t){const e=[];for(let i=0,s=t.length;s>i;++i){const component=customElementBehavior(t[i]);null!==component&&e.push(component)}return e}function createGetterSetter(t,e,name){Reflect.defineProperty(e,name,{ei:1,get(){return this.ii[name].bt()},set(value){this.ii[name].pt(value,t&LifecycleFlags.si|LifecycleFlags.h)}})}function registerElement(t){const e=this.kind.yt(this.description.name);t.register(Registration.transient(e,this))}function customElement(t){return e=>CustomElementResource.Rt(t,e)}function isType$2(t){return t.kind===this}function define$2(t,e=null){if(!t)throw Reporter.error(70);const i=null===e?class{}:e,s=buildTemplateDefinition(i,t),r=i.prototype;return i.kind=CustomElementResource,i.description=s,i.register=registerElement,r.ri=$hydrateElement,r.Ne=$bindElement,r.pe=$attachElement,r.Ce=$detachElement,r.ke=$unbindElement,r.Te=$cacheElement,r.Ie=null,r.ve=null,r.ni=null,r.$scope=null,r.$hooks=0,r._e=null,r.He=null,r.be=null,r.Fe=null,r.oi=$mountElement,r.hi=$unmountElement,r.li=null,r.ci=null,r.Se=null,"flush"in r&&(r.At=null),"binding"in r&&(r.$hooks|=4),"bound"in r&&(r.$hooks|=8,r.ai=null),"unbinding"in r&&(r.$hooks|=256),"unbound"in r&&(r.$hooks|=512,r.ui=null),"render"in r&&(r.$hooks|=1024),"created"in r&&(r.$hooks|=2),"attaching"in r&&(r.$hooks|=16),"attached"in r&&(r.$hooks|=32,r.di=null),"detaching"in r&&(r.$hooks|=64),"caching"in r&&(r.$hooks|=2048),"detached"in r&&(r.$hooks|=128,r.fi=null),i}function useShadowDOM(t){function e(t){return t.shadowOptions=i,t}const i="function"!=typeof t&&t?t:defaultShadowOptions;return"function"==typeof t?e(t):e}function containerlessDecorator(t){return t.containerless=1,t}function containerless(t){return void 0===t?containerlessDecorator:containerlessDecorator(t)}function $hydrateAttribute(t,e){const i=this.constructor;e.get(IRenderingEngine).gi(t,i,this),2&this.$hooks&&this.bi(t)}function $hydrateElement(t,e,host,i=PLATFORM.ae){const s=this.constructor,r=s.description,n=e.get(IProjectorLocator),o=e.get(IRenderingEngine),dom=e.get(IDOM);let h;if(h=t&LifecycleFlags.M?ProxyObserver.pi(this).X:this,this.$scope=Scope.create(t,h,null),this.vi=host,this.Se=n.yi(dom,this,host,r),o.gi(t,s,this),1024&this.$hooks){const r=this.Ye(t,host,i.parts,e);r&&"getElementTemplate"in r&&r.mi(o,s,e).Ye(this,host,i.parts)}else o.mi(dom,r,e,s).Ye(this,host,i.parts);2&this.$hooks&&this.bi(t)}function registerAttribute(t){const e=this.description,i=this.kind.yt(e.name),aliases=e.aliases;t.register(Registration.transient(i,this));for(let e=0,s=aliases.length;s>e;++e){const s=this.kind.yt(aliases[e]);t.register(Registration.Ri(i,s))}}function customAttribute(t){return e=>CustomAttributeResource.Rt(t,e)}function templateController(t){return e=>CustomAttributeResource.Rt("string"==typeof t?{isTemplateController:1,name:t}:Object.assign({isTemplateController:1},t),e)}function dynamicOptionsDecorator(t){return t.Li=1,t}function dynamicOptions(t){return void 0===t?dynamicOptionsDecorator:dynamicOptionsDecorator(t)}function isType$3(t){return t.kind===this}function define$3(t,e){const i=e,s=createCustomAttributeDescription("string"==typeof t?{name:t}:t,i),r=i.prototype;return i.kind=CustomAttributeResource,i.description=s,i.register=registerAttribute,r.ri=$hydrateAttribute,r.Ne=$bindAttribute,r.pe=$attachAttribute,r.Ce=$detachAttribute,r.ke=$unbindAttribute,r.Te=$cacheAttribute,r.Ie=null,r.ve=null,r.ni=null,r.$scope=null,r.$hooks=0,r.$state=0,"flush"in r&&(r.At=null),"binding"in r&&(r.$hooks|=4),"bound"in r&&(r.$hooks|=8,r.ai=null),"unbinding"in r&&(r.$hooks|=256),"unbound"in r&&(r.$hooks|=512,r.ui=null),"created"in r&&(r.$hooks|=2),"attaching"in r&&(r.$hooks|=16),"attached"in r&&(r.$hooks|=32,r.di=null),"detaching"in r&&(r.$hooks|=64),"caching"in r&&(r.$hooks|=2048),"detached"in r&&(r.$hooks|=128,r.fi=null),i}function createCustomAttributeDescription(def,t){const aliases=def.aliases,defaultBindingMode=def.defaultBindingMode;return{name:def.name,aliases:null==aliases?PLATFORM.Oi:aliases,defaultBindingMode:null==defaultBindingMode?BindingMode.Bi:defaultBindingMode,Li:void 0===def.Li?0:def.Li,isTemplateController:void 0===def.isTemplateController?0:def.isTemplateController,bindables:Object.assign({},t.bindables,def.bindables),M:void 0===def.M?0:def.M}}function bindable(t,e){let i;const s=function(t,e){const s=t.constructor;let bindables=s.bindables;void 0===bindables&&(bindables=s.bindables={}),i.Fi||(i.Fi=PLATFORM.Ci(e)),i.Ii||(i.Ii=`${e}Changed`),void 0===i.mode&&(i.mode=BindingMode.Bi),void 0===i.M&&(i.M=0),arguments.length>1&&(i.wi=e),bindables[i.wi]=i};return arguments.length>1?(i={},void s(t,e)):"string"==typeof t?(i={},s):(i=t||{},s)}function longestIncreasingSubsequence(t){const e=t.length,i=e+(t.jt&&t.jt.length||0);let s;const r=new(s=255>i?Uint8Array:65535>i?Uint16Array:Uint32Array)(e),n=new s(e);let o=0,h=0,l=0,c=0,a=0,u=0,d=0,f=0;for(;e>c;c++)if(-2!==(h=t[c])){if(-2!==(l=t[a=n[o]])&&h>l){r[c]=a,n[++o]=c;continue}for(u=0,d=o;d>u;)-2!==(l=t[n[f=u+d>>1]])&&h>l?u=f+1:d=f;((l=t[n[u]])>h||-2===l)&&(u>0&&(r[c]=n[u-1]),n[u]=c)}const g=new s(++o);for(h=n[o-1];o-- >0;)g[o]=h,h=r[h];return g}function instructionRenderer(t){return function(e){const i=function(...i){const s=new e(...i);return s.Ti=t,s};i.register=function(t){return Registration.singleton(IInstructionRenderer,i).register(t,IInstructionRenderer)};const s=Object.getOwnPropertyDescriptors(e);return Object.keys(s).filter(t=>"prototype"!==t).forEach(t=>{Reflect.defineProperty(i,t,s[t])}),i}}function ensureExpression(t,e,i){return"string"==typeof e?t.parse(e,i):e}function addBinding(t,e){e.Ge=t.He,e.Ke=null,null===t.He?t._e=e:t.He.Ke=e,t.He=e}function addComponent(t,component){component.Ie=t.Fe,component.ve=null,null===t.Fe?t.be=component:t.Fe.ve=component,t.Fe=component}var BindingMode,State,Hooks,LifecycleFlags,ExpressionKind,SubscriberFlags,DelegationStrategy,MutationKind,CollectionKind,ProxyObserver_1,RuntimeError,RuntimeError$1,BindingType,TargetedInstructionType,ViewCompileFlags;import{Reporter,DI,Registration,PLATFORM,Profiler,RuntimeCompilationResources,IContainer,all}from"@aurelia/kernel";(function(BindingMode){BindingMode[BindingMode.oneTime=1]="oneTime",BindingMode[BindingMode.Bi=2]="toView",BindingMode[BindingMode.Pi=4]="fromView",BindingMode[BindingMode.Si=6]="twoWay",BindingMode[BindingMode.default=8]="default"})(BindingMode||(BindingMode={})),(function(State){State[State.$i=0]="none",State[State.Ai=1]="isBinding",State[State.Mi=2]="isBound",State[State.ki=4]="isAttaching",State[State.Di=8]="isAttached",State[State.Vi=16]="isMounted",State[State.Ei=32]="isDetaching",State[State.xi=64]="isUnbinding",State[State.ji=128]="isCached",State[State._i=256]="isContainerless"})(State||(State={})),(function(Hooks){Hooks[Hooks.$i=1]="none",Hooks[Hooks.Ni=2]="hasCreated",Hooks[Hooks.Ki=4]="hasBinding",Hooks[Hooks.Ui=8]="hasBound",Hooks[Hooks.qi=16]="hasAttaching",Hooks[Hooks.Wi=32]="hasAttached",Hooks[Hooks.zi=64]="hasDetaching",Hooks[Hooks.Hi=128]="hasDetached",Hooks[Hooks.Gi=256]="hasUnbinding",Hooks[Hooks.Qi=512]="hasUnbound",Hooks[Hooks.Xi=1024]="hasRender",Hooks[Hooks.Ji=2048]="hasCaching"})(Hooks||(Hooks={})),(function(LifecycleFlags){LifecycleFlags[LifecycleFlags.$i=0]="none",LifecycleFlags[LifecycleFlags.t=524288]="mustEvaluate",LifecycleFlags[LifecycleFlags.Yi=3]="mutation",LifecycleFlags[LifecycleFlags.i=1]="isCollectionMutation",LifecycleFlags[LifecycleFlags.s=2]="isInstanceMutation",LifecycleFlags[LifecycleFlags.update=28]="update",LifecycleFlags[LifecycleFlags.o=4]="updateTargetObserver",LifecycleFlags[LifecycleFlags.h=8]="updateTargetInstance",LifecycleFlags[LifecycleFlags.l=16]="updateSourceExpression",LifecycleFlags[LifecycleFlags.from=524256]="from",LifecycleFlags[LifecycleFlags.Tt=224]="fromFlush",LifecycleFlags[LifecycleFlags.u=32]="fromAsyncFlush",LifecycleFlags[LifecycleFlags.g=64]="fromSyncFlush",LifecycleFlags[LifecycleFlags.Zi=128]="fromTick",LifecycleFlags[LifecycleFlags.p=256]="fromStartTask",LifecycleFlags[LifecycleFlags.v=512]="fromStopTask",LifecycleFlags[LifecycleFlags.m=1024]="fromBind",LifecycleFlags[LifecycleFlags.R=2048]="fromUnbind",LifecycleFlags[LifecycleFlags.L=4096]="fromAttach",LifecycleFlags[LifecycleFlags.O=8192]="fromDetach",LifecycleFlags[LifecycleFlags.B=16384]="fromCache",LifecycleFlags[LifecycleFlags.F=32768]="fromDOMEvent",LifecycleFlags[LifecycleFlags.C=65536]="fromObserverSetter",LifecycleFlags[LifecycleFlags.I=131072]="fromBindableHandler",LifecycleFlags[LifecycleFlags.T=262144]="fromLifecycleTask",LifecycleFlags[LifecycleFlags.P=1048576]="parentUnmountQueued",LifecycleFlags[LifecycleFlags.S=2097152]="doNotUpdateDOM",LifecycleFlags[LifecycleFlags.$=4194304]="isTraversingParentScope",LifecycleFlags[LifecycleFlags.si=58720256]="persistentBindingFlags",LifecycleFlags[LifecycleFlags.A=8388608]="allowParentScopeTraversal",LifecycleFlags[LifecycleFlags.M=16777216]="useProxies",LifecycleFlags[LifecycleFlags.ts=33554432]="keyedMode"})(LifecycleFlags||(LifecycleFlags={})),(function(ExpressionKind){ExpressionKind[ExpressionKind.Connects=32]="Connects",ExpressionKind[ExpressionKind.Observes=64]="Observes",ExpressionKind[ExpressionKind.CallsFunction=128]="CallsFunction",ExpressionKind[ExpressionKind.HasAncestor=256]="HasAncestor",ExpressionKind[ExpressionKind.IsPrimary=512]="IsPrimary",ExpressionKind[ExpressionKind.IsLeftHandSide=1024]="IsLeftHandSide",ExpressionKind[ExpressionKind.HasBind=2048]="HasBind",ExpressionKind[ExpressionKind.HasUnbind=4096]="HasUnbind",ExpressionKind[ExpressionKind.IsAssignable=8192]="IsAssignable",ExpressionKind[ExpressionKind.IsLiteral=16384]="IsLiteral",ExpressionKind[ExpressionKind.IsResource=32768]="IsResource",ExpressionKind[ExpressionKind.es=65536]="IsForDeclaration",ExpressionKind[ExpressionKind.ss=31]="Type",ExpressionKind[ExpressionKind.AccessThis=1793]="AccessThis",ExpressionKind[ExpressionKind.AccessScope=10082]="AccessScope",ExpressionKind[ExpressionKind.ArrayLiteral=17955]="ArrayLiteral",ExpressionKind[ExpressionKind.ObjectLiteral=17956]="ObjectLiteral",ExpressionKind[ExpressionKind.PrimitiveLiteral=17925]="PrimitiveLiteral",ExpressionKind[ExpressionKind.Template=17958]="Template",ExpressionKind[ExpressionKind.Unary=39]="Unary",ExpressionKind[ExpressionKind.CallScope=1448]="CallScope",ExpressionKind[ExpressionKind.CallMember=1161]="CallMember",ExpressionKind[ExpressionKind.CallFunction=1162]="CallFunction",ExpressionKind[ExpressionKind.AccessMember=9323]="AccessMember",ExpressionKind[ExpressionKind.AccessKeyed=9324]="AccessKeyed",ExpressionKind[ExpressionKind.TaggedTemplate=1197]="TaggedTemplate",ExpressionKind[ExpressionKind.Binary=46]="Binary",ExpressionKind[ExpressionKind.Conditional=63]="Conditional",ExpressionKind[ExpressionKind.Assign=8208]="Assign",ExpressionKind[ExpressionKind.ValueConverter=36913]="ValueConverter",ExpressionKind[ExpressionKind.BindingBehavior=38962]="BindingBehavior",ExpressionKind[ExpressionKind.HtmlLiteral=51]="HtmlLiteral",ExpressionKind[ExpressionKind.ArrayBindingPattern=65556]="ArrayBindingPattern",ExpressionKind[ExpressionKind.ObjectBindingPattern=65557]="ObjectBindingPattern",ExpressionKind[ExpressionKind.BindingIdentifier=65558]="BindingIdentifier",ExpressionKind[ExpressionKind.ForOfStatement=6199]="ForOfStatement",ExpressionKind[ExpressionKind.Interpolation=24]="Interpolation"})(ExpressionKind||(ExpressionKind={})),(function(t){t[t.rs=0]="None",t[t.ns=1]="Subscriber0",t[t.os=2]="Subscriber1",t[t.hs=4]="Subscriber2",t[t.ls=8]="SubscribersRest",t[t.cs=15]="Any"})(SubscriberFlags||(SubscriberFlags={})),(function(DelegationStrategy){DelegationStrategy[DelegationStrategy.$i=0]="none",DelegationStrategy[DelegationStrategy.as=1]="capturing",DelegationStrategy[DelegationStrategy.us=2]="bubbling"})(DelegationStrategy||(DelegationStrategy={})),(function(MutationKind){MutationKind[MutationKind.W=1]="instance",MutationKind[MutationKind.G=2]="collection",MutationKind[MutationKind.X=4]="proxy"})(MutationKind||(MutationKind={})),(function(CollectionKind){CollectionKind[CollectionKind.ds=8]="indexed",CollectionKind[CollectionKind.fs=4]="keyed",CollectionKind[CollectionKind.gs=9]="array",CollectionKind[CollectionKind.map=6]="map",CollectionKind[CollectionKind.set=7]="set"})(CollectionKind||(CollectionKind={}));const lookup=new WeakMap;let ProxySubscriberCollection=class{constructor(t,e,i){this.raw=e,this.key=i,this.X=t,this.subscribe=this.N,this.unsubscribe=this.K}pt(value,t){const e=this.raw[this.key];e!==value&&(this.raw[this.key]=value,this.H(value,e,t|LifecycleFlags.M|LifecycleFlags.h))}bt(){return this.raw[this.key]}};ProxySubscriberCollection=__decorate([subscriberCollection(MutationKind.W)],ProxySubscriberCollection);let ProxyObserver=ProxyObserver_1=class{constructor(t){this.raw=t,this.X=new Proxy(t,this),lookup.set(t,this.X),this.bs={}}static ps(t){if(void 0===t.vs){const e=lookup.get(t);return void 0===e?t:e}return t}static ys(t){const e=t.vs;return void 0===e?t:e}static pi(t,e){let i;if(void 0===t.vs){const e=lookup.get(t);i=void 0===e?new ProxyObserver_1(t):e.xt}else i=t.xt;if(1===arguments.length)return i;let s=i.bs[e];if(void 0===s){const r=this.ys(t);s=i.bs[e]=new ProxySubscriberCollection(i.X,r,e)}return s}static ms(t){return void 0!==t.vs}get(t,e,i){return"$observer"===e?this:"$raw"===e?t:t[e]}set(t,e,value,i){const s=t[e];return s!==value&&(Reflect.set(t,e,value,t),this.Rs(value,s,e),this.H(e,value,s,LifecycleFlags.M|LifecycleFlags.h)),1}deleteProperty(t,e){const i=t[e];return Reflect.deleteProperty(t,e)?(void 0!==i&&(this.Rs(void 0,i,e),this.H(e,void 0,i,LifecycleFlags.M|LifecycleFlags.h)),1):0}defineProperty(t,e,i){const s=t[e];return Reflect.defineProperty(t,e,i)?(i.value!==s&&(this.Rs(i.value,s,e),this.H(e,i.value,s,LifecycleFlags.M|LifecycleFlags.h)),1):0}apply(t,e,i){return Reflect.apply(t,t,i)}subscribe(t,e){if(1===arguments.length)this.N(t);else{let i=this.bs[e];void 0===i&&(i=this.bs[e]=new ProxySubscriberCollection(this.X,this.raw,e)),i.N(t)}}unsubscribe(t,e){if(1===arguments.length)this.K(t);else{const i=this.bs[e];void 0!==i&&i.K(t)}}Rs(t,e,i){const s=this.bs[i];void 0!==s&&s.H(t,e,LifecycleFlags.M|LifecycleFlags.h)}};ProxyObserver=ProxyObserver_1=__decorate([subscriberCollection(MutationKind.X)],ProxyObserver);const defineProperty=Reflect.defineProperty,observedPropertyDescriptor={get:void 0,set:void 0,ei:1,zt:1};let SetterObserver=class{constructor(t,e,i){this.kt=t&LifecycleFlags.si,this.dt=e,this.ft=i}bt(){return this.gt}pt(t,e){const i=this.gt;i!==t&&(this.gt=t,e&LifecycleFlags.m||this.H(t,i,this.kt|e),this.ut||(this.dt[this.ft]=t))}};SetterObserver=__decorate([propertyObserver()],SetterObserver),(function(t){t[t.Ls=250]="UndefinedScope",t[t.Os=251]="NullScope",t[t.Bs=252]="NilOverrideContext",t[t.Fs=253]="NilParentScope"})(RuntimeError||(RuntimeError={}));class InternalObserversLookup{pi(t,e,i){let s=this[i];return void 0===s&&(s=this[i]=new SetterObserver(t,e,i)),s}}class BindingContext{constructor(t,value){if(this.ee=1,void 0!==t)if(void 0!==value)this[t]=value;else for(const e in t)t.hasOwnProperty(e)&&(this[e]=t[e])}static create(t,e,value){const i=new BindingContext(e,value);return t&LifecycleFlags.M?ProxyObserver.pi(i).X:i}static get(t,name,e,i){if(void 0===t)throw Reporter.error(250);if(null===t)throw Reporter.error(251);let s=t.Cs;if(e>0){for(;e>0;){if(null===s.Is)return;e--,s=s.Is}return name in s?s:s.ws}for(;s&&!(name in s)&&!(s.ws&&name in s.ws);)s=s.Is;if(s)return name in s?s:s.ws;if(i&LifecycleFlags.A&&null!==t.je){const s=this.get(t.je,name,e,i&~LifecycleFlags.A|LifecycleFlags.$);if(null!==s)return s}return i&LifecycleFlags.$?null:t.ws||t.Cs}Ts(t){let e=this.ii;return void 0===e&&(this.ii=e=new InternalObserversLookup),e}}class Scope{constructor(t,e){this.ws=t,this.Cs=e,this.je=null}static create(t,e,i){return new Scope(e,null==i?OverrideContext.create(t,e,i):i)}static Ps(t,e){if(null==e)throw Reporter.error(252);return new Scope(e.ws,e)}static Ss(t,e,i){if(null==e)throw Reporter.error(253);return new Scope(i,OverrideContext.create(t,i,e.Cs))}}class OverrideContext{constructor(t,e){this.ee=1,this.ws=t,this.Is=e}static create(t,e,i){return new OverrideContext(e,void 0===i?null:i)}Ts(){let t=this.ii;return void 0===t&&(this.ii=t=new InternalObserversLookup),t}}const ISignaler=DI.As("ISignaler").$s(t=>t.singleton(Signaler));class Signaler{constructor(){this.Ms=Object.create(null)}ks(name,t){const e=this.Ms[name];if(void 0!==e)for(const i of e.keys())i.J(void 0,void 0,t|LifecycleFlags.h)}Ds(name,t){const e=this.Ms,i=e[name];void 0===i?e[name]=new Set([t]):i.add(t)}Vs(name,t){const e=this.Ms[name];e&&e.delete(t)}}const BindingBehaviorResource={name:"binding-behavior",yt:keyFrom,Es:isType,Rt:define},ValueConverterResource={name:"value-converter",yt:keyFrom$1,Es:isType$1,Rt:define$1};(function(t){t[t.xs=202]="NoLocator",t[t.js=203]="NoBehaviorFound",t[t._s=204]="BehaviorAlreadyApplied",t[t.Ns=205]="NoConverterFound",t[t.Ks=206]="NoBinding",t[t.Us=207]="NotAFunction",t[t.qs=208]="UnknownOperator",t[t.Ls=250]="UndefinedScope",t[t.Os=251]="NullScope"})(RuntimeError$1||(RuntimeError$1={}));class BindingBehavior{constructor(t,name,e){this.Lt=38962,this.Ws=t,this.name=name,this.zs=e,this.Hs=BindingBehaviorResource.yt(this.name),this.Gs=hasBind(t),this.Qs=hasUnbind(t)}evaluate(t,e,i){return this.Ws.evaluate(t,e,i)}assign(t,e,i,value){return this.Ws.assign(t,e,i,value)}connect(t,e,i){this.Ws.connect(t,e,i)}bind(t,e,i){if(void 0===e)throw Reporter.error(250,this);if(null===e)throw Reporter.error(251,this);if(!i)throw Reporter.error(206,this);const s=i.Xs;if(!s)throw Reporter.error(202,this);this.Gs&&this.Ws.bind(t,e,i);const r=this.Hs,n=s.get(r);if(!n)throw Reporter.error(203,this);null==i[r]?(i[r]=n,n.bind.apply(n,[t,e,i].concat(evalList(t,e,s,this.zs)))):Reporter.write(204,this)}Js(t,e,i){const s=this.Hs;null!=i[s]?(i[s].Js(t,e,i),i[s]=null):Reporter.write(204,this),this.Qs&&this.Ws.Js(t,e,i)}accept(t){return t.Ys(this)}}class ValueConverter{constructor(t,name,e){this.Lt=36913,this.Ws=t,this.name=name,this.zs=e,this.Zs=ValueConverterResource.yt(this.name)}evaluate(t,e,i){if(!i)throw Reporter.error(202,this);const s=i.get(this.Zs);if(!s)throw Reporter.error(205,this);if("toView"in s){const r=this.zs,n=r.length,o=Array(n+1);o[0]=this.Ws.evaluate(t,e,i);for(let s=0;n>s;++s)o[s+1]=r[s].evaluate(t,e,i);return s.Bi.apply(s,o)}return this.Ws.evaluate(t,e,i)}assign(t,e,i,value){if(!i)throw Reporter.error(202,this);const s=i.get(this.Zs);if(!s)throw Reporter.error(205,this);return"fromView"in s&&(value=s.Pi.apply(s,[value].concat(evalList(t,e,i,this.zs)))),this.Ws.assign(t,e,i,value)}connect(t,e,i){if(void 0===e)throw Reporter.error(250,this);if(null===e)throw Reporter.error(251,this);if(!i)throw Reporter.error(206,this);const s=i.Xs;if(!s)throw Reporter.error(202,this);this.Ws.connect(t,e,i);const r=this.zs;for(let s=0,n=r.length;n>s;++s)r[s].connect(t,e,i);const n=s.get(this.Zs);if(!n)throw Reporter.error(205,this);const o=n.Ms;if(void 0===o)return;const h=s.get(ISignaler);for(let t=0,e=o.length;e>t;++t)h.Ds(o[t],i)}Js(t,e,i){const s=i.Xs,r=s.get(this.Zs).Ms;if(void 0===r)return;const n=s.get(ISignaler);for(let t=0,e=r.length;e>t;++t)n.Vs(r[t],i)}accept(t){return t.tr(this)}}class Assign{constructor(t,value){this.Lt=8208,this.target=t,this.value=value}evaluate(t,e,i){return this.target.assign(t,e,i,this.value.evaluate(t,e,i))}connect(t,e,i){}assign(t,e,i,value){return this.value.assign(t,e,i,value),this.target.assign(t,e,i,value)}accept(t){return t.er(this)}}class Conditional{constructor(t,e,i){this.Lt=63,this.assign=PLATFORM.ir,this.sr=t,this.rr=e,this.nr=i}evaluate(t,e,i){return this.sr.evaluate(t,e,i)?this.rr.evaluate(t,e,i):this.nr.evaluate(t,e,i)}connect(t,e,i){this.sr.evaluate(t,e,null)?(this.sr.connect(t,e,i),this.rr.connect(t,e,i)):(this.sr.connect(t,e,i),this.nr.connect(t,e,i))}accept(t){return t.or(this)}}class AccessThis{constructor(t=0){this.Lt=1793,this.assign=PLATFORM.ir,this.connect=PLATFORM.ir,this.hr=t}evaluate(t,e,i){if(void 0===e)throw Reporter.error(250,this);if(null===e)throw Reporter.error(251,this);let s=e.Cs,r=this.hr;for(;r--&&s;)s=s.Is;return 1>r&&s?s.ws:void 0}accept(t){return t.lr(this)}}AccessThis.cr=new AccessThis(0),AccessThis.ar=new AccessThis(1);class AccessScope{constructor(name,t=0){this.Lt=10082,this.name=name,this.hr=t}evaluate(t,e,i){const name=this.name;return BindingContext.get(e,name,this.hr,t)[name]}assign(t,e,i,value){const name=this.name,s=BindingContext.get(e,name,this.hr,t);return s?s[name]=value:void 0}connect(t,e,i){const name=this.name,s=BindingContext.get(e,name,this.hr,t);i.wt(t,s,name)}accept(t){return t.ur(this)}}class AccessMember{constructor(t,name){this.Lt=9323,this.object=t,this.name=name}evaluate(t,e,i){const s=this.object.evaluate(t,e,i);return null==s?s:s[this.name]}assign(t,e,i,value){let s=this.object.evaluate(t,e,i);return null!==s&&"object"==typeof s||this.object.assign(t,e,i,s={}),s[this.name]=value,value}connect(t,e,i){const s=this.object.evaluate(t,e,null);this.object.connect(t,e,i),s&&i.wt(t,s,this.name)}accept(t){return t.dr(this)}}class AccessKeyed{constructor(t,e){this.Lt=9324,this.object=t,this.key=e}evaluate(t,e,i){const s=this.object.evaluate(t,e,i);if(null!=s)return s[this.key.evaluate(t,e,i)]}assign(t,e,i,value){return this.object.evaluate(t,e,i)[this.key.evaluate(t,e,i)]=value}connect(t,e,i){const s=this.object.evaluate(t,e,null);if(this.object.connect(t,e,i),"object"==typeof s&&null!==s){this.key.connect(t,e,i);const r=this.key.evaluate(t,e,null);Array.isArray(s)&&isNumeric(r)||i.wt(t,s,r)}}accept(t){return t.gr(this)}}class CallScope{constructor(name,t,e=0){this.Lt=1448,this.assign=PLATFORM.ir,this.name=name,this.zs=t,this.hr=e}evaluate(t,e,i){const s=evalList(t,e,i,this.zs),r=BindingContext.get(e,this.name,this.hr,t),n=getFunction(t,r,this.name);if(n)return n.apply(r,s)}connect(t,e,i){const s=this.zs;for(let r=0,n=s.length;n>r;++r)s[r].connect(t,e,i)}accept(t){return t.br(this)}}class CallMember{constructor(t,name,e){this.Lt=1161,this.assign=PLATFORM.ir,this.object=t,this.name=name,this.zs=e}evaluate(t,e,i){const s=this.object.evaluate(t,e,i),r=evalList(t,e,i,this.zs),n=getFunction(t,s,this.name);if(n)return n.apply(s,r)}connect(t,e,i){const s=this.object.evaluate(t,e,null);if(this.object.connect(t,e,i),getFunction(t&~LifecycleFlags.t,s,this.name)){const s=this.zs;for(let r=0,n=s.length;n>r;++r)s[r].connect(t,e,i)}}accept(t){return t.pr(this)}}class CallFunction{constructor(t,e){this.Lt=1162,this.assign=PLATFORM.ir,this.vr=t,this.zs=e}evaluate(t,e,i){const s=this.vr.evaluate(t,e,i);if("function"==typeof s)return s.apply(null,evalList(t,e,i,this.zs));if(t&LifecycleFlags.t||null!=s)throw Reporter.error(207,this)}connect(t,e,i){const s=this.vr.evaluate(t,e,null);if(this.vr.connect(t,e,i),"function"==typeof s){const s=this.zs;for(let r=0,n=s.length;n>r;++r)s[r].connect(t,e,i)}}accept(t){return t.yr(this)}}class Binary{constructor(t,e,i){this.Lt=46,this.assign=PLATFORM.ir,this.mr=t,this.left=e,this.right=i,this.evaluate=this[t]}evaluate(t,e,i){throw Reporter.error(208,this)}connect(t,e,i){const s=this.left.evaluate(t,e,null);this.left.connect(t,e,i),"&&"===this.mr&&!s||"||"===this.mr&&s||this.right.connect(t,e,i)}Rr(t,e,i){return this.left.evaluate(t,e,i)&&this.right.evaluate(t,e,i)}Lr(t,e,i){return this.left.evaluate(t,e,i)||this.right.evaluate(t,e,i)}Or(t,e,i){return this.left.evaluate(t,e,i)==this.right.evaluate(t,e,i)}Br(t,e,i){return this.left.evaluate(t,e,i)===this.right.evaluate(t,e,i)}Fr(t,e,i){return this.left.evaluate(t,e,i)!=this.right.evaluate(t,e,i)}Cr(t,e,i){return this.left.evaluate(t,e,i)!==this.right.evaluate(t,e,i)}Ir(t,e,i){const s=this.right.evaluate(t,e,i);return"function"==typeof s?this.left.evaluate(t,e,i)instanceof s:0}wr(t,e,i){const s=this.right.evaluate(t,e,i);return null!==s&&"object"==typeof s?this.left.evaluate(t,e,i)in s:0}Tr(t,e,i){return this.left.evaluate(t,e,i)+this.right.evaluate(t,e,i)}Pr(t,e,i){return this.left.evaluate(t,e,i)-this.right.evaluate(t,e,i)}Sr(t,e,i){return this.left.evaluate(t,e,i)*this.right.evaluate(t,e,i)}$r(t,e,i){return this.left.evaluate(t,e,i)/this.right.evaluate(t,e,i)}Ar(t,e,i){return this.left.evaluate(t,e,i)%this.right.evaluate(t,e,i)}Mr(t,e,i){return this.left.evaluate(t,e,i)<this.right.evaluate(t,e,i)}kr(t,e,i){return this.left.evaluate(t,e,i)>this.right.evaluate(t,e,i)}Dr(t,e,i){return this.left.evaluate(t,e,i)<=this.right.evaluate(t,e,i)}Vr(t,e,i){return this.left.evaluate(t,e,i)>=this.right.evaluate(t,e,i)}accept(t){return t.Er(this)}}class Unary{constructor(t,e){this.Lt=39,this.assign=PLATFORM.ir,this.mr=t,this.Ws=e,this.evaluate=this[t]}evaluate(t,e,i){throw Reporter.error(208,this)}connect(t,e,i){this.Ws.connect(t,e,i)}xr(t,e,i){this.Ws.evaluate(t,e,i)}jr(t,e,i){return typeof this.Ws.evaluate(t,e,i)}_r(t,e,i){return!this.Ws.evaluate(t,e,i)}Pr(t,e,i){return-this.Ws.evaluate(t,e,i)}Tr(t,e,i){return+this.Ws.evaluate(t,e,i)}accept(t){return t.Nr(this)}}class PrimitiveLiteral{constructor(value){this.Lt=17925,this.assign=PLATFORM.ir,this.connect=PLATFORM.ir,this.value=value}evaluate(t,e,i){return this.value}accept(t){return t.Kr(this)}}PrimitiveLiteral.Ur=new PrimitiveLiteral(void 0),PrimitiveLiteral.qr=new PrimitiveLiteral(null),PrimitiveLiteral.Wr=new PrimitiveLiteral(1),PrimitiveLiteral.zr=new PrimitiveLiteral(0),PrimitiveLiteral.Hr=new PrimitiveLiteral("");class HtmlLiteral{constructor(parts){this.Lt=51,this.assign=PLATFORM.ir,this.parts=parts}evaluate(t,e,i){const s=this.parts;let r="";for(let n=0,o=s.length;o>n;++n){const value=s[n].evaluate(t,e,i);null!=value&&(r+=value)}return r}connect(t,e,i){for(let s=0,r=this.parts.length;r>s;++s)this.parts[s].connect(t,e,i)}accept(t){return t.Gr(this)}}class ArrayLiteral{constructor(t){this.Lt=17955,this.assign=PLATFORM.ir,this.elements=t}evaluate(t,e,i){const s=this.elements,r=s.length,n=Array(r);for(let o=0;r>o;++o)n[o]=s[o].evaluate(t,e,i);return n}connect(t,e,i){const s=this.elements;for(let r=0,n=s.length;n>r;++r)s[r].connect(t,e,i)}accept(t){return t.Qr(this)}}ArrayLiteral.Hr=new ArrayLiteral(PLATFORM.Oi);class ObjectLiteral{constructor(t,e){this.Lt=17956,this.assign=PLATFORM.ir,this.keys=t,this.values=e}evaluate(t,e,i){const s={},r=this.keys,n=this.values;for(let o=0,h=r.length;h>o;++o)s[r[o]]=n[o].evaluate(t,e,i);return s}connect(t,e,i){const s=this.values;for(let r=0,n=this.keys.length;n>r;++r)s[r].connect(t,e,i)}accept(t){return t.Xr(this)}}ObjectLiteral.Hr=new ObjectLiteral(PLATFORM.Oi,PLATFORM.Oi);class Template{constructor(t,e){this.Lt=17958,this.assign=PLATFORM.ir,this.Jr=t,this.Ot=void 0===e?PLATFORM.Oi:e}evaluate(t,e,i){const s=this.Ot,r=this.Jr;let n=r[0];for(let o=0,h=s.length;h>o;++o)n+=s[o].evaluate(t,e,i),n+=r[o+1];return n}connect(t,e,i){const s=this.Ot;for(let r=0,n=s.length;n>r;++r)s[r].connect(t,e,i),r++}accept(t){return t.Yr(this)}}Template.Hr=new Template([""]);class TaggedTemplate{constructor(t,e,i,s){this.Lt=1197,this.assign=PLATFORM.ir,this.Jr=t,this.Jr.raw=e,this.vr=i,this.Ot=void 0===s?PLATFORM.Oi:s}evaluate(t,e,i){const s=this.Ot,r=s.length,n=Array(r);for(let o=0,h=r;h>o;++o)n[o]=s[o].evaluate(t,e,i);const o=this.vr.evaluate(t,e,i);if("function"!=typeof o)throw Reporter.error(207,this);return o.apply(null,[this.Jr].concat(n))}connect(t,e,i){const s=this.Ot;for(let r=0,n=s.length;n>r;++r)s[r].connect(t,e,i);this.vr.connect(t,e,i)}accept(t){return t.Zr(this)}}class ArrayBindingPattern{constructor(t){this.Lt=65556,this.elements=t}evaluate(t,e,i){}assign(t,e,i,s){}connect(t,e,i){}accept(t){return t.tn(this)}}class ObjectBindingPattern{constructor(t,e){this.Lt=65557,this.keys=t,this.values=e}evaluate(t,e,i){}assign(t,e,i,s){}connect(t,e,i){}accept(t){return t.en(this)}}class BindingIdentifier{constructor(name){this.Lt=65558,this.name=name}evaluate(t,e,i){return this.name}connect(t,e,i){}accept(t){return t.in(this)}}const toStringTag={}.toString;class ForOfStatement{constructor(t,e){this.Lt=6199,this.assign=PLATFORM.ir,this.sn=t,this.rn=e}evaluate(t,e,i){return this.rn.evaluate(t,e,i)}count(t){return CountForOfStatement[toStringTag.call(t)](t)}nn(t,e){IterateForOfStatement[toStringTag.call(t)](t,e)}connect(t,e,i){this.sn.connect(t,e,i),this.rn.connect(t,e,i)}bind(t,e,i){hasBind(this.rn)&&this.rn.bind(t,e,i)}Js(t,e,i){hasUnbind(this.rn)&&this.rn.Js(t,e,i)}accept(t){return t.on(this)}}class Interpolation{constructor(parts,t){this.Lt=24,this.assign=PLATFORM.ir,this.parts=parts,this.Ot=void 0===t?PLATFORM.Oi:t,this.hn=this.Ot.length>1,this.ln=this.Ot[0]}evaluate(t,e,i){if(this.hn){const s=this.Ot,parts=this.parts;let r=parts[0];for(let n=0,o=s.length;o>n;++n)r+=s[n].evaluate(t,e,i),r+=parts[n+1];return r}{const parts=this.parts;return parts[0]+this.ln.evaluate(t,e,i)+parts[1]}}connect(t,e,i){}accept(t){return t.cn(this)}}const IterateForOfStatement={an(t,e){for(let i=0,s=t.length;s>i;++i)e(t,i,t[i])},un(t,e){const i=Array(t.size);let s=-1;for(const e of t.entries())i[++s]=e;IterateForOfStatement["an"](i,e)},dn(t,e){const i=Array(t.size);let s=-1;for(const e of t.keys())i[++s]=e;IterateForOfStatement["an"](i,e)},fn(t,e){const i=Array(t);for(let e=0;t>e;++e)i[e]=e;IterateForOfStatement["an"](i,e)},gn(t,e){},bn(t,e){}},CountForOfStatement={an:t=>t.length,un:t=>t.size,dn:t=>t.size,fn:t=>t,gn:()=>0,bn:()=>0},IRenderable=DI.As("IRenderable").pn(),IViewFactory=DI.As("IViewFactory").pn(),marker=Object.freeze(Object.create(null)),ILifecycle=DI.As("ILifecycle").$s(t=>t.singleton(Lifecycle));class Lifecycle{constructor(){this.vn=0,this.yn=0,this.mn=0,this.Rn=0,this.Ln=this,this.On=this,this.Bn=this,this.Fn=this,this.Cn=this,this.In=this,this.wn=this,this.Tn=this,this.Pn=this,this.Sn=this,this.$n=this,this.An=this,this.Mn=this,this.kn=this,this.Dn=this,this.Vn=this,this.En=this,this.xn=this,this.jn=this,this._n=this,this.Nn=null,this.Kn=Promise.resolve(),this.Un=0,this.qn=0,this.Wn=0,this.zn=0,this.Hn=0,this.Gn=0,this.Qn=0,this.Xn=0,this.Jn=0,this.Yn=0,this.At=marker,this.flush=PLATFORM.ir,this.Zn=marker,this.connect=PLATFORM.ir,this.eo=marker,this.Vt=PLATFORM.ir,this.ai=marker,this.bound=PLATFORM.ir,this.li=marker,this.oi=PLATFORM.ir,this.di=marker,this.io=PLATFORM.ir,this.ci=marker,this.hi=PLATFORM.ir,this.fi=marker,this.so=PLATFORM.ir,this.ni=marker,this.ke=PLATFORM.ir,this.ui=marker,this.ro=PLATFORM.ir,this.no=null}static register(t){return Registration.singleton(ILifecycle,this).register(t)}oo(t){null===this.no&&(this.no=new AggregateLifecycleTask),this.no.ho(t)}lo(t){null!==this.no&&(this.no===t?this.no=null:this.no.co(t))}Y(t){return this.Ln===this&&(this.Nn=this.Kn.then(()=>{this.ao(LifecycleFlags.u)})),null===t.At&&(t.At=marker,this.On.At=t,this.On=t,++this.Un),this.Nn}ao(t){for(t|=LifecycleFlags.g;this.Un>0;){let e,i=this.Ln.At;this.Ln=this.On=this,this.Un=0;do{e=i.At,i.At=null,i.flush(t),i=e}while(i!==marker);if(t&LifecycleFlags.S)break}}De(){++this.vn}Ve(t){null===t.ai&&(t.ai=marker,this.Tn.ai=t,this.Tn=t,++this.zn)}uo(t){null===t.Zn&&(t.Zn=marker,this.Fn.Zn=t,this.Fn=t,++this.qn),null===t.eo&&(t.eo=marker,this.In.eo=t,this.In=t,++this.Wn)}do(t){if(this.qn>0){this.qn=0;let e,i=this.Bn.Zn;this.Bn=this.Fn=this;do{i.connect(t),e=i.Zn,i.Zn=null,i=e}while(i!==marker)}}fo(t){for(t&LifecycleFlags.p&&this.ao(t|LifecycleFlags.g);this.Wn>0;){this.Wn=0;let e,i=this.Cn.eo;this.Cn=this.In=this;do{i.Vt(t),e=i.eo,i.eo=null,i=e}while(i!==marker)}}xe(t){if(0==--this.vn)return null===this.no||this.no.done?(this.bo(t),LifecycleTask.done):(this.no.po=this,this.no)}bo(t){for(t&LifecycleFlags.p&&this.ao(t|LifecycleFlags.g);this.zn>0;){this.zn=0;let e,i=this.wn.ai;this.wn=this.Tn=this;do{i.bound(t),e=i.ai,i.ai=null,i=e}while(i!==marker)}}Ue(){++this.Rn}qe(t){null===t.ui&&(t.ui=marker,this._n.ui=t,this._n=t,++this.Yn)}ze(t){if(0==--this.Rn)return null===this.no||this.no.done?(this.vo(t),LifecycleTask.done):(this.no.po=this,this.no)}vo(t){for(;this.Yn>0;){this.Yn=0;let e,i=this.jn.ui;this.jn=this._n=this;do{i.ro(t),e=i.ui,i.ui=null,i=e}while(i!==marker)}}ue(){++this.yn}ye(t){null===t.li&&(t.li=marker,this.Sn.li=t,this.Sn=t,++this.Hn)}fe(t){null===t.di&&(t.di=marker,this.An.di=t,this.An=t,++this.Gn)}ge(t){if(0==--this.yn)return null===this.no||this.no.done?(this.yo(t),LifecycleTask.done):(this.no.po=this,this.no)}yo(t){if(this.ao(t|LifecycleFlags.g),this.Hn>0){this.Hn=0;let e,i=this.Pn.li;this.Pn=this.Sn=this;do{i.oi(t),e=i.li,i.li=null,i=e}while(i!==marker)}if(this.do(LifecycleFlags.t),this.Gn>0){this.Gn=0;let e,i=this.$n.di;this.$n=this.An=this;do{i.io(t),e=i.di,i.di=null,i=e}while(i!==marker)}}me(){++this.mn}Be(t){if(null===t.ci&&(t.ci=marker,this.kn.ci=t,this.kn=t,++this.Qn),null!==t.li){let e=this.Pn,i=e.li;for(;i!==t;)i=(e=i).li;e.li=i.li,i.li=null,this.Sn===i&&(this.Sn=this),--this.Hn}}Le(t){null===t.fi&&(t.fi=marker,this.Vn.fi=t,this.Vn=t,++this.Xn)}mo(t){null===t.ni&&(t.ni=marker,this.xn.ni=t,this.xn=t,++this.Jn)}Oe(t){if(0==--this.mn)return null===this.no||this.no.done?(this.Ro(t),LifecycleTask.done):(this.no.po=this,this.no)}Ro(t){if(this.ao(t|LifecycleFlags.Tt|LifecycleFlags.S),this.Qn>0){this.Qn=0;let e,i=this.Mn.ci;this.Mn=this.kn=this;do{i.hi(t),e=i.ci,i.ci=null,i=e}while(i!==marker)}if(this.Xn>0){this.Xn=0;let e,i=this.Dn.fi;this.Dn=this.Vn=this;do{i.so(t),e=i.fi,i.fi=null,i=e}while(i!==marker)}if(this.Jn>0){this.Ue(),this.Jn=0;let e,i=this.En.ni;this.En=this.xn=this;do{i.ke(t),e=i.ni,i.ni=null,i=e}while(i!==marker);this.ze(t)}}}class CompositionCoordinator{constructor($lifecycle){this.$lifecycle=$lifecycle,this.Lo=PLATFORM.ir,this.currentView=null,this.Di=0,this.Mi=0,this.Oo=null,this.Bo=LifecycleTask.done}static register(t){return Registration.transient(this,this).register(t,this)}Fo(value,t){this.Bo.done?value instanceof Promise?(this.Co(new PromiseSwap(this,value)),this.Io()):this.wo(value,t):(value instanceof Promise?this.Co(new PromiseSwap(this,value)):this.Co(value),this.Bo.To()&&this.Bo.cancel())}Ee(t,e){this.scope=e,this.Mi=1,null!==this.currentView&&this.currentView.Ne(t,e)}de(t){this.Di=1,null!==this.currentView&&this.currentView.pe(t)}Re(t){this.Di=0,null!==this.currentView&&this.currentView.Ce(t)}We(t){this.Mi=0,null!==this.currentView&&this.currentView.ke(t)}we(t){this.currentView=null}Co(t){null===this.Oo&&(this.Oo=[]),this.Oo.push(t)}wo(t,e){if(this.currentView===t)return;const $lifecycle=this.$lifecycle,i=new AggregateLifecycleTask;let s,r=this.currentView;null===r?s=LifecycleTask.done:($lifecycle.mo(r),$lifecycle.me(),r.Ce(e),s=$lifecycle.Oe(e)),i.ho(s),null===(r=this.currentView=t)?s=LifecycleTask.done:(this.Mi&&($lifecycle.De(),r.Ne(e,this.scope),$lifecycle.xe(e)),this.Di?($lifecycle.ue(),r.pe(e),s=$lifecycle.ge(e)):s=LifecycleTask.done),i.ho(s),i.done?(this.Bo=LifecycleTask.done,this.Lo()):(this.Bo=i,this.Bo.Po().then(()=>{this.Lo(),this.Io()}).catch(t=>{throw t}))}Io(){if(null!==this.Oo&&this.Oo.length>0){const t=this.Oo.pop();this.Oo.length=0,PromiseSwap.is(t)?this.Bo=t.start():this.wo(t,LifecycleFlags.T)}else this.Bo=LifecycleTask.done}}CompositionCoordinator.inject=[ILifecycle];const LifecycleTask={done:{done:1,To:()=>0,cancel(){},Po:()=>Promise.resolve()}};class AggregateLifecycleTask{constructor(){this.done=1,this.po=null,this.resolve=null,this.So=[],this.$o=null}ho(t){t.done||(this.done=0,this.So.push(t),t.Po().then(()=>{this.Ao()}).catch(t=>{throw t}))}co(t){if(t.done){const e=this.So.indexOf(t);-1!==e&&this.So.splice(e,1)}0===this.So.length&&null!==this.po&&(this.po.lo(this),this.po=null)}To(){return this.done?0:this.So.every(t=>t.To())}cancel(){this.To()&&(this.So.forEach(t=>{t.cancel()}),this.done=0)}Po(){return null===this.$o&&(this.$o=this.done?Promise.resolve():new Promise(t=>this.resolve=t)),this.$o}Ao(){this.done||this.So.every(t=>t.done)&&this.complete(1)}complete(t){this.done=1,t&&null!==this.po&&(this.po.Ro(LifecycleFlags.T),this.po.vo(LifecycleFlags.T),this.po.bo(LifecycleFlags.T),this.po.yo(LifecycleFlags.T)),this.po.lo(this),null!==this.resolve&&this.resolve()}}class PromiseSwap{constructor(t,e){this.Mo=t,this.done=0,this.ko=0,this.Kn=e}static is(t){return"start"in t}start(){return this.ko?LifecycleTask.done:(this.Kn=this.Kn.then(t=>(this.Do(t),t)),this)}To(){return!this.done}cancel(){this.To()&&(this.ko=1)}Po(){return this.Kn}Do(value){this.ko||(this.done=1,this.Mo.Fo(value,LifecycleFlags.T))}}class PromiseTask{constructor(t,e){this.done=0,this.ko=0,this.Ii=e,this.Kn=t.then(value=>{if(1!=this.ko)return this.done=1,this.Ii(value),value})}To(){return!this.done}cancel(){this.To()&&(this.ko=1)}Po(){return this.Kn}}const slotNames=[],versionSlotNames=[];let lastSlot=-1;ensureEnoughSlotNames(-1);const{oneTime,Bi:toView,Pi:fromView}=BindingMode,toViewOrOneTime=toView|oneTime;let Binding=class{constructor(t,e,i,mode,s,r){this.Ke=null,this.Ge=null,this.$state=0,this.$lifecycle=r.get(ILifecycle),this.Zn=null,this.eo=null,this.$scope=null,this.Xs=r,this.mode=mode,this.Ct=s,this.Vo=t,this.target=e,this.Eo=i,this.kt=LifecycleFlags.$i}xo(value,t){this.targetObserver.pt(value,(t|=this.kt)|LifecycleFlags.h)}jo(value,t){this.Vo.assign((t|=this.kt)|LifecycleFlags.l,this.$scope,this.Xs,value)}J(t,e,i){if(!(2&this.$state))return;const s=this.Vo,$scope=this.$scope,r=this.Xs;if(i|=this.kt,this.mode===BindingMode.Pi&&(i&=~LifecycleFlags.h,i|=LifecycleFlags.l),i&LifecycleFlags.h){const mode=this.mode,e=this.targetObserver.bt();return(10082!==s.Lt||this.Bt>1)&&(t=s.evaluate(i,$scope,r)),t!==e&&this.xo(t,i),void(0==(mode&oneTime)&&(this.version++,s.connect(i,$scope,this),this.unobserve(0)))}if(!(i&LifecycleFlags.l))throw Reporter.error(15,LifecycleFlags[i]);t!==s.evaluate(i,$scope,r)&&this.jo(t,i)}Ne(t,e){if(2&this.$state){if(this.$scope===e)return;this.ke(t|LifecycleFlags.m)}this.$state|=1,this.kt=t&LifecycleFlags.si,this.$scope=e;let i=this.Vo;hasBind(i)&&i.bind(t,e,this);const mode=this.mode;let targetObserver=this.targetObserver;targetObserver||(targetObserver=this.targetObserver=mode&fromView?this.Ct.Ft(t,this.target,this.Eo):this.Ct._o(t,this.target,this.Eo)),targetObserver.bind&&targetObserver.bind(t),i=this.Vo,mode&toViewOrOneTime&&this.xo(i.evaluate(t,e,this.Xs),t),mode&toView&&i.connect(t,e,this),mode&fromView&&targetObserver.subscribe(this),this.$state|=2,this.$state&=-2}ke(t){if(!(2&this.$state))return;this.$state|=64,this.kt=LifecycleFlags.$i;const e=this.Vo;hasUnbind(e)&&e.Js(t,this.$scope,this),this.$scope=null;const targetObserver=this.targetObserver;targetObserver.Js&&targetObserver.Js(t),targetObserver.unsubscribe&&targetObserver.unsubscribe(this),this.unobserve(1),this.$state&=-67}connect(t){2&this.$state&&this.Vo.connect((t|=this.kt)|LifecycleFlags.t,this.$scope,this)}Vt(t){2&this.$state&&this.xo(this.Vo.evaluate((t|=this.kt)|LifecycleFlags.t,this.$scope,this.Xs),t)}};Binding=__decorate([connectable()],Binding);class Call{constructor(t,e,i,s,r){this.Ke=null,this.Ge=null,this.$state=0,this.Xs=r,this.Vo=t,this.targetObserver=s.Ft(LifecycleFlags.$i,e,i)}No(t){const e=this.$scope.Cs;Object.assign(e,t);const i=this.Vo.evaluate(LifecycleFlags.t,this.$scope,this.Xs);for(const i in t)delete e[i];return i}Ne(t,e){if(2&this.$state){if(this.$scope===e)return;this.ke(t|LifecycleFlags.m)}this.$state|=1,this.$scope=e;const i=this.Vo;hasBind(i)&&i.bind(t,e,this),this.targetObserver.pt(t=>this.No(t),t),this.$state|=2,this.$state&=-2}ke(t){if(!(2&this.$state))return;this.$state|=64;const e=this.Vo;hasUnbind(e)&&e.Js(t,this.$scope,this),this.$scope=null,this.targetObserver.pt(null,t),this.$state&=-67}wt(t,e,i){}J(t,e,i){}}const IExpressionParser=DI.As("IExpressionParser").$s(t=>t.singleton(ExpressionParser));class ExpressionParser{constructor(){this.Ko=Object.create(null),this.Uo=Object.create(null),this.qo=Object.create(null)}parse(t,e){switch(e){case 2048:{let i=this.qo[t];return void 0===i&&(i=this.qo[t]=this.Wo(t,e)),i}case 539:{let i=this.Uo[t];return void 0===i&&(i=this.Uo[t]=this.Wo(t,e)),i}default:{if(0===t.length&&55&e)return PrimitiveLiteral.Hr;let i=this.Ko[t];return void 0===i&&(i=this.Ko[t]=this.Wo(t,e)),i}}}cache(t){const{Uo:e,Ko:i,qo:s}=this;for(const r in t){const n=t[r];switch(n.Lt){case 24:s[r]=n;break;case 6199:e[r]=n;break;default:i[r]=n}}}Wo(t,e){try{const parts=t.split("."),e=parts[0];let i;i=e.endsWith("()")?new CallScope(e.replace("()",""),PLATFORM.Oi):new AccessScope(parts[0]);let s=1;for(;parts.length>s;){const t=parts[s];i=t.endsWith("()")?new CallMember(i,t.replace("()",""),PLATFORM.Oi):new AccessMember(i,parts[s]),s++}return i}catch(t){throw Reporter.error(3,t)}}}(function(BindingType){BindingType[BindingType.rs=0]="None",BindingType[BindingType.Interpolation=2048]="Interpolation",BindingType[BindingType.zo=1280]="IsRef",BindingType[BindingType.Ho=512]="IsIterator",BindingType[BindingType.Go=256]="IsCustom",BindingType[BindingType.Qo=128]="IsFunction",BindingType[BindingType.Xo=64]="IsEvent",BindingType[BindingType.Jo=32]="IsProperty",BindingType[BindingType.Yo=16]="IsCommand",BindingType[BindingType.Zo=48]="IsPropertyCommand",BindingType[BindingType.th=80]="IsEventCommand",BindingType[BindingType.eh=6]="DelegationStrategyDelta",BindingType[BindingType.ih=15]="Command",BindingType[BindingType.sh=49]="OneTimeCommand",BindingType[BindingType.rh=50]="ToViewCommand",BindingType[BindingType.nh=51]="FromViewCommand",BindingType[BindingType.oh=52]="TwoWayCommand",BindingType[BindingType.hh=53]="BindCommand",BindingType[BindingType.lh=86]="TriggerCommand",BindingType[BindingType.ah=87]="CaptureCommand",BindingType[BindingType.uh=88]="DelegateCommand",BindingType[BindingType.dh=153]="CallCommand",BindingType[BindingType.fh=26]="OptionsCommand",BindingType[BindingType.gh=539]="ForCommand",BindingType[BindingType.bh=284]="CustomCommand"})(BindingType||(BindingType={}));const{Bi:toView$1,oneTime:oneTime$1}=BindingMode;class MultiInterpolationBinding{constructor(t,e,i,s,mode,r){this.Ke=null,this.Ge=null,this.$state=0,this.$scope=null,this.ph=e,this.Xs=r,this.mode=mode,this.Ct=t,this.target=i,this.Eo=s;const n=e.Ot,parts=this.parts=Array(n.length);for(let o=0,h=n.length;h>o;++o)parts[o]=new InterpolationBinding(n[o],e,i,s,mode,t,r,0===o)}Ne(t,e){if(2&this.$state){if(this.$scope===e)return;this.ke(t)}this.$state|=2,this.$scope=e;const parts=this.parts;for(let i=0,s=parts.length;s>i;++i)parts[i].Ne(t,e)}ke(t){if(!(2&this.$state))return;this.$state&=-3,this.$scope=null;const parts=this.parts;for(let e=0,i=parts.length;i>e;++e)parts[e].ke(t)}}let InterpolationBinding=class{constructor(t,e,i,s,mode,r,n,o){this.$state=0,this.ph=e,this.vh=o,this.mode=mode,this.Xs=n,this.Ct=r,this.Vo=t,this.target=i,this.Eo=s,this.targetObserver=r._o(LifecycleFlags.$i,i,s)}xo(value,t){this.targetObserver.pt(value,t|LifecycleFlags.h)}J(t,e,i){if(!(2&this.$state))return;const s=this.targetObserver.bt(),r=this.ph.evaluate(i,this.$scope,this.Xs);r!==s&&this.xo(r,i),0==(this.mode&oneTime$1)&&(this.version++,this.Vo.connect(i,this.$scope,this),this.unobserve(0))}Ne(t,e){if(2&this.$state){if(this.$scope===e)return;this.ke(t)}this.$state|=2,this.$scope=e;const i=this.Vo;i.bind&&i.bind(t,e,this),this.vh&&this.xo(this.ph.evaluate(t,e,this.Xs),t),this.mode&toView$1&&i.connect(t,e,this)}ke(t){if(!(2&this.$state))return;this.$state&=-3;const e=this.Vo;e.Js&&e.Js(t,this.$scope,this),this.$scope=null,this.unobserve(1)}};InterpolationBinding=__decorate([connectable()],InterpolationBinding);let LetBinding=class{constructor(t,e,i,s,toViewModel=0){this.Ke=null,this.Ge=null,this.$state=0,this.$lifecycle=s.get(ILifecycle),this.$scope=null,this.Xs=s,this.Ct=i,this.Vo=t,this.target=null,this.Eo=e,this.toViewModel=toViewModel}J(t,e,i){if(2&this.$state){if(!(i&LifecycleFlags.h))throw Reporter.error(15,i);{const{target:t,Eo:e}=this,s=t[e],r=this.Vo.evaluate(i,this.$scope,this.Xs);r!==s&&(t[e]=r)}}}Ne(t,e){if(2&this.$state){if(this.$scope===e)return;this.ke(t|LifecycleFlags.m)}this.$state|=1,this.$scope=e,this.target=this.toViewModel?e.ws:e.Cs;const i=this.Vo;i.bind&&i.bind(t,e,this),this.target[this.Eo]=this.Vo.evaluate(LifecycleFlags.m,e,this.Xs),this.Vo.connect(t,e,this),this.$state|=2,this.$state&=-2}ke(t){if(!(2&this.$state))return;this.$state|=64;const e=this.Vo;e.Js&&e.Js(t,this.$scope,this),this.$scope=null,this.unobserve(1),this.$state&=-67}};LetBinding=__decorate([connectable()],LetBinding);class Ref{constructor(t,e,i){this.Ke=null,this.Ge=null,this.$state=0,this.Xs=i,this.Vo=t,this.target=e}Ne(t,e){if(2&this.$state){if(this.$scope===e)return;this.ke(t|LifecycleFlags.m)}this.$state|=1,this.$scope=e;const i=this.Vo;hasBind(i)&&i.bind(t,e,this),this.Vo.assign(t,this.$scope,this.Xs,this.target),this.$state|=2,this.$state&=-2}ke(t){if(!(2&this.$state))return;this.$state|=64,this.Vo.evaluate(t,this.$scope,this.Xs)===this.target&&this.Vo.assign(t,this.$scope,this.Xs,null);const e=this.Vo;hasUnbind(e)&&e.Js(t,this.$scope,this),this.$scope=null,this.$state&=-67}wt(t,e,i){}J(t,e,i){}}let CollectionLengthObserver=class{constructor(t,e){this.dt=t,this.ft=e,this.gt=t[e]}bt(){return this.dt[this.ft]}$t(t){this.dt[this.ft]=t}Vt(t){this.H(this.dt[this.ft],this.gt,t),this.gt=this.dt[this.ft]}subscribe(t){this.N(t)}unsubscribe(t){this.K(t)}};CollectionLengthObserver=__decorate([targetObserver()],CollectionLengthObserver);const proto=Array.prototype,$push=proto.push,$unshift=proto.unshift,$pop=proto.pop,$shift=proto.shift,$splice=proto.splice,$reverse=proto.reverse,$sort=proto.sort,native={push:$push,unshift:$unshift,pop:$pop,shift:$shift,splice:$splice,reverse:$reverse,sort:$sort},methods=["push","unshift","pop","shift","splice","reverse","sort"],observe={push(){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $push.apply(t,arguments);const i=t.length,s=arguments.length;if(0===s)return i;t.length=e.Mt.length=i+s;let r=i;for(;t.length>r;)t[r]=arguments[r-i],e.Mt[r]=-2,r++;return e.H("push",arguments,e.kt|LifecycleFlags.i),t.length},unshift(){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $unshift.apply(t,arguments);const i=arguments.length,s=Array(i);let r=0;for(;i>r;)s[r++]=-2;$unshift.apply(e.Mt,s);const n=$unshift.apply(t,arguments);return e.H("unshift",arguments,e.kt|LifecycleFlags.i),n},pop(){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $pop.call(t);const i=e.Mt,s=$pop.call(t),r=i.length-1;return i[r]>-1&&i.jt.push(i[r]),$pop.call(i),e.H("pop",arguments,e.kt|LifecycleFlags.i),s},shift(){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $shift.call(t);const i=e.Mt,s=$shift.call(t);return i[0]>-1&&i.jt.push(i[0]),$shift.call(i),e.H("shift",arguments,e.kt|LifecycleFlags.i),s},splice(t,e){let i=this;void 0!==i.vs&&(i=i.vs);const s=i.xt;if(void 0===s)return $splice.apply(i,arguments);const r=s.Mt;if(e>0){let i=isNaN(t)?0:t;const to=i+e;for(;to>i;)r[i]>-1&&r.jt.push(r[i]),i++}const n=arguments.length;if(n>2){const i=n-2,s=Array(i);let o=0;for(;i>o;)s[o++]=-2;$splice.call(r,t,e,...s)}else 2===n&&$splice.call(r,t,e);const o=$splice.apply(i,arguments);return s.H("splice",arguments,s.kt|LifecycleFlags.i),o},reverse(){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $reverse.call(t),this;const i=t.length,s=i/2|0;let r=0;for(;r!==s;){const s=i-r-1,n=t[r],o=e.Mt[r],h=e.Mt[s];t[r]=t[s],e.Mt[r]=h,t[s]=n,e.Mt[s]=o,r++}return e.H("reverse",arguments,e.kt|LifecycleFlags.i),this},sort(t){let e=this;void 0!==e.vs&&(e=e.vs);const i=e.xt;if(void 0===i)return $sort.call(e,t),this;const s=e.length;if(2>s)return this;quickSort(e,i.Mt,0,s,preSortCompare);let r=0;for(;s>r&&void 0!==e[r];)r++;return void 0!==t&&"function"==typeof t||(t=sortCompare),quickSort(e,i.Mt,0,r,t),i.H("sort",arguments,i.kt|LifecycleFlags.i),this}},descriptorProps={yh:1,ei:0,zt:1},def=Object.defineProperty;for(const t of methods)def(observe[t],"observing",{value:1,yh:0,zt:0,ei:0});enableArrayObservation();let ArrayObserver=class{constructor(t,e,i){this.Z=e,i.xt=this,this.G=i,this.flags=t&LifecycleFlags.si,this.Et()}};ArrayObserver=__decorate([collectionObserver(9)],ArrayObserver);const proto$1=Map.prototype,$set=proto$1.set,$clear=proto$1.clear,$delete=proto$1.delete,native$1={set:$set,clear:$clear,delete:$delete},methods$1=["set","clear","delete"],observe$1={set(t,value){let e=this;void 0!==e.vs&&(e=e.vs);const i=e.xt;if(void 0===i)return $set.call(e,t,value),this;const s=e.size;if($set.call(e,t,value),e.size===s){let s=0;for(const r of e.entries()){if(r[0]===t)return r[1]!==value&&(i.Mt[s]=-2),this;s++}return this}return i.Mt[s]=-2,i.H("set",arguments,i.kt|LifecycleFlags.i),this},clear(){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $clear.call(t);if(t.size>0){const i=e.Mt;let s=0;for(const e of t.keys())i[s]>-1&&i.jt.push(i[s]),s++;$clear.call(t),i.length=0,e.H("clear",arguments,e.kt|LifecycleFlags.i)}},delete(value){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $delete.call(t,value);if(0===t.size)return 0;let i=0;const s=e.Mt;for(const e of t.keys()){if(e===value)return s[i]>-1&&s.jt.push(s[i]),s.splice(i,1),$delete.call(t,value);i++}return e.H("delete",arguments,e.kt|LifecycleFlags.i),0}},descriptorProps$1={yh:1,ei:0,zt:1},def$1=Object.defineProperty;for(const t of methods$1)def$1(observe$1[t],"observing",{value:1,yh:0,zt:0,ei:0});enableMapObservation();let MapObserver=class{constructor(t,e,i){this.Z=e,i.xt=this,this.G=i,this.flags=t&LifecycleFlags.si,this.Et()}};MapObserver=__decorate([collectionObserver(6)],MapObserver);const proto$2=Set.prototype,$add=proto$2.add,$clear$1=proto$2.clear,$delete$1=proto$2.delete,native$2={add:$add,clear:$clear$1,delete:$delete$1},methods$2=["add","clear","delete"],observe$2={add(value){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $add.call(t,value),this;const i=t.size;return $add.call(t,value),t.size===i?this:(e.Mt[i]=-2,e.H("add",arguments,e.kt|LifecycleFlags.i),this)},clear(){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $clear$1.call(t);if(t.size>0){const i=e.Mt;let s=0;for(const e of t.keys())i[s]>-1&&i.jt.push(i[s]),s++;$clear$1.call(t),i.length=0,e.H("clear",arguments,e.kt|LifecycleFlags.i)}},delete(value){let t=this;void 0!==t.vs&&(t=t.vs);const e=t.xt;if(void 0===e)return $delete$1.call(t,value);if(0===t.size)return 0;let i=0;const s=e.Mt;for(const e of t.keys()){if(e===value)return s[i]>-1&&s.jt.push(s[i]),s.splice(i,1),$delete$1.call(t,value);i++}return e.H("delete",arguments,e.kt|LifecycleFlags.i),0}},descriptorProps$2={yh:1,ei:0,zt:1},def$2=Object.defineProperty;for(const t of methods$2)def$2(observe$2[t],"observing",{value:1,yh:0,zt:0,ei:0});enableSetObservation();let SetObserver=class{constructor(t,e,i){this.Z=e,i.xt=this,this.G=i,this.flags=t&LifecycleFlags.si,this.Et()}};SetObserver=__decorate([collectionObserver(7)],SetObserver);const computedOverrideDefaults={mh:0,Gt:0};let CustomSetterObserver=class{constructor(t,e,i){this.dt=t,this.ft=e,this.gt=this.oldValue=void 0,this.Rh=i,this.ut=0}pt(t){this.Rh.set.call(this.dt,t),this.gt!==t&&(this.oldValue=this.gt,this.gt=t,this.H(t,this.oldValue,LifecycleFlags.h))}subscribe(t){this.ut||this.Lh(),this.N(t)}unsubscribe(t){this.K(t)}Lh(){this.ut=1,this.gt=this.dt[this.ft],Reflect.defineProperty(this.dt,this.ft,{set:t=>{this.pt(t)}})}};CustomSetterObserver=__decorate([subscriberCollection(MutationKind.W)],CustomSetterObserver);let GetterObserver=class{constructor(t,e,i,s,r,n,o){this.dt=i,this.ft=s,this.Oh=0,this.gt=this.oldValue=void 0,this.Bh=[],this.Fh=[],this.Ch=e,this.Ih=0,this.Rh=r,this.X=new Proxy(i,createGetterTraps(t,n,this)),Reflect.defineProperty(i,s,{get:()=>this.bt()})}te(t){-1===this.Bh.indexOf(t)&&this.Bh.push(t)}Xt(t){-1===this.Fh.indexOf(t)&&this.Fh.push(t)}bt(){return this.gt=0===this.Ih||this.Oh?Reflect.apply(this.Rh.get,this.X,PLATFORM.Oi):Reflect.apply(this.Rh.get,this.dt,PLATFORM.Oi),this.gt}subscribe(t){this.N(t),1==++this.Ih&&this.wh(1)}unsubscribe(t){this.K(t),0==--this.Ih&&this.Th()}J(){const t=this.gt,e=this.wh(0);t!==e&&this.H(e,t,LifecycleFlags.h)}at(){const t=this.gt,e=this.wh(0);t!==e&&this.H(e,t,LifecycleFlags.Tt|LifecycleFlags.h)}wh(t){const e=!this.Ch.mh||t;return e&&(this.Th(),this.Oh=1),this.gt=this.bt(),e&&(this.Bh.forEach(t=>{t.subscribe(this)}),this.Fh.forEach(t=>{t.qt(this)}),this.Oh=0),this.gt}Qt(t){return!this.Oh||"$observers"===t}Th(){this.Bh.forEach(t=>{t.unsubscribe(this)}),this.Bh.length=0,this.Fh.forEach(t=>{t.Wt(this)}),this.Fh.length=0}};GetterObserver=__decorate([subscriberCollection(MutationKind.W)],GetterObserver);const toStringTag$1={}.toString,IDirtyChecker=DI.As("IDirtyChecker").$s(t=>t.singleton(DirtyChecker)),DirtyCheckSettings={Ph:6,disabled:0,warn:1,Sh:0,$h(){this.Ph=6,this.disabled=0,this.warn=1,this.Sh=0}};class DirtyChecker{constructor(){this.Ah=0,this.Mh=[]}Ht(t,e){if(DirtyCheckSettings.Sh)throw Reporter.error(800);return DirtyCheckSettings.warn&&Reporter.write(801),new DirtyCheckProperty(this,t,e)}kh(t){this.Mh.push(t),1===this.Mh.length&&PLATFORM.Dh.add(this.Vh,this)}removeProperty(t){this.Mh.splice(this.Mh.indexOf(t),1),0===this.Mh.length&&PLATFORM.Dh.remove(this.Vh,this)}Vh(t){if(DirtyCheckSettings.disabled)return;if(++this.Ah<DirtyCheckSettings.Ph)return;this.Ah=0;const e=this.Mh,i=e.length;let s,r=0;for(;i>r;++r)(s=e[r]).Eh()&&s.flush(LifecycleFlags.Zi)}}let DirtyCheckProperty=class{constructor(t,e,i){this.dt=e,this.ft=i,this.xh=t}Eh(){return this.oldValue!==this.dt[this.ft]}flush(t){const e=this.dt[this.ft];this.H(e,this.oldValue,t|LifecycleFlags.h),this.oldValue=e}subscribe(t){this.q()||(this.oldValue=this.dt[this.ft],this.xh.kh(this)),this.N(t)}unsubscribe(t){this.K(t)&&!this.q()&&this.xh.removeProperty(this)}};DirtyCheckProperty=__decorate([propertyObserver()],DirtyCheckProperty);const noop=PLATFORM.ir;class PrimitiveObserver{constructor(t,e){this.jh=1,"length"===e?(this.dt=t,this.bt=this._h):this.bt=this.Nh}_h(){return this.dt.length}Nh(){}}PrimitiveObserver.prototype.pt=noop,PrimitiveObserver.prototype.subscribe=noop,PrimitiveObserver.prototype.unsubscribe=noop,PrimitiveObserver.prototype.vt=noop;class PropertyAccessor{constructor(t,e){this.dt=t,this.ft=e}bt(){return this.dt[this.ft]}pt(value){this.dt[this.ft]=value}}const toStringTag$2={}.toString,IObserverLocator=DI.As("IObserverLocator").pn(),ITargetObserverLocator=DI.As("ITargetObserverLocator").pn(),ITargetAccessorLocator=DI.As("ITargetAccessorLocator").pn();class ObserverLocator{constructor(t,e,i,s){this.Kh=[],this.xh=e,this.Z=t,this.Uh=i,this.qh=s}static register(t){return Registration.singleton(IObserverLocator,this).register(t)}Ft(t,e,i){if(t&LifecycleFlags.M&&"object"==typeof e)return ProxyObserver.pi(e,i);if(isBindingContext(e))return e.Ts(t).pi(t,e,i);let s,r=e.ii;return r&&i in r?r[i]:((s=this.Wh(t,e,i)).jh||(void 0===r&&(r=this.zh(e)),r[i]=s),s)}Hh(t){this.Kh.push(t)}_o(t,e,i){return this.qh.Gh(t,e)?this.Uh.Qh(t,e,i)?this.Ft(t,e,i):this.qh._o(t,this.Z,e,i):t&LifecycleFlags.M?ProxyObserver.pi(e,i):new PropertyAccessor(e,i)}Jt(t,e){return getArrayObserver(t,this.Z,e)}Yt(t,e){return getMapObserver(t,this.Z,e)}Zt(t,e){return getSetObserver(t,this.Z,e)}zh(t){return t.ii||this.Xh(t)}Xh(t){const value={};return Reflect.defineProperty(t,"$observers",{ei:0,zt:0,yh:0,value})||Reporter.write(0,t),value}Jh(t,e,i,s){for(let r=0,n=this.Kh.length;n>r;r++){const n=this.Kh[r].Ft(t,e,i,s);if(n)return n}return null}Wh(t,e,i){if(!(e instanceof Object))return new PrimitiveObserver(e,i);let s=0;if(this.Uh.Gh(t,e)){const r=this.Uh.Ft(t,this.Z,this,e,i);if(null!==r)return r;if(null!==r)return r;s=1}switch(toStringTag$2.call(e)){case"[object Array]":return"length"===i?this.Jt(t,e).Ut(t):this.xh.Ht(e,i);case"[object Map]":return"size"===i?this.Yt(t,e).Ut(t):this.xh.Ht(e,i);case"[object Set]":return"size"===i?this.Zt(t,e).Ut(t):this.xh.Ht(e,i)}const r=getPropertyDescriptor(e,i);if(r&&(r.get||r.set)){if(r.get&&r.get.Ft)return r.get.Ft(e);return this.Jh(t,e,i,r)||(s?this.xh.Ht(e,i):createComputedObserver(t,this,this.xh,this.Z,e,i,r))}return new SetterObserver(t,e,i)}}ObserverLocator.inject=[ILifecycle,IDirtyChecker,ITargetObserverLocator,ITargetAccessorLocator];const noop$1=PLATFORM.ir;let SelfObserver=class{constructor(t,e,i,s){this.kt=t&LifecycleFlags.si,ProxyObserver.ms(e)?(e.xt.subscribe(this,i),this.dt=e.vs,this.ft=i,this.gt=e.vs[i],this.Ii=s in e.vs?e[s].bind(e):noop$1):(this.dt=e,this.ft=i,this.gt=e[i],this.Ii=s in e?e[s].bind(e):noop$1)}J(t,e,i){this.pt(t,i)}bt(){return this.gt}pt(t,e){const i=this.gt;if(i!==t&&(this.gt=t,!(e&LifecycleFlags.m))){const s=this.Ii(t,i,e);void 0!==s&&(this.gt=t=s),this.H(t,i,e)}}};SelfObserver=__decorate([propertyObserver()],SelfObserver);const{oneTime:oneTime$2,Bi:toView$2,Pi:fromView$1,Si:twoWay}=BindingMode;class BindingModeBehavior{constructor(mode){this.mode=mode}bind(t,e,i){i.Yh=i.mode,i.mode=this.mode}Js(t,e,i){i.mode=i.Yh,i.Yh=null}}class OneTimeBindingBehavior extends BindingModeBehavior{constructor(){super(oneTime$2)}}BindingBehaviorResource.Rt("oneTime",OneTimeBindingBehavior);class ToViewBindingBehavior extends BindingModeBehavior{constructor(){super(toView$2)}}BindingBehaviorResource.Rt("toView",ToViewBindingBehavior);class FromViewBindingBehavior extends BindingModeBehavior{constructor(){super(fromView$1)}}BindingBehaviorResource.Rt("fromView",FromViewBindingBehavior);class TwoWayBindingBehavior extends BindingModeBehavior{constructor(){super(twoWay)}}BindingBehaviorResource.Rt("twoWay",TwoWayBindingBehavior);const unset={},fromView$2=BindingMode.Pi;class DebounceBindingBehavior{bind(t,e,i,s=200){let r,n,o;i instanceof Binding?(r="handleChange",o=debounceCall,n=i.mode&fromView$2?LifecycleFlags.l:LifecycleFlags.h):(r="callSource",o=debounceCallSource,n=LifecycleFlags.h),i.re=i[r],i.re.Zh=r,i[r]=o,i.ie={oe:n,ne:s,se:0,oldValue:unset}}Js(t,e,i){i[i.re.Zh]=i.re,i.re=null,PLATFORM.global.clearTimeout(i.ie.se),i.ie=null}}BindingBehaviorResource.Rt("debounce",DebounceBindingBehavior);class SignalBindingBehavior{constructor(t){this.tl=t}bind(t,e,i,...s){if(!i.xo)throw Reporter.error(11);if(4===arguments.length){const name=s[0];this.tl.Ds(name,i),i.el=name}else{if(4>=arguments.length)throw Reporter.error(12);{const t=[].slice.call(arguments,3);let e=t.length;for(;e--;)this.tl.Ds(t[e],i);i.el=t}}}Js(t,e,i){const name=i.el;if(i.el=null,Array.isArray(name)){const t=name;let e=t.length;for(;e--;)this.tl.Vs(t[e],i)}else this.tl.Vs(name,i)}}SignalBindingBehavior.inject=[ISignaler],BindingBehaviorResource.Rt("signal",SignalBindingBehavior);class ThrottleBindingBehavior{bind(t,e,i,s=200){let r;i.ce=i[r=i instanceof Binding?i.mode===BindingMode.Si?"updateSource":"updateTarget":"callSource"],i.ce.Zh=r,i[r]=throttle,i.he={ne:s,le:0,se:-1}}Js(t,e,i){i[i.ce.Zh]=i.ce,i.ce=null,PLATFORM.global.clearTimeout(i.he.se),i.he=null}}BindingBehaviorResource.Rt("throttle",ThrottleBindingBehavior);const customElementName="custom-element",customAttributeName="custom-attribute";(function(TargetedInstructionType){TargetedInstructionType.il="ra",TargetedInstructionType.sl="rb",TargetedInstructionType.rl="rc",TargetedInstructionType.nl="rd",TargetedInstructionType.setProperty="re",TargetedInstructionType.ph="rf",TargetedInstructionType.ol="rg",TargetedInstructionType.hl="rh",TargetedInstructionType.ll="ri",TargetedInstructionType.cl="rj",TargetedInstructionType.al="rk"})(TargetedInstructionType||(TargetedInstructionType={}));const ITargetedInstruction=DI.As("createInterface").pn(),buildRequired=Object.freeze({required:1,compiler:"default"}),buildNotRequired=Object.freeze({required:0,compiler:"default"});class DefaultTemplateDefinition{constructor(){this.name="unnamed",this.template=null,this.cache=0,this.build=buildNotRequired,this.bindables=PLATFORM.ae,this.instructions=PLATFORM.Oi,this.dependencies=PLATFORM.Oi,this.surrogates=PLATFORM.Oi,this.containerless=0,this.shadowOptions=null,this.hasSlots=0,this.M=0}}const templateDefinitionAssignables=["name","template","cache","build","containerless","shadowOptions","hasSlots","useProxies"],templateDefinitionArrays=["instructions","dependencies","surrogates"],{ul:enter,dl:leave}=Profiler.fl("AttachLifecycle"),{ul:enter$1,dl:leave$1}=Profiler.fl("BindLifecycle"),INode=DI.As("INode").pn(),IRenderLocation=DI.As("IRenderLocation").pn(),IDOM=DI.As("IDOM").pn(),emptySequence={childNodes:PLATFORM.Oi,firstChild:null,lastChild:null,gl:()=>PLATFORM.Oi,insertBefore(t){},bl(t){},remove(){}},NodeSequence={empty:emptySequence};class View{constructor($lifecycle,cache){this._e=null,this.He=null,this.be=null,this.Fe=null,this.be=null,this.Fe=null,this.ve=null,this.Ie=null,this.li=null,this.ci=null,this.ni=null,this.$state=0,this.$scope=null,this.Ae=0,this.$lifecycle=$lifecycle,this.cache=cache}pl(t){this.Ae=0,this.location=t}release(t){return this.Ae=1,8&this.$state?this.cache.vl(this):!!this.hi(t)}yl(t){this.$scope=t,this.Ne=$lockedBind,this.ke=$lockedUnbind}}class ViewFactory{constructor(name,template,t){this.ml=0,this.Rl=-1,this.cache=null,this.Z=t,this.name=name,this.template=template}Ll(t,e){t&&("*"===t?t=ViewFactory.Ol:"string"==typeof t&&(t=parseInt(t,10)),-1!==this.Rl&&e||(this.Rl=t)),this.cache=this.Rl>0?[]:null,this.ml=this.Rl>0}vl(t){return null!==this.cache&&this.Rl>this.cache.length}Me(t){return this.vl(t)?(t.Te(LifecycleFlags.$i),this.cache.push(t),1):0}create(t){const cache=this.cache;let e;if(null!==cache&&cache.length>0)return(e=cache.pop()).$state&=-129,e;if(e=new View(this.Z,this),this.template.Ye(e,null,null,t),!e.$nodes)throw Reporter.error(90);return e}}ViewFactory.Ol=65535,(t=>{t.Ne=$bindView,t.ke=$unbindView,t.pe=$attachView,t.Ce=$detachView,t.Te=$cacheView,t.oi=$mountView,t.hi=$unmountView})(View.prototype);const ITemplateCompiler=DI.As("ITemplateCompiler").pn();(function(ViewCompileFlags){ViewCompileFlags[ViewCompileFlags.$i=1]="none",ViewCompileFlags[ViewCompileFlags.Bl=2]="surrogate",ViewCompileFlags[ViewCompileFlags.Fl=4]="shadowDOM"})(ViewCompileFlags||(ViewCompileFlags={}));const ITemplateFactory=DI.As("ITemplateFactory").pn();class CompiledTemplate{constructor(dom,t,e,i){this.dom=dom,this.Cl=t,this.Il=e,this.wl=i}Ye(t,host,parts,e=LifecycleFlags.$i){const i=t.$nodes=this.Il.Tl();t.$context=this.wl,this.Cl.M&&(e|=LifecycleFlags.M),this.wl.Ye(e,t,i.gl(),this.Cl,host,parts)}}const noViewTemplate={wl:null,dom:null,Ye(t){t.$nodes=NodeSequence.empty,t.$context=null}},defaultCompilerName="default",IInstructionRenderer=DI.As("IInstructionRenderer").pn(),IRenderer=DI.As("IRenderer").pn(),IRenderingEngine=DI.As("IRenderingEngine").$s(t=>t.singleton(RenderingEngine));class RenderingEngine{constructor(t,e,i,s){this.Pl=new Map,this.Sl=t,this.$l=e,this.Al=new Map,this.Z=i,this.Ml=new Map,this.kl=s.reduce((t,e)=>(t[e.name]=e,t),Object.create(null))}mi(dom,t,e,i){if(!t)return null;let s=this.Ml.get(t);return s||(s=this.Dl(dom,t,e,i),this.Ml.set(t,s)),s}Vl(dom,t,e){if(!t)return null;let i=this.Al.get(t);if(!i){const s=buildTemplateDefinition(null,t),template=this.Dl(dom,s,e,null);(i=new ViewFactory(s.name,template,this.Z)).Ll(s.cache,1),this.Al.set(t,i)}return i}gi(t,e,i){let s=this.Pl.get(e);s||(s=RuntimeBehavior.create(e),this.Pl.set(e,s)),s.El(t,i,this.Z)}Dl(dom,t,e,i){if(null===e&&(e=this.Sl),null!==t.template){const s=createRenderContext(dom,e,t.dependencies,i);if(t.build.required){const e=t.build.compiler||defaultCompilerName,compiler=this.kl[e];if(void 0===compiler)throw Reporter.error(20,e);t=compiler.compile(dom,t,new RuntimeCompilationResources(s),ViewCompileFlags.Bl)}return this.$l.create(s,t)}return noViewTemplate}}RenderingEngine.inject=[IContainer,ITemplateFactory,ILifecycle,all(ITemplateCompiler)];class InstanceProvider{constructor(){this.W=null}ti(t){this.W=t}resolve(t,e){if(void 0===this.W)throw Reporter.error(50);return this.W}vt(){this.W=null}}class ViewFactoryProvider{ti(t,parts){this.Il=t,this.xl=parts||PLATFORM.ae}resolve(t,e){const i=this.Il;if(null==i)throw Reporter.error(50);if(!i.name||!i.name.length)throw Reporter.error(51);const s=this.xl[i.name];if(s){const i=t.get(IRenderingEngine),dom=t.get(IDOM);return i.Vl(dom,s,e)}return i}vt(){this.Il=null,this.xl=PLATFORM.ae}}let ChildrenObserver=class{constructor(t,customElement){this.Nt=0,this.children=null,this.customElement=customElement,this.Z=t,this.ut=0}bt(){return this.ut||(this.ut=1,this.customElement.Se.jl(()=>{this._l()}),this.children=findElements(this.customElement.Se.children)),this.children}pt(t){}flush(t){this.H(this.children,void 0,t|LifecycleFlags.h),this.Nt=0}subscribe(t){this.N(t)}unsubscribe(t){this.K(t)}_l(){this.children=findElements(this.customElement.Se.children),"$childrenChanged"in this.customElement&&this.customElement.Nl(),this.Z.Y(this).catch(t=>{throw t}),this.Nt=1}};ChildrenObserver=__decorate([subscriberCollection(MutationKind.W)],ChildrenObserver);class RuntimeBehavior{constructor(){}static create(t){const e=new RuntimeBehavior;return e.bindables=t.description.bindables,e}El(t,e,i){e.$lifecycle=i,"$projector"in e?this.Kl(t,i,e):this.Ul(t,e)}Kl(t,e,i){this.Ul(t,i).ql=new ChildrenObserver(e,i),Reflect.defineProperty(i,"$children",{ei:0,get(){return this.ii.ql.bt()}})}Ul(t,e){const i={},bindables=this.bindables,s=Object.getOwnPropertyNames(bindables);if(t&LifecycleFlags.M)for(let r=0,n=s.length;n>r;++r){const name=s[r];i[name]=new SelfObserver(t,ProxyObserver.pi(e).X,name,bindables[name].Ii)}else{for(let r=0,n=s.length;n>r;++r){const name=s[r];i[name]=new SelfObserver(t,e,name,bindables[name].Ii),createGetterSetter(t,e,name)}Reflect.defineProperty(e,"$observers",{ei:0,value:i})}return i}}const IProjectorLocator=DI.As("IProjectorLocator").pn(),CustomElementResource={name:customElementName,yt:customElementKey,Es:isType$2,Wl:customElementBehavior,Rt:define$2},defaultShadowOptions={mode:"open"},{ul:enter$2,dl:leave$2}=Profiler.fl("RenderLifecycle"),CustomAttributeResource={name:customAttributeName,yt:customAttributeKey,Es:isType$3,Rt:define$3};class If{constructor(t,e,i){this.value=0,this.Mo=i,this.zl=null,this.Hl=null,this.Gl=t,this.Ql=null,this.location=e}Ee(t){const e=this.Xl(t);this.Mo.Fo(e,t),this.Mo.Ee(t,this.$scope)}de(t){this.Mo.de(t)}Re(t){this.Mo.Re(t)}We(t){this.Mo.We(t)}we(t){null!==this.Ql&&this.Ql.release(t)&&(this.Ql=null),null!==this.Hl&&this.Hl.release(t)&&(this.Hl=null),this.Mo.we(t)}Jl(t,e,i){if(3&this.$state)if(ProxyObserver.ms(this)&&(i|=LifecycleFlags.M),i&LifecycleFlags.Tt){const t=this.Xl(i);this.Mo.Fo(t,i)}else this.$lifecycle.Y(this).catch(t=>{throw t})}flush(t){ProxyObserver.ms(this)&&(t|=LifecycleFlags.M);const e=this.Xl(t);this.Mo.Fo(e,t)}Xl(t){return this.value?this.Ql=this.Yl(this.Ql,this.Gl,t):null!==this.zl?this.Hl=this.Yl(this.Hl,this.zl,t):null}Yl(t,e,i){return null===t&&(t=e.create(i)),t.pl(this.location),t}}If.inject=[IViewFactory,IRenderLocation,CompositionCoordinator],__decorate([bindable],If.prototype,"value",void 0),CustomAttributeResource.Rt({name:"if",isTemplateController:1},If);class Else{constructor(t){this.Il=t}link(t){t.zl=this.Il}}Else.inject=[IViewFactory],CustomAttributeResource.Rt({name:"else",isTemplateController:1},Else);class Repeat{constructor(t,e,i){this.Il=i,this.Zl=0,this.location=t,this.tc=null,this.ec=e,this.ic=[],this.key=null,this.fs=0}Ee(t){this.sc(t);let e=this.ec._e;for(;null!==e;){if(ProxyObserver.ys(e.target)===ProxyObserver.ys(this)&&"items"===e.Eo){this.rc=e.Vo;break}e=e.Ke}this.nc=this.rc.sn.evaluate(t,this.$scope,null),this.fs||(t&LifecycleFlags.ts)>0?this.oc(null,t):this.hc(null,t)}de(t){const{ic:e,location:i}=this;for(let s=0,r=e.length;r>s;++s){const r=e[s];r.pl(i),r.pe(t)}}Re(t){const{ic:e}=this;for(let i=0,s=e.length;s>i;++i){const s=e[i];s.Ce(t),s.release(t)}}We(t){this.sc(t);const{ic:e}=this;for(let i=0,s=e.length;s>i;++i)e[i].ke(t)}lc(t,e,i){this.sc(i),i|=LifecycleFlags.h,this.fs||(i&LifecycleFlags.ts)>0?this.oc(null,i):this.hc(null,i)}at(t,e){e|=LifecycleFlags.Tt|LifecycleFlags.h,this.fs||(e&LifecycleFlags.ts)>0?this.oc(t,e):this.hc(t,e)}hc(t,e){ProxyObserver.ms(this)&&(e|=LifecycleFlags.M);const{ic:i,$lifecycle}=this;if(3&this.$state){const{nc:s,$scope,Il:r,rc:n,cc:o}=this,h=i.length,l=n.count(o);if(l>h){i.length=l;for(let t=h;l>t;++t)i[t]=r.create(e)}else if(h>l){$lifecycle.me();for(let t=l,s=i[t];h>t;s=i[++t])s.release(e),s.Ce(e);$lifecycle.Oe(e),$lifecycle.Ue();for(let t=l,s=i[t];h>t;s=i[++t])s.ke(e);if($lifecycle.ze(e),i.length=l,0===l)return}else if(0===l)return;$lifecycle.De(),n.nn(o,null===t?(t,r,n)=>{const o=i[r];o.Ne(e,Scope.Ss(e,$scope,o.$scope&&o.$scope.ws[s]===n?o.$scope.ws:BindingContext.create(e,s,n)))}:(r,n,o)=>{const h=i[n];h.Ne(e,Scope.Ss(e,$scope,!h.$scope||t[n]!==n&&h.$scope.ws[s]!==o?BindingContext.create(e,s,o):h.$scope.ws))}),$lifecycle.xe(e)}if(12&this.$state){const{location:s}=this;if($lifecycle.ue(),null===t)for(let t=0,r=i.length;r>t;++t){const r=i[t];r.pl(s),r.pe(e)}else for(let r=0,n=i.length;n>r;++r)if(t[r]!==r){const t=i[r];t.pl(s),t.pe(e)}$lifecycle.ge(e)}}oc(t,e){ProxyObserver.ms(this)&&(e|=LifecycleFlags.M);const{$lifecycle,nc:i,$scope,Il:s,rc:r,cc:n}=this;let o=this.ic;if(null===t){if(3&this.$state){$lifecycle.me();const t=o.length;let h;for(let i=0;t>i;++i)(h=o[i]).release(e),h.Ce(e);$lifecycle.Oe(e),$lifecycle.Ue();for(let i=0;t>i;++i)(h=o[i]).ke(e);$lifecycle.ze(e);const l=r.count(n);o=this.ic=Array(l),$lifecycle.De(),r.nn(n,(t,r,n)=>{(h=o[r]=s.create(e)).Ne(e,Scope.Ss(e,$scope,BindingContext.create(e,i,n)))}),$lifecycle.xe(e)}if(12&this.$state){const{location:t}=this;let i;$lifecycle.ue();const s=o.length;for(let r=0;s>r;++r)(i=o[r]).pl(t),i.pe(e);$lifecycle.ge(e)}}else{const r=t.length;let h;const l=t.jt,c=l.length;let a=0;if(3&this.$state){if(c>0){for($lifecycle.me(),a=0;c>a;++a)(h=o[l[a]]).release(e),h.Ce(e);for($lifecycle.Oe(e),$lifecycle.Ue(),a=0;c>a;++a)(h=o[l[a]]).ke(e);$lifecycle.ze(e),a=0;let i=0,s=0;for(l.sort();c>a;++a)for(o.splice(i=l[a]-a,1),s=0;r>s;++s)i>t[s]||--t[s]}for($lifecycle.De(),a=0;r>a;++a)-2===t[a]&&((h=s.create(e)).Ne(e,Scope.Ss(e,$scope,BindingContext.create(e,i,n[a]))),o.splice(a,0,h));if($lifecycle.xe(e),o.length!==r)throw Error(`viewsLen=${o.length}, mapLen=${r}`)}if(12&this.$state){const{location:i}=this,s=longestIncreasingSubsequence(t),r=s.length;$lifecycle.me(),$lifecycle.ue(),$lifecycle.ye({oi(){let n=i,l=r-1,c=t.length-1;for(;c>=0;--c)if(-2===t[c]){(h=o[c]).$state|=4;let t=h.be;for(;null!==t;)t.pe(e|LifecycleFlags.L),t=t.ve;h.$nodes.insertBefore(n),h.$state|=24,h.$state&=-5,n=h.$nodes.firstChild}else if(0>l||1===r||c!==s[l]){(h=o[t[c]]).$state|=32;let i=h.Fe;for(;null!==i;)i.Ce(e|LifecycleFlags.O),i=i.Ie;for(h.$nodes.remove(),h.$state&=-57,h.$state|=4,i=h.be;null!==i;)i.pe(e|LifecycleFlags.L),i=i.ve;h.$nodes.insertBefore(n),h.$state|=24,h.$state&=-5,n=h.$nodes.firstChild}else n=(h=o[c]).$nodes.firstChild,--l},li:null}),$lifecycle.Oe(e),$lifecycle.ge(e)}}}sc(t){const e=this.tc;if(3&this.$state){const i=this.tc=getCollectionObserver(t,this.$lifecycle,this.cc);e!==i&&e&&e.Wt(this),i&&i.qt(this)}else e&&e.Wt(this)}}Repeat.inject=[IRenderLocation,IRenderable,IViewFactory],__decorate([bindable],Repeat.prototype,"items",void 0),CustomAttributeResource.Rt({name:"repeat",isTemplateController:1},Repeat);class Replaceable{constructor(t,e){this.Il=t,this.currentView=this.Il.create(),this.currentView.pl(e)}Ee(t){this.currentView.Ne(t|LifecycleFlags.A,this.$scope)}de(t){this.currentView.pe(t)}Re(t){this.currentView.Ce(t)}We(t){this.currentView.ke(t)}}Replaceable.inject=[IViewFactory,IRenderLocation],CustomAttributeResource.Rt({name:"replaceable",isTemplateController:1},Replaceable);class With{constructor(t,e){this.value=null,this.Il=t,this.currentView=this.Il.create(),this.currentView.pl(e)}Jl(){3&this.$state&&this.ac(LifecycleFlags.I)}Ee(t){this.ac(t)}de(t){this.currentView.pe(t)}Re(t){this.currentView.Ce(t)}We(t){this.currentView.ke(t)}ac(t){const e=Scope.Ss(t,this.$scope,this.value);this.currentView.Ne(t,e)}}With.inject=[IViewFactory,IRenderLocation],__decorate([bindable],With.prototype,"value",void 0),CustomAttributeResource.Rt({name:"with",isTemplateController:1},With);const SCRIPT_REGEX=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,ISanitizer=DI.As("ISanitizer").$s(t=>t.singleton(class{uc(t){return t.replace(SCRIPT_REGEX,"")}}));class SanitizeValueConverter{constructor(t){this.dc=t}Bi(t){return null==t?null:this.dc.uc(t)}}SanitizeValueConverter.inject=[ISanitizer],ValueConverterResource.Rt("sanitize",SanitizeValueConverter);const{ul:enterStart,dl:leaveStart}=Profiler.fl("Aurelia.start"),{ul:enterStop,dl:leaveStop}=Profiler.fl("Aurelia.stop");class Aurelia{constructor(t=DI.fc()){this.Sl=t,this.gc=[],this.bc=[],this.pc=[],this.vc=0,this.yc=null,Registration.W(Aurelia,this).register(t,Aurelia)}register(...t){return this.Sl.register(...t),this}app(t){const host=t.host;this.Sl.get(IDOMInitializer).initialize(t);let component,e=LifecycleFlags.p,i=LifecycleFlags.v;t.M&&(e|=LifecycleFlags.M,i|=LifecycleFlags.M);const s=t.component;CustomElementResource.Es(s)?(this.Sl.register(s),component=this.Sl.get(CustomElementResource.yt(s.description.name))):component=s,component=ProxyObserver.ys(component);const r=()=>{host.$au=this,this.gc.includes(component)||(this.yc=component,this.gc.push(component),component.ri(e,this.Sl,host)),component.Ne(e|LifecycleFlags.m,null),component.pe(e|LifecycleFlags.L)};return this.bc.push(r),this.pc.push(()=>{component.Ce(i|LifecycleFlags.O),component.ke(i|LifecycleFlags.R),host.$au=null}),this.vc&&r(),this}root(){return ProxyObserver.ps(this.yc)}start(){for(const t of this.bc)t();return this.vc=1,this}stop(){this.vc=0;for(const t of this.pc)t();return this}}PLATFORM.global.Aurelia=Aurelia;const IDOMInitializer=DI.As("IDOMInitializer").pn();class Renderer{constructor(t){const e=this.mc={};t.forEach(t=>{e[t.Ti]=t})}static register(t){return Registration.singleton(IRenderer,this).register(t)}Ye(t,dom,e,i,targets,s,host,parts){const r=s.instructions,n=this.mc;if(targets.length!==r.length)throw Reporter.error(targets.length>r.length?30:31);for(let s=0,o=targets.length;o>s;++s){const instructions=r[s],o=targets[s];for(let s=0,r=instructions.length;r>s;++s){const r=instructions[s];n[r.type].Ye(t,dom,e,i,o,r,parts)}}if(host){const r=s.surrogates;for(let s=0,o=r.length;o>s;++s){const o=r[s];n[o.type].Ye(t,dom,e,i,host,o,parts)}}}}Renderer.inject=[all(IInstructionRenderer)];let SetPropertyRenderer=class{Ye(t,dom,e,i,s,r){s[r.to]=r.value}};SetPropertyRenderer=__decorate([instructionRenderer("re")],SetPropertyRenderer);let CustomElementRenderer=class{Ye(t,dom,e,i,s,r){const n=e.Ze(i,s,r,null,null,s,1),component=e.get(customElementKey(r.res)),o=e.get(IRenderer).mc,h=r.instructions;component.ri(t,e,s,r);for(let s=0,r=h.length;r>s;++s){const r=h[s];o[r.type].Ye(t,dom,e,i,component,r)}addComponent(i,component),n.vt()}};CustomElementRenderer=__decorate([instructionRenderer("ra")],CustomElementRenderer);let CustomAttributeRenderer=class{Ye(t,dom,e,i,s,r){const n=e.Ze(i,s,r),component=e.get(customAttributeKey(r.res)),o=e.get(IRenderer).mc,h=r.instructions;component.ri(t,e);for(let s=0,r=h.length;r>s;++s){const r=h[s];o[r.type].Ye(t,dom,e,i,component,r)}addComponent(i,component),n.vt()}};CustomAttributeRenderer=__decorate([instructionRenderer("rb")],CustomAttributeRenderer);let TemplateControllerRenderer=class{constructor(t){this.Rc=t}Ye(t,dom,e,i,s,r,parts){const n=this.Rc.Vl(dom,r.def,e),o=e.Ze(i,s,r,n,parts,dom.Lc(s),0),component=e.get(customAttributeKey(r.res)),h=e.get(IRenderer).mc,l=r.instructions;component.ri(t,e),r.link&&component.link(i.Fe);for(let s=0,r=l.length;r>s;++s){const r=l[s];h[r.type].Ye(t,dom,e,i,component,r)}addComponent(i,component),o.vt()}};TemplateControllerRenderer.inject=[IRenderingEngine],TemplateControllerRenderer=__decorate([instructionRenderer("rc")],TemplateControllerRenderer);let LetElementRenderer=class{constructor(t,e){this.Oc=t,this.Ct=e}Ye(t,dom,e,i,s,r){dom.remove(s);const n=r.instructions,toViewModel=r.toViewModel;for(let t=0,s=n.length;s>t;++t){const s=n[t],r=ensureExpression(this.Oc,s.from,48);addBinding(i,new LetBinding(r,s.to,this.Ct,e,toViewModel))}}};LetElementRenderer.inject=[IExpressionParser,IObserverLocator],LetElementRenderer=__decorate([instructionRenderer("rd")],LetElementRenderer);let CallBindingRenderer=class{constructor(t,e){this.Oc=t,this.Ct=e}Ye(t,dom,e,i,s,r){const n=ensureExpression(this.Oc,r.from,153);addBinding(i,new Call(n,s,r.to,this.Ct,e))}};CallBindingRenderer.inject=[IExpressionParser,IObserverLocator],CallBindingRenderer=__decorate([instructionRenderer("rh")],CallBindingRenderer);let RefBindingRenderer=class{constructor(t){this.Oc=t}Ye(t,dom,e,i,s,r){const n=ensureExpression(this.Oc,r.from,1280);addBinding(i,new Ref(n,s,e))}};RefBindingRenderer.inject=[IExpressionParser],RefBindingRenderer=__decorate([instructionRenderer("rj")],RefBindingRenderer);let InterpolationBindingRenderer=class{constructor(t,e){this.Oc=t,this.Ct=e}Ye(t,dom,e,i,s,r){let n;const o=ensureExpression(this.Oc,r.from,2048);addBinding(i,n=o.hn?new MultiInterpolationBinding(this.Ct,o,s,r.to,BindingMode.Bi,e):new InterpolationBinding(o.ln,o,s,r.to,BindingMode.Bi,this.Ct,e,1))}};InterpolationBindingRenderer.inject=[IExpressionParser,IObserverLocator],InterpolationBindingRenderer=__decorate([instructionRenderer("rf")],InterpolationBindingRenderer);let PropertyBindingRenderer=class{constructor(t,e){this.Oc=t,this.Ct=e}Ye(t,dom,e,i,s,r){const n=ensureExpression(this.Oc,r.from,48|r.mode);addBinding(i,new Binding(n,s,r.to,r.mode,this.Ct,e))}};PropertyBindingRenderer.inject=[IExpressionParser,IObserverLocator],PropertyBindingRenderer=__decorate([instructionRenderer("rg")],PropertyBindingRenderer);let IteratorBindingRenderer=class{constructor(t,e){this.Oc=t,this.Ct=e}Ye(t,dom,e,i,s,r){const n=ensureExpression(this.Oc,r.from,539);addBinding(i,new Binding(n,s,r.to,BindingMode.Bi,this.Ct,e))}};IteratorBindingRenderer.inject=[IExpressionParser,IObserverLocator],IteratorBindingRenderer=__decorate([instructionRenderer("rk")],IteratorBindingRenderer);class KeyedBindingBehavior{bind(t,e,i,s){i.target.key=s,i.target.fs=1}Js(t,e,i){i.target.key=null,i.target.fs=0}}BindingBehaviorResource.Rt("keyed",KeyedBindingBehavior);const IObserverLocatorRegistration=ObserverLocator,ILifecycleRegistration=Lifecycle,IRendererRegistration=Renderer,DefaultComponents=[ObserverLocator,Lifecycle,Renderer],IfRegistration=If,ElseRegistration=Else,RepeatRegistration=Repeat,ReplaceableRegistration=Replaceable,WithRegistration=With,SanitizeValueConverterRegistration=SanitizeValueConverter,DebounceBindingBehaviorRegistration=DebounceBindingBehavior,KeyedBindingBehaviorRegistration=KeyedBindingBehavior,OneTimeBindingBehaviorRegistration=OneTimeBindingBehavior,ToViewBindingBehaviorRegistration=ToViewBindingBehavior,FromViewBindingBehaviorRegistration=FromViewBindingBehavior,SignalBindingBehaviorRegistration=SignalBindingBehavior,ThrottleBindingBehaviorRegistration=ThrottleBindingBehavior,TwoWayBindingBehaviorRegistration=TwoWayBindingBehavior,DefaultResources=[If,Else,Repeat,Replaceable,With,SanitizeValueConverter,DebounceBindingBehavior,KeyedBindingBehaviorRegistration,OneTimeBindingBehavior,ToViewBindingBehavior,FromViewBindingBehavior,SignalBindingBehavior,ThrottleBindingBehavior,TwoWayBindingBehavior],CallBindingRendererRegistration=CallBindingRenderer,CustomAttributeRendererRegistration=CustomAttributeRenderer,CustomElementRendererRegistration=CustomElementRenderer,InterpolationBindingRendererRegistration=InterpolationBindingRenderer,IteratorBindingRendererRegistration=IteratorBindingRenderer,LetElementRendererRegistration=LetElementRenderer,PropertyBindingRendererRegistration=PropertyBindingRenderer,RefBindingRendererRegistration=RefBindingRenderer,SetPropertyRendererRegistration=SetPropertyRenderer,TemplateControllerRendererRegistration=TemplateControllerRenderer,DefaultRenderers=[PropertyBindingRendererRegistration,IteratorBindingRendererRegistration,CallBindingRendererRegistration,RefBindingRendererRegistration,InterpolationBindingRendererRegistration,SetPropertyRendererRegistration,CustomElementRendererRegistration,CustomAttributeRendererRegistration,TemplateControllerRendererRegistration,LetElementRendererRegistration],RuntimeBasicConfiguration={register:t=>t.register(...DefaultComponents,...DefaultResources,...DefaultRenderers),fc(){return this.register(DI.fc())}};class InterpolationInstruction{constructor(from,to){this.type="rf",this.from=from,this.to=to}}class OneTimeBindingInstruction{constructor(from,to){this.type="rg",this.from=from,this.mode=BindingMode.oneTime,this.oneTime=1,this.to=to}}class ToViewBindingInstruction{constructor(from,to){this.type="rg",this.from=from,this.mode=BindingMode.Bi,this.oneTime=0,this.to=to}}class FromViewBindingInstruction{constructor(from,to){this.type="rg",this.from=from,this.mode=BindingMode.Pi,this.oneTime=0,this.to=to}}class TwoWayBindingInstruction{constructor(from,to){this.type="rg",this.type="rg",this.from=from,this.mode=BindingMode.Si,this.oneTime=0,this.to=to}}class IteratorBindingInstruction{constructor(from,to){this.type="rk",this.from=from,this.to=to}}class CallBindingInstruction{constructor(from,to){this.type="rh",this.from=from,this.to=to}}class RefBindingInstruction{constructor(from){this.type="rj",this.from=from}}class SetPropertyInstruction{constructor(value,to){this.type="re",this.to=to,this.value=value}}class HydrateElementInstruction{constructor(res,instructions,parts){this.type="ra",this.instructions=instructions,this.parts=parts,this.res=res}}class HydrateAttributeInstruction{constructor(res,instructions){this.type="rb",this.instructions=instructions,this.res=res}}class HydrateTemplateController{constructor(def,res,instructions,link){this.type="rc",this.def=def,this.instructions=instructions,this.link=link,this.res=res}}class LetElementInstruction{constructor(instructions,toViewModel){this.type="rd",this.instructions=instructions,this.toViewModel=toViewModel}}class LetBindingInstruction{constructor(from,to){this.type="ri",this.from=from,this.to=to}}export{CallFunction,connects,observes,callsFunction,hasAncestor,isAssignable,isLeftHandSide,isPrimary,isResource,hasBind,hasUnbind,isLiteral,arePureLiterals,isPureLiteral,BindingBehavior,ValueConverter,Assign,Conditional,AccessThis,AccessScope,AccessMember,AccessKeyed,CallScope,CallMember,Binary,Unary,PrimitiveLiteral,HtmlLiteral,ArrayLiteral,ObjectLiteral,Template,TaggedTemplate,ArrayBindingPattern,ObjectBindingPattern,BindingIdentifier,ForOfStatement,Interpolation,Binding,Call,connectable,IExpressionParser,BindingType,MultiInterpolationBinding,InterpolationBinding,LetBinding,Ref,ArrayObserver,enableArrayObservation,disableArrayObservation,MapObserver,enableMapObservation,disableMapObservation,SetObserver,enableSetObservation,disableSetObservation,BindingContext,Scope,OverrideContext,collectionObserver,CollectionLengthObserver,computed,CustomSetterObserver,GetterObserver,IDirtyChecker,DirtyCheckProperty,DirtyCheckSettings,IObserverLocator,ITargetObserverLocator,ITargetAccessorLocator,getCollectionObserver,PrimitiveObserver,PropertyAccessor,propertyObserver,ProxyObserver,SelfObserver,SetterObserver,ISignaler,subscriberCollection,batchedSubscriberCollection,targetObserver,bindingBehavior,BindingBehaviorResource,BindingModeBehavior,OneTimeBindingBehavior,ToViewBindingBehavior,FromViewBindingBehavior,TwoWayBindingBehavior,DebounceBindingBehavior,SignalBindingBehavior,ThrottleBindingBehavior,customAttribute,CustomAttributeResource,dynamicOptions,templateController,If,Else,Repeat,Replaceable,With,containerless,customElement,CustomElementResource,IProjectorLocator,useShadowDOM,valueConverter,ValueConverterResource,ISanitizer,SanitizeValueConverter,bindable,Aurelia,IDOMInitializer,IfRegistration,ElseRegistration,RepeatRegistration,ReplaceableRegistration,WithRegistration,SanitizeValueConverterRegistration,DebounceBindingBehaviorRegistration,OneTimeBindingBehaviorRegistration,ToViewBindingBehaviorRegistration,FromViewBindingBehaviorRegistration,SignalBindingBehaviorRegistration,ThrottleBindingBehaviorRegistration,TwoWayBindingBehaviorRegistration,DefaultResources as BasicResources,IObserverLocatorRegistration as ObserverLocatorRegistration,ILifecycleRegistration as LifecycleRegistration,IRendererRegistration as RendererRegistration,RuntimeBasicConfiguration as BasicConfiguration,buildTemplateDefinition,isTargetedInstruction,ITargetedInstruction,TargetedInstructionType,INode,IRenderLocation,IDOM,NodeSequence,BindingMode,ExpressionKind,Hooks,LifecycleFlags,State,stringifyLifecycleFlags,CallBindingInstruction,FromViewBindingInstruction,HydrateAttributeInstruction,HydrateElementInstruction,HydrateTemplateController,InterpolationInstruction,IteratorBindingInstruction,LetBindingInstruction,LetElementInstruction,OneTimeBindingInstruction,RefBindingInstruction,SetPropertyInstruction,ToViewBindingInstruction,TwoWayBindingInstruction,AggregateLifecycleTask,CompositionCoordinator,ILifecycle,IRenderable,IViewFactory,LifecycleTask,PromiseTask,CollectionKind,DelegationStrategy,MutationKind,instructionRenderer,ensureExpression,addComponent,addBinding,CompiledTemplate,createRenderContext,IInstructionRenderer,IRenderer,IRenderingEngine,ITemplateCompiler,ITemplateFactory,ViewCompileFlags};
