(function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("@aurelia/kernel")):"function"==typeof define&&define.amd?define(["exports","@aurelia/kernel"],s):s((t=t||self).runtime={},t.kernel)})(this,function(t,kernel){"use strict";function s(t,s,i,n){var h,e,r=arguments.length,o=3>r?s:null===n?n=Object.getOwnPropertyDescriptor(s,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,s,i,n);else for(e=t.length-1;e>=0;e--)(h=t[e])&&(o=(3>r?h(o):r>3?h(s,i,o):h(s,i))||o);return r>3&&o&&Object.defineProperty(s,i,o),o}function subscriberCollection(s){return function(c){const u=c.prototype;switch(u.t=0,u.s=null,u.i=null,u.h=null,u.o=null,u.l=i,u.u=n,u.p=l,u.v=o,s){case t.MutationKind.m:u.g=h;break;case t.MutationKind.C:u.g=e;break;case t.MutationKind.O:u.g=r}}}function i(t){if(this.p(t))return 0;const s=this.t;return 1&s?2&s?4&s?8&s?(this.o.push(t),1):(this.o=[t],this.t|=8,1):(this.h=t,this.t|=4,1):(this.i=t,this.t|=2,1):(this.s=t,this.t|=1,1)}function n(t){const s=this.t;if(1&s&&this.s===t)return this.s=null,this.t&=-2,1;if(2&s&&this.i===t)return this.i=null,this.t&=-3,1;if(4&s&&this.h===t)return this.h=null,this.t&=-5,1;if(8&s){const s=this.o;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return s.splice(i,1),1===n&&(this.t&=-9),1}return 0}function h(t,s,i){const n=this.s,h=this.i,e=this.h;let r=this.o;null!==r&&(r=r.slice()),null!==n&&n.j(t,s,i),null!==h&&h.j(t,s,i),null!==e&&e.j(t,s,i);const o=r&&r.length;if(void 0!==o&&o>0)for(let n=0;o>n;++n){const h=r[n];null!==h&&h.j(t,s,i)}}function e(t,s,i){const n=this.s,h=this.i,e=this.h;let r=this.o;null!==r&&(r=r.slice()),null!==n&&n.j(t,s,i),null!==h&&h.j(t,s,i),null!==e&&e.j(t,s,i);const o=r&&r.length;if(void 0!==o&&o>0)for(let n=0;o>n;++n){const h=r[n];null!==h&&h.j(t,s,i)}this.A.T(this).catch(t=>{throw t})}function r(t,s,i,n){const h=this.s,e=this.i,r=this.h;let o=this.o;null!==o&&(o=o.slice()),null!==h&&h.j(t,s,i,n),null!==e&&e.j(t,s,i,n),null!==r&&r.j(t,s,i,n);const l=o&&o.length;if(void 0!==l&&l>0)for(let h=0;l>h;++h){const e=o[h];null!==e&&e.j(t,s,i,n)}}function o(){return 0!==this.t}function l(t){const s=this.t;if(1&s&&this.s===t)return 1;if(2&s&&this.i===t)return 1;if(4&s&&this.h===t)return 1;if(8&s){const s=this.o;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return 1}return 0}function batchedSubscriberCollection(){return function(t){const s=t.prototype;s.S=0,s.R=null,s.I=null,s.P=null,s.k=null,s.$=c,s.V=u,s.D=d,s.L=f,s.B=a}}function c(t){if(this.D(t))return 0;const s=this.S;return 1&s?2&s?4&s?8&s?(this.k.push(t),1):(this.k=[t],this.S|=8,1):(this.P=t,this.S|=4,1):(this.I=t,this.S|=2,1):(this.R=t,this.S|=1,1)}function u(t){const s=this.S;if(1&s&&this.R===t)return this.R=null,this.S&=-2,1;if(2&s&&this.I===t)return this.I=null,this.S&=-3,1;if(4&s&&this.P===t)return this.P=null,this.S&=-5,1;if(8&s){const s=this.k;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return s.splice(i,1),1===n&&(this.S&=-9),1}return 0}function a(t,s){const i=this.R,n=this.I,h=this.P;let e=this.k;null!==e&&(e=e.slice()),null!==i&&i.M(t,s),null!==n&&n.M(t,s),null!==h&&h.M(t,s);const r=e&&e.length;if(void 0!==r&&r>0)for(let i=0;r>i;++i){const n=e[i];null!==n&&n.M(t,s)}}function f(){return 0!==this.S}function d(t){const s=this.S;if(1&s&&this.R===t)return 1;if(2&s&&this.I===t)return 1;if(4&s&&this.P===t)return 1;if(8&s){const s=this.k;for(let i=0,n=s.length;n>i;++i)if(s[i]===t)return 1}return 0}function b(s){if(0==this.F){this.F=1;const{N:s,U:i}=this;this.q=s[i],It.get=(()=>this.H()),It.set=(value=>{this.K(value,t.LifecycleFlags.W)}),Rt(s,i,It)||kernel.Reporter.write(1,i,s)}this.l(s)}function p(){Reflect.deleteProperty(this.N,this.U),this.N=null,this.U=null,this.q=null}function propertyObserver(){return function(s){subscriberCollection(t.MutationKind.m)(s);const i=s.prototype;i.F=0,i.N=null,i.U=null,i.q=Symbol(),i.subscribe=i.subscribe||b,i.unsubscribe=i.unsubscribe||i.u,i._=i._||p}}function v(t){const s=BindingBehaviorResource.G(this.description.name);t.register(kernel.Registration.singleton(s,this))}function w(t){const s=this.kind.G(this.description.name);t.register(kernel.Registration.singleton(s,this))}function hasBind(t){return 2048==(2048&t.J)}function hasUnbind(t){return 4096==(4096&t.J)}function isLiteral(t){return 16384==(16384&t.J)}function arePureLiterals(t){if(void 0===t||0===t.length)return 1;for(let s=0;t.length>s;++s)if(!isPureLiteral(t[s]))return 0;return 1}function isPureLiteral(t){if(isLiteral(t))switch(t.J){case 17955:return arePureLiterals(t.elements);case 17956:return arePureLiterals(t.values);case 17958:return arePureLiterals(t.X);case 17925:return 1}return 0}function m(t,s,i,n){const h=n.length,e=Array(h);for(let r=0;h>r;++r)e[r]=n[r].evaluate(t,s,i);return e}function g(s,i,name){const n=null==i?null:i[name];if("function"==typeof n)return n;if(!(s&t.LifecycleFlags.Y)&&null==n)return null;throw kernel.Reporter.error(207,i,name,n)}function y(t){if(t===Nt){const s=xt.length=Ft.length=(Nt+=5)+1;for(let i=t+1;s>i;++i)xt[i]=`_observer${i}`,Ft[i]=`_observerVersion${i}`}}function C(t){const s=void 0===this.Z?0:this.Z;let i=s;for(;i--&&this[xt[i]]!==t;);if(-1===i){for(i=0;this[xt[i]];)i++;this[xt[i]]=t,t.subscribe(this),i===s&&(this.Z=i+1)}void 0===this.version&&(this.version=0),this[Ft[i]]=this.version,y(i)}function O(t,s,i){const n=this.st.tt(t,s,i);this.it(n)}function j(all){const t=this.Z;let s,i;if(1==all)for(let n=0;t>n;++n)null!=(i=this[s=xt[n]])&&(this[s]=null,i.unsubscribe(this));else{const n=this.version;for(let h=0;t>h;++h)this[Ft[h]]!==n&&null!=(i=this[s=xt[h]])&&(this[s]=null,i.unsubscribe(this))}}function T(t){const s=t.prototype;return s.hasOwnProperty("observeProperty")||(s.nt=O),s.hasOwnProperty("unobserve")||(s.unobserve=j),s.hasOwnProperty("addObserver")||(s.it=C),t}function connectable(t){return void 0===t?T:T(t)}function A(s,i){if(this.q!==(s=null==s?this.defaultValue:s)){if(this.q=s,!(i&(t.LifecycleFlags.ht|t.LifecycleFlags.et))||this.rt&&i&t.LifecycleFlags.ot)return this.lt=i,this.A.T(this);this.ct(s,i)}return Promise.resolve()}function S(s){if(this.rt&&s&t.LifecycleFlags.ot)return void this.A.T(this).catch(t=>{throw t});const i=this.q;this.oldValue!==i&&(this.ct(i,this.lt|s|t.LifecycleFlags.W),this.oldValue=this.q)}function R(){this.q=null,this.oldValue=null,this.defaultValue=null,this.N=null,this.U=""}function targetObserver(s=null){return function(i){subscriberCollection(t.MutationKind.m)(i);const n=i.prototype;n.ut=null,n.q=s,n.oldValue=s,n.defaultValue=s,n.N=null,n.U="",n.K=n.K||A,n.flush=n.flush||S,n._=n._||R}}function I(s){this.B(this.at,s|this.ft),this.dt&&this.dt.bt(t.LifecycleFlags.ht|t.LifecycleFlags.W|this.ft),this.pt()}function P(){this.C.vt=void 0,this.C=null,this.at=null}function k(){const t=this.C.length,s=this.at=Array(t);let i=0;for(;t>i;)s[i]=i++;s.wt=[]}function $(){const t=this.C.size,s=this.at=Array(t);let i=0;for(;t>i;)s[i]=i++;s.wt=[]}function V(){return void 0===this.dt?this.dt=new t.CollectionLengthObserver(this,this.gt):this.dt}function collectionObserver(s){return function(i){subscriberCollection(t.MutationKind.C)(i),batchedSubscriberCollection()(i);const n=i.prototype;n.ut=null,n.C=null,n.at=null,n.yt=0,n.gt=8&s?"length":"size",n.Ct=s,n.pt=8&s?k:$,n.flush=I,n._=P,n.Ot=V,n.subscribe=n.subscribe||n.l,n.unsubscribe=n.unsubscribe||n.u,n.jt=n.jt||n.$,n.Tt=n.Tt||n.V}}function D(t,s){return t===s?0:(s=null===s?"null":""+s)>(t=null===t?"null":""+t)?-1:1}function L(t,s){return void 0===t?void 0===s?0:1:void 0===s?-1:0}function B(t,s,from,to,i){let n,h,e,r,o,l,c;for(l=from+1;to>l;l++){for(n=t[l],h=s[l],c=l-1;c>=from&&(r=s[c],(o=i(e=t[c],n))>0);c--)t[c+1]=e,s[c+1]=r;t[c+1]=n,s[c+1]=h}}function M(t,s,from,to,i){let n,h,e,r,o,l,c,u,a,f,d,b,p,v,w,m,g,y,C,O=0,j=0;for(;;){if(10>=to-from)return void B(t,s,from,to,i);r=s[from],o=s[to-1],e=t[O=from+(to-from>>1)],l=s[O],(c=i(n=t[from],h=t[to-1]))>0&&(f=n,d=r,n=h,r=o,h=f,o=d),0>(u=i(n,e))?(a=i(h,e))>0&&(f=h,d=o,h=e,o=l,e=f,l=d):(f=n,d=r,n=e,r=l,e=h,l=o,h=f,o=d),t[from]=n,s[from]=r,t[to-1]=e,s[to-1]=l,b=h,p=o,w=to-1,t[O]=t[v=from+1],s[O]=s[v],t[v]=b,s[v]=p;t:for(j=v+1;w>j;j++)if(g=s[j],0>(y=i(m=t[j],b)))t[j]=t[v],s[j]=s[v],t[v]=m,s[v]=g,v++;else if(y>0){do{if(--w==j)break t;y=i(C=t[w],b)}while(y>0);t[j]=t[w],s[j]=s[w],t[w]=m,s[w]=g,0>y&&(m=t[j],g=s[j],t[j]=t[v],s[j]=s[v],t[v]=m,s[v]=g,v++)}v-from>to-w?(M(t,s,w,to,i),to=v):(M(t,s,from,v,i),from=w)}}function enableArrayObservation(){for(const t of ss)1!=Kt[t].F&&def(Kt,t,Object.assign({},ns,{value:is[t]}))}function x(s,i,n){return n.vt||new t.ArrayObserver(s,i,n)}function enableMapObservation(){for(const t of cs)1!=hs[t].F&&fs(hs,t,Object.assign({},as,{value:us[t]}))}function F(s,i,n){return n.vt||new t.MapObserver(s,i,n)}function enableSetObservation(){for(const t of ms)1!=ds[t].F&&Cs(ds,t,Object.assign({},ys,{value:gs[t]}))}function N(s,i,n){return n.vt||new t.SetObserver(s,i,n)}function getCollectionObserver(t,s,i){switch(Ss.call(i)){case"[object Array]":return x(t,s,i);case"[object Map]":return F(t,s,i);case"[object Set]":return N(t,s,i)}return null}function U(t,s,i){const n=this.At;kernel.PLATFORM.global.clearTimeout(n.St),n.St=kernel.PLATFORM.global.setTimeout(()=>{this.Rt(t,s,i)},n.It)}function E(t,s,i){const n=this.At;if(kernel.PLATFORM.global.clearTimeout(n.St),!(i&n.Pt))return n.oldValue=Ds,void this.Rt(t,s,i);n.oldValue===Ds&&(n.oldValue=s);const h=kernel.PLATFORM.global.setTimeout(()=>{const s=n.oldValue;n.oldValue=Ds,this.Rt(t,s,i)},n.It);n.St=h}function z(t){const s=this.kt,i=+new Date-s.$t;if(i>=s.It)return kernel.PLATFORM.global.clearTimeout(s.St),s.St=-1,s.$t=+new Date,void this.Vt(t);if(s.newValue=t,-1===s.St){const t=kernel.PLATFORM.global.setTimeout(()=>{s.St=-1,s.$t=+new Date,this.Vt(s.newValue)},s.It-i);s.St=t}}function q(name){return`${Bs}:${name}`}function Q(t){return void 0===t.$customElement?null:t.$customElement}function H(name){return`${Ms}:${name}`}function buildTemplateDefinition(t,s,template,cache,build,bindables,instructions,dependencies,surrogates,containerless,shadowOptions,hasSlots,i){const def=new Ns,n=arguments.length;switch(n){case 13:null!==i&&(def.Dt=i);case 12:null!==hasSlots&&(def.hasSlots=hasSlots);case 11:null!==shadowOptions&&(def.shadowOptions=shadowOptions);case 10:null!==containerless&&(def.containerless=containerless);case 9:null!==surrogates&&(def.surrogates=kernel.PLATFORM.toArray(surrogates));case 8:null!==dependencies&&(def.dependencies=kernel.PLATFORM.toArray(dependencies));case 7:null!==instructions&&(def.instructions=kernel.PLATFORM.toArray(instructions));case 6:null!==bindables&&(def.bindables=Object.assign({},bindables));case 5:null!==build&&(def.build=1==build?xs:0==build?Fs:Object.assign({},build));case 4:null!==cache&&(def.cache=cache);case 3:null!==template&&(def.template=template);case 2:null!==t&&(t.bindables&&(def.bindables=Object.assign({},t.bindables)),t.containerless&&(def.containerless=t.containerless),t.shadowOptions&&(def.shadowOptions=t.shadowOptions)),"string"==typeof s?s.length>0&&(def.name=s):null!==s&&(Us.forEach(t=>{s[t]&&(def[t]=s[t])}),Es.forEach(t=>{s[t]&&(def[t]=kernel.PLATFORM.toArray(s[t]))}),s.bindables&&(def.bindables===kernel.PLATFORM.Lt?def.bindables=Object.assign({},s.bindables):Object.assign(def.bindables,s.bindables)))}return 2!==n||null===t||"string"!=typeof s&&"build"in s||(def.build=xs),def}function K(s){if(8&this.$state)return;const i=this.$lifecycle;i.Bt(),this.$state|=4,s|=t.LifecycleFlags.Mt;const n=this.$hooks;16&n&&this.xt(s),this.$state|=8,this.$state&=-5,32&n&&i.Ft(this),i.Nt(s)}function W(s){if(8&this.$state)return;const i=this.$lifecycle;i.Bt(),this.$state|=4,s|=t.LifecycleFlags.Mt;const n=this.$hooks;16&n&&this.xt(s);let h=this.Ut;for(;null!==h;)h.Et(s),h=h.zt;i.qt(this),this.$state|=8,this.$state&=-5,32&n&&i.Ft(this),i.Nt(s)}function _(s){if(8&this.$state)return;this.$state|=4,s|=t.LifecycleFlags.Mt;let i=this.Ut;for(;null!==i;)i.Et(s),i=i.zt;this.$lifecycle.qt(this),this.$state|=8,this.$state&=-5}function G(s){if(8&this.$state){const i=this.$lifecycle;i.Qt(),this.$state|=32,s|=t.LifecycleFlags.Ht;const n=this.$hooks;64&n&&this.Kt(s),this.$state&=-41,128&n&&i.Wt(this),i._t(s)}}function J(s){if(8&this.$state){const i=this.$lifecycle;i.Qt(),this.$state|=32,(s|=t.LifecycleFlags.Ht)&t.LifecycleFlags.Gt^t.LifecycleFlags.Gt|s&t.LifecycleFlags.Jt&&(i.Xt(this),s|=t.LifecycleFlags.Gt);const n=this.$hooks;64&n&&this.Kt(s);let h=this.Yt;for(;null!==h;)h.Zt(s),h=h.ts;this.$state&=-41,128&n&&i.Wt(this),i._t(s)}}function X(s){if(8&this.$state){this.$state|=32,(s|=t.LifecycleFlags.Ht)&t.LifecycleFlags.Gt^t.LifecycleFlags.Gt|s&t.LifecycleFlags.Jt&&(this.$lifecycle.Xt(this),s|=t.LifecycleFlags.Gt);let i=this.Yt;for(;null!==i;)i.Zt(s),i=i.ts;this.$state&=-41}}function Y(s){2048&this.$hooks&&this.ss(s|=t.LifecycleFlags.ns)}function Z(s){s|=t.LifecycleFlags.ns,2048&this.$hooks&&this.ss(s);let i=this.Yt;for(;null!==i;)i.hs(s),i=i.ts}function tt(s){s|=t.LifecycleFlags.ns;let i=this.Yt;for(;null!==i;)i.hs(s),i=i.ts}function st(){16&this.$state||(this.$state|=16,this.rs.es(this.$nodes))}function it(){16&this.$state&&(this.$state&=-17,this.rs.os(this.$nodes))}function nt(){16&this.$state||(this.$state|=16,this.$nodes.insertBefore(this.location))}function ht(){return 16&this.$state?(this.$state&=-17,this.$nodes.remove(),this.ls&&(this.ls=0,this.cache.cs(this))?(this.$state|=128,1):0):0}function et(s,i){if(s|=t.LifecycleFlags.et,2&this.$state){if(this.$scope===i)return;this.us(s)}const n=this.$lifecycle;n.as(),this.$state|=1;const h=this.$hooks;8&h&&n.fs(this),this.$scope=i,4&h&&this.ds(s),this.$state|=2,this.$state&=-2,n.bs(s)}function rt(s,i){if(2&this.$state)return;const n=this.$scope;n.ps=i;const h=this.$lifecycle;h.as(),this.$state|=1;const e=this.$hooks;s|=t.LifecycleFlags.et,8&e&&h.fs(this);let r=this.vs;for(;null!==r;)r.ws(s,n),r=r.ms;4&e&&this.ds(s);let component=this.Ut;for(;null!==component;)component.ws(s,n),component=component.zt;this.$state|=2,this.$state&=-2,h.bs(s)}function ot(s,i){if(s|=t.LifecycleFlags.et,2&this.$state){if(this.$scope===i)return;this.us(s)}this.$state|=1,this.$scope=i;let n=this.vs;for(;null!==n;)n.ws(s,i),n=n.ms;let component=this.Ut;for(;null!==component;)component.ws(s,i),component=component.zt;this.$state|=2,this.$state&=-2}function lt(s){if(s|=t.LifecycleFlags.et,2&this.$state)return;this.$state|=1;const i=this.$scope;let n=this.vs;for(;null!==n;)n.ws(s,i),n=n.ms;let component=this.Ut;for(;null!==component;)component.ws(s,i),component=component.zt;this.$state|=2,this.$state&=-2}function ct(s){if(2&this.$state){const i=this.$lifecycle;i.gs(),this.$state|=64;const n=this.$hooks;s|=t.LifecycleFlags.ys,512&n&&i.Cs(this),256&n&&this.Os(s),this.$state&=-67,i.js(s)}}function ut(s){if(2&this.$state){const i=this.$lifecycle;i.gs(),this.$state|=64;const n=this.$hooks;s|=t.LifecycleFlags.ys,512&n&&i.Cs(this),256&n&&this.Os(s);let component=this.Yt;for(;null!==component;)component.us(s),component=component.ts;let h=this.Ts;for(;null!==h;)h.us(s),h=h.As;this.$scope.ps=null,this.$state&=-67,i.js(s)}}function at(s){if(2&this.$state){this.$state|=64,s|=t.LifecycleFlags.ys;let component=this.Yt;for(;null!==component;)component.us(s),component=component.ts;let i=this.Ts;for(;null!==i;)i.us(s),i=i.As;this.$state&=-67,this.$scope=null}}function ft(s){if(2&this.$state){this.$state|=64,s|=t.LifecycleFlags.ys;let component=this.Yt;for(;null!==component;)component.us(s),component=component.ts;let i=this.Ts;for(;null!==i;)i.us(s),i=i.As;this.$state&=-67}}function createRenderContext(dom,t,dependencies,s){const i=t.Ss(),n=new Gs,h=new Gs,e=new Gs,r=new Js,o=new Gs,l=i.get(IRenderer);return dom.Rs(i,h),i.Is(IViewFactory,r),i.Is(IRenderable,n),i.Is(ITargetedInstruction,e),i.Is(IRenderLocation,o),dependencies&&i.register(...dependencies),s&&s.register(i),i.Ps=function(t,s,targets,i,host,parts){l.Ps(t,dom,this,s,targets,i,host,parts)},i.ks=function(t,s,l,c,parts,u){return n.$s(t),h.$s(s),e.$s(l),c&&r.$s(c,parts),u&&o.$s(u),i},i._=function(){r._(),n._(),e._(),h._(),o._()},i}function dt(t){const s=[];for(let i=0,n=t.length;n>i;++i){const component=Q(t[i]);null!==component&&s.push(component)}return s}function bt(s,i,name){Reflect.defineProperty(i,name,{Vs:1,get(){return this.Ds[name].H()},set(value){this.Ds[name].K(value,s&t.LifecycleFlags.Ls|t.LifecycleFlags.W)}})}function pt(t){const s=this.kind.G(this.description.name);t.register(kernel.Registration.transient(s,this))}function vt(t){return t.containerless=1,t}function wt(t,s){const i=this.constructor;s.get(IRenderingEngine).Bs(t,i,this),2&this.$hooks&&this.Ms(t)}function mt(s,i,host,n=kernel.PLATFORM.Lt){const h=this.constructor,e=h.description,r=i.get(IProjectorLocator),o=i.get(IRenderingEngine),dom=i.get(IDOM);let l;if(l=s&t.LifecycleFlags.Dt?t.ProxyObserver.xs(this).O:this,this.$scope=Scope.create(s,l,null),this.Fs=host,this.rs=r.Ns(dom,this,host,e),o.Bs(s,h,this),1024&this.$hooks){const t=this.Ps(s,host,n.parts,i);t&&"getElementTemplate"in t&&t.Us(o,h,i).Ps(this,host,n.parts)}else o.Us(dom,e,i,h).Ps(this,host,n.parts);2&this.$hooks&&this.Ms(s)}function gt(t){const s=this.description,i=this.kind.G(s.name),aliases=s.aliases;t.register(kernel.Registration.transient(i,this));for(let s=0,n=aliases.length;n>s;++s){const n=this.kind.G(aliases[s]);t.register(kernel.Registration.Es(i,n))}}function yt(t){return t.zs=1,t}function bindable(s,i){let n;const h=function(s,i){const h=s.constructor;let bindables=h.bindables;void 0===bindables&&(bindables=h.bindables={}),n.qs||(n.qs=kernel.PLATFORM.Qs(i)),n.Hs||(n.Hs=`${i}Changed`),void 0===n.mode&&(n.mode=t.BindingMode.Ks),void 0===n.Dt&&(n.Dt=0),arguments.length>1&&(n.Ws=i),bindables[n.Ws]=n};return arguments.length>1?(n={},void h(s,i)):"string"==typeof s?(n={},h):(n=s||{},h)}function instructionRenderer(t){return function(s){const i=function(...i){const n=new s(...i);return n._s=t,n};i.register=function(t){return kernel.Registration.singleton(IInstructionRenderer,i).register(t,IInstructionRenderer)};const n=Object.getOwnPropertyDescriptors(s);return Object.keys(n).filter(t=>"prototype"!==t).forEach(t=>{Reflect.defineProperty(i,t,n[t])}),i}}function ensureExpression(t,s,i){return"string"==typeof s?t.parse(s,i):s}function addBinding(t,s){s.As=t.Ts,s.ms=null,null===t.Ts?t.vs=s:t.Ts.ms=s,t.Ts=s}function addComponent(t,component){component.ts=t.Yt,component.zt=null,null===t.Yt?t.Ut=component:t.Yt.zt=component,t.Yt=component}var Ct,Ot,jt,Tt,BindingMode,State,Hooks,LifecycleFlags,ExpressionKind,DelegationStrategy,MutationKind,CollectionKind,BindingType,TargetedInstructionType,ViewCompileFlags;(BindingMode=t.BindingMode||(t.BindingMode={}))[BindingMode.oneTime=1]="oneTime",BindingMode[BindingMode.Ks=2]="toView",BindingMode[BindingMode.Gs=4]="fromView",BindingMode[BindingMode.Js=6]="twoWay",BindingMode[BindingMode.default=8]="default",(State=t.State||(t.State={}))[State.Xs=0]="none",State[State.Ys=1]="isBinding",State[State.Zs=2]="isBound",State[State.ti=4]="isAttaching",State[State.si=8]="isAttached",State[State.ii=16]="isMounted",State[State.ni=32]="isDetaching",State[State.hi=64]="isUnbinding",State[State.ei=128]="isCached",State[State.ri=256]="isContainerless",(Hooks=t.Hooks||(t.Hooks={}))[Hooks.Xs=1]="none",Hooks[Hooks.oi=2]="hasCreated",Hooks[Hooks.li=4]="hasBinding",Hooks[Hooks.ci=8]="hasBound",Hooks[Hooks.ui=16]="hasAttaching",Hooks[Hooks.ai=32]="hasAttached",Hooks[Hooks.fi=64]="hasDetaching",Hooks[Hooks.di=128]="hasDetached",Hooks[Hooks.bi=256]="hasUnbinding",Hooks[Hooks.pi=512]="hasUnbound",Hooks[Hooks.vi=1024]="hasRender",Hooks[Hooks.wi=2048]="hasCaching",(LifecycleFlags=t.LifecycleFlags||(t.LifecycleFlags={}))[LifecycleFlags.Xs=0]="none",LifecycleFlags[LifecycleFlags.Y=524288]="mustEvaluate",LifecycleFlags[LifecycleFlags.mi=3]="mutation",LifecycleFlags[LifecycleFlags.gi=1]="isCollectionMutation",LifecycleFlags[LifecycleFlags.yi=2]="isInstanceMutation",LifecycleFlags[LifecycleFlags.update=28]="update",LifecycleFlags[LifecycleFlags.Ci=4]="updateTargetObserver",LifecycleFlags[LifecycleFlags.W=8]="updateTargetInstance",LifecycleFlags[LifecycleFlags.Oi=16]="updateSourceExpression",LifecycleFlags[LifecycleFlags.from=524256]="from",LifecycleFlags[LifecycleFlags.ht=224]="fromFlush",LifecycleFlags[LifecycleFlags.ji=32]="fromAsyncFlush",LifecycleFlags[LifecycleFlags.Ti=64]="fromSyncFlush",LifecycleFlags[LifecycleFlags.Ai=128]="fromTick",LifecycleFlags[LifecycleFlags.Si=256]="fromStartTask",LifecycleFlags[LifecycleFlags.Jt=512]="fromStopTask",LifecycleFlags[LifecycleFlags.et=1024]="fromBind",LifecycleFlags[LifecycleFlags.ys=2048]="fromUnbind",LifecycleFlags[LifecycleFlags.Mt=4096]="fromAttach",LifecycleFlags[LifecycleFlags.Ht=8192]="fromDetach",LifecycleFlags[LifecycleFlags.ns=16384]="fromCache",LifecycleFlags[LifecycleFlags.Ri=32768]="fromDOMEvent",LifecycleFlags[LifecycleFlags.Ii=65536]="fromObserverSetter",LifecycleFlags[LifecycleFlags.Pi=131072]="fromBindableHandler",LifecycleFlags[LifecycleFlags.ki=262144]="fromLifecycleTask",LifecycleFlags[LifecycleFlags.Gt=1048576]="parentUnmountQueued",LifecycleFlags[LifecycleFlags.ot=2097152]="doNotUpdateDOM",LifecycleFlags[LifecycleFlags.$i=4194304]="isTraversingParentScope",LifecycleFlags[LifecycleFlags.Ls=58720256]="persistentBindingFlags",LifecycleFlags[LifecycleFlags.Vi=8388608]="allowParentScopeTraversal",LifecycleFlags[LifecycleFlags.Dt=16777216]="useProxies",LifecycleFlags[LifecycleFlags.Di=33554432]="keyedMode",(ExpressionKind=t.ExpressionKind||(t.ExpressionKind={}))[ExpressionKind.Connects=32]="Connects",ExpressionKind[ExpressionKind.Observes=64]="Observes",ExpressionKind[ExpressionKind.CallsFunction=128]="CallsFunction",ExpressionKind[ExpressionKind.HasAncestor=256]="HasAncestor",ExpressionKind[ExpressionKind.IsPrimary=512]="IsPrimary",ExpressionKind[ExpressionKind.IsLeftHandSide=1024]="IsLeftHandSide",ExpressionKind[ExpressionKind.HasBind=2048]="HasBind",ExpressionKind[ExpressionKind.HasUnbind=4096]="HasUnbind",ExpressionKind[ExpressionKind.IsAssignable=8192]="IsAssignable",ExpressionKind[ExpressionKind.IsLiteral=16384]="IsLiteral",ExpressionKind[ExpressionKind.IsResource=32768]="IsResource",ExpressionKind[ExpressionKind.Li=65536]="IsForDeclaration",ExpressionKind[ExpressionKind.Bi=31]="Type",ExpressionKind[ExpressionKind.AccessThis=1793]="AccessThis",ExpressionKind[ExpressionKind.AccessScope=10082]="AccessScope",ExpressionKind[ExpressionKind.ArrayLiteral=17955]="ArrayLiteral",ExpressionKind[ExpressionKind.ObjectLiteral=17956]="ObjectLiteral",ExpressionKind[ExpressionKind.PrimitiveLiteral=17925]="PrimitiveLiteral",ExpressionKind[ExpressionKind.Template=17958]="Template",ExpressionKind[ExpressionKind.Unary=39]="Unary",ExpressionKind[ExpressionKind.CallScope=1448]="CallScope",ExpressionKind[ExpressionKind.CallMember=1161]="CallMember",ExpressionKind[ExpressionKind.CallFunction=1162]="CallFunction",ExpressionKind[ExpressionKind.AccessMember=9323]="AccessMember",ExpressionKind[ExpressionKind.AccessKeyed=9324]="AccessKeyed",ExpressionKind[ExpressionKind.TaggedTemplate=1197]="TaggedTemplate",ExpressionKind[ExpressionKind.Binary=46]="Binary",ExpressionKind[ExpressionKind.Conditional=63]="Conditional",ExpressionKind[ExpressionKind.Assign=8208]="Assign",ExpressionKind[ExpressionKind.ValueConverter=36913]="ValueConverter",ExpressionKind[ExpressionKind.BindingBehavior=38962]="BindingBehavior",ExpressionKind[ExpressionKind.HtmlLiteral=51]="HtmlLiteral",ExpressionKind[ExpressionKind.ArrayBindingPattern=65556]="ArrayBindingPattern",ExpressionKind[ExpressionKind.ObjectBindingPattern=65557]="ObjectBindingPattern",ExpressionKind[ExpressionKind.BindingIdentifier=65558]="BindingIdentifier",ExpressionKind[ExpressionKind.ForOfStatement=6199]="ForOfStatement",ExpressionKind[ExpressionKind.Interpolation=24]="Interpolation",(function(t){t[t.Mi=0]="None",t[t.xi=1]="Subscriber0",t[t.Fi=2]="Subscriber1",t[t.Ni=4]="Subscriber2",t[t.Ui=8]="SubscribersRest",t[t.Ei=15]="Any"})(Ct||(Ct={})),(DelegationStrategy=t.DelegationStrategy||(t.DelegationStrategy={}))[DelegationStrategy.Xs=0]="none",DelegationStrategy[DelegationStrategy.zi=1]="capturing",DelegationStrategy[DelegationStrategy.qi=2]="bubbling",(MutationKind=t.MutationKind||(t.MutationKind={}))[MutationKind.m=1]="instance",MutationKind[MutationKind.C=2]="collection",MutationKind[MutationKind.O=4]="proxy",(CollectionKind=t.CollectionKind||(t.CollectionKind={}))[CollectionKind.Qi=8]="indexed",CollectionKind[CollectionKind.Hi=4]="keyed",CollectionKind[CollectionKind.Ki=9]="array",CollectionKind[CollectionKind.map=6]="map",CollectionKind[CollectionKind.set=7]="set";const At=new WeakMap;let St=class{constructor(t,s,i){this.raw=s,this.key=i,this.O=t,this.subscribe=this.l,this.unsubscribe=this.u}K(value,s){const i=this.raw[this.key];i!==value&&(this.raw[this.key]=value,this.g(value,i,s|t.LifecycleFlags.Dt|t.LifecycleFlags.W))}H(){return this.raw[this.key]}};St=s([subscriberCollection(t.MutationKind.m)],St),t.ProxyObserver=Ot=class{constructor(t){this.raw=t,this.O=new Proxy(t,this),At.set(t,this.O),this.Wi={}}static _i(t){if(void 0===t.Gi){const s=At.get(t);return void 0===s?t:s}return t}static Ji(t){const s=t.Gi;return void 0===s?t:s}static xs(t,s){let i;if(void 0===t.Gi){const s=At.get(t);i=void 0===s?new Ot(t):s.vt}else i=t.vt;if(1===arguments.length)return i;let n=i.Wi[s];if(void 0===n){const h=this.Ji(t);n=i.Wi[s]=new St(i.O,h,s)}return n}static Xi(t){return void 0!==t.Gi}get(t,s,i){return"$observer"===s?this:"$raw"===s?t:t[s]}set(s,i,value,n){const h=s[i];return h!==value&&(Reflect.set(s,i,value,s),this.Yi(value,h,i),this.g(i,value,h,t.LifecycleFlags.Dt|t.LifecycleFlags.W)),1}deleteProperty(s,i){const n=s[i];return Reflect.deleteProperty(s,i)?(void 0!==n&&(this.Yi(void 0,n,i),this.g(i,void 0,n,t.LifecycleFlags.Dt|t.LifecycleFlags.W)),1):0}defineProperty(s,i,n){const h=s[i];return Reflect.defineProperty(s,i,n)?(n.value!==h&&(this.Yi(n.value,h,i),this.g(i,n.value,h,t.LifecycleFlags.Dt|t.LifecycleFlags.W)),1):0}apply(t,s,i){return Reflect.apply(t,t,i)}subscribe(t,s){if(1===arguments.length)this.l(t);else{let i=this.Wi[s];void 0===i&&(i=this.Wi[s]=new St(this.O,this.raw,s)),i.l(t)}}unsubscribe(t,s){if(1===arguments.length)this.u(t);else{const i=this.Wi[s];void 0!==i&&i.u(t)}}Yi(s,i,n){const h=this.Wi[n];void 0!==h&&h.g(s,i,t.LifecycleFlags.Dt|t.LifecycleFlags.W)}},t.ProxyObserver=Ot=s([subscriberCollection(t.MutationKind.O)],t.ProxyObserver);const Rt=Reflect.defineProperty,It={get:void 0,set:void 0,Vs:1,Zi:1};t.SetterObserver=class{constructor(s,i,n){this.ft=s&t.LifecycleFlags.Ls,this.N=i,this.U=n}H(){return this.q}K(s,i){const n=this.q;n!==s&&(this.q=s,i&t.LifecycleFlags.et||this.g(s,n,this.ft|i),this.F||(this.N[this.U]=s))}},t.SetterObserver=s([propertyObserver()],t.SetterObserver),(function(t){t[t.tn=250]="UndefinedScope",t[t.sn=251]="NullScope",t[t.in=252]="NilOverrideContext",t[t.nn=253]="NilParentScope"})(jt||(jt={}));class Pt{xs(s,i,n){return void 0===this[n]&&(this[n]=new t.SetterObserver(s,i,n)),this[n]}}class BindingContext{constructor(t,value){if(this.hn=1,void 0!==t)if(void 0!==value)this[t]=value;else for(const s in t)t.hasOwnProperty(s)&&(this[s]=t[s])}static create(s,i,value){const n=new BindingContext(i,value);return s&t.LifecycleFlags.Dt?t.ProxyObserver.xs(n).O:n}static get(s,name,i,n){if(void 0===s)throw kernel.Reporter.error(250);if(null===s)throw kernel.Reporter.error(251);let h=s.en;if(i>0){for(;i>0;){if(null===h.rn)return;i--,h=h.rn}return name in h?h:h.on}for(;h&&!(name in h)&&!(h.on&&name in h.on);)h=h.rn;if(h)return name in h?h:h.on;if(n&t.LifecycleFlags.Vi&&null!==s.ps){const h=this.get(s.ps,name,i,n&~t.LifecycleFlags.Vi|t.LifecycleFlags.$i);if(null!==h)return h}return n&t.LifecycleFlags.$i?null:s.on||s.en}ln(t){return void 0===this.Ds&&(this.Ds=new Pt),this.Ds}}class Scope{constructor(t,s){this.on=t,this.en=s,this.ps=null}static create(t,s,i){return new Scope(s,null==i?OverrideContext.create(t,s,i):i)}static cn(t,s){if(null==s)throw kernel.Reporter.error(252);return new Scope(s.on,s)}static un(t,s,i){if(null==s)throw kernel.Reporter.error(253);return new Scope(i,OverrideContext.create(t,i,s.en))}}class OverrideContext{constructor(t,s){this.hn=1,this.on=t,this.rn=s}static create(t,s,i){return new OverrideContext(s,void 0===i?null:i)}ln(){return void 0===this.Ds&&(this.Ds=new Pt),this.Ds}}const ISignaler=kernel.DI.fn("ISignaler").an(t=>t.singleton(kt));class kt{constructor(){this.dn=Object.create(null)}bn(name,s){const i=this.dn[name];if(void 0!==i)for(const n of i.keys())n.j(void 0,void 0,s|t.LifecycleFlags.W)}pn(name,t){const s=this.dn,i=s[name];void 0===i?s[name]=new Set([t]):i.add(t)}vn(name,t){const s=this.dn[name];s&&s.delete(t)}}const BindingBehaviorResource={name:"binding-behavior",G(name){return`${this.name}:${name}`},wn(t){return t.kind===this},mn(t,s){const i=s,n="string"==typeof t?{name:t}:t;return i.kind=BindingBehaviorResource,i.description=n,i.register=v,i}},ValueConverterResource={name:"value-converter",G(name){return`${this.name}:${name}`},wn(t){return t.kind===this},mn(t,s){const i=s,n="string"==typeof t?{name:t}:t;return i.kind=ValueConverterResource,i.description=n,i.register=w,i}};(function(t){t[t.gn=202]="NoLocator",t[t.yn=203]="NoBehaviorFound",t[t.Cn=204]="BehaviorAlreadyApplied",t[t.On=205]="NoConverterFound",t[t.jn=206]="NoBinding",t[t.Tn=207]="NotAFunction",t[t.An=208]="UnknownOperator",t[t.tn=250]="UndefinedScope",t[t.sn=251]="NullScope"})(Tt||(Tt={}));class AccessThis{constructor(t=0){this.J=1793,this.assign=kernel.PLATFORM.Sn,this.connect=kernel.PLATFORM.Sn,this.Rn=t}evaluate(t,s,i){if(void 0===s)throw kernel.Reporter.error(250,this);if(null===s)throw kernel.Reporter.error(251,this);let n=s.en,h=this.Rn;for(;h--&&n;)n=n.rn;return 1>h&&n?n.on:void 0}accept(t){return t.In(this)}}AccessThis.Pn=new AccessThis(0),AccessThis.kn=new AccessThis(1);class AccessScope{constructor(name,t=0){this.J=10082,this.name=name,this.Rn=t}evaluate(t,s,i){return BindingContext.get(s,this.name,this.Rn,t)[this.name]}assign(t,s,i,value){const n=BindingContext.get(s,this.name,this.Rn,t);return n?n[this.name]=value:void 0}connect(t,s,i){const n=BindingContext.get(s,this.name,this.Rn,t);i.nt(t,n,this.name)}accept(t){return t.$n(this)}}class AccessMember{constructor(t,name){this.J=9323,this.object=t,this.name=name}evaluate(t,s,i){const n=this.object.evaluate(t,s,i);return null==n?n:n[this.name]}assign(t,s,i,value){let n=this.object.evaluate(t,s,i);return null!==n&&"object"==typeof n||this.object.assign(t,s,i,n={}),n[this.name]=value,value}connect(t,s,i){const n=this.object.evaluate(t,s,null);this.object.connect(t,s,i),n&&i.nt(t,n,this.name)}accept(t){return t.Vn(this)}}class CallScope{constructor(name,t,s=0){this.J=1448,this.assign=kernel.PLATFORM.Sn,this.name=name,this.Dn=t,this.Rn=s}evaluate(t,s,i){const n=m(t,s,i,this.Dn),h=BindingContext.get(s,this.name,this.Rn,t),e=g(t,h,this.name);if(e)return e.apply(h,n)}connect(t,s,i){const n=this.Dn;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i)}accept(t){return t.Ln(this)}}class CallMember{constructor(t,name,s){this.J=1161,this.assign=kernel.PLATFORM.Sn,this.object=t,this.name=name,this.Dn=s}evaluate(t,s,i){const n=this.object.evaluate(t,s,i),h=m(t,s,i,this.Dn),e=g(t,n,this.name);if(e)return e.apply(n,h)}connect(s,i,n){const h=this.object.evaluate(s,i,null);if(this.object.connect(s,i,n),g(s&~t.LifecycleFlags.Y,h,this.name)){const t=this.Dn;for(let h=0,e=t.length;e>h;++h)t[h].connect(s,i,n)}}accept(t){return t.Bn(this)}}class PrimitiveLiteral{constructor(value){this.J=17925,this.assign=kernel.PLATFORM.Sn,this.connect=kernel.PLATFORM.Sn,this.value=value}evaluate(t,s,i){return this.value}accept(t){return t.Mn(this)}}PrimitiveLiteral.xn=new PrimitiveLiteral(void 0),PrimitiveLiteral.Fn=new PrimitiveLiteral(null),PrimitiveLiteral.Nn=new PrimitiveLiteral(1),PrimitiveLiteral.Un=new PrimitiveLiteral(0),PrimitiveLiteral.En=new PrimitiveLiteral("");class ArrayLiteral{constructor(t){this.J=17955,this.assign=kernel.PLATFORM.Sn,this.elements=t}evaluate(t,s,i){const n=this.elements,h=n.length,e=Array(h);for(let r=0;h>r;++r)e[r]=n[r].evaluate(t,s,i);return e}connect(t,s,i){const n=this.elements;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i)}accept(t){return t.zn(this)}}ArrayLiteral.En=new ArrayLiteral(kernel.PLATFORM.qn);class ObjectLiteral{constructor(t,s){this.J=17956,this.assign=kernel.PLATFORM.Sn,this.keys=t,this.values=s}evaluate(t,s,i){const n={},h=this.keys,e=this.values;for(let r=0,o=h.length;o>r;++r)n[h[r]]=e[r].evaluate(t,s,i);return n}connect(t,s,i){const n=this.values;for(let h=0,e=this.keys.length;e>h;++h)n[h].connect(t,s,i)}accept(t){return t.Qn(this)}}ObjectLiteral.En=new ObjectLiteral(kernel.PLATFORM.qn,kernel.PLATFORM.qn);class Template{constructor(t,s){this.J=17958,this.assign=kernel.PLATFORM.Sn,this.Hn=t,this.X=void 0===s?kernel.PLATFORM.qn:s}evaluate(t,s,i){const n=this.X,h=this.Hn;let e=h[0];for(let r=0,o=n.length;o>r;++r)e+=n[r].evaluate(t,s,i),e+=h[r+1];return e}connect(t,s,i){const n=this.X;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i),h++}accept(t){return t.Kn(this)}}Template.En=new Template([""]);const $t={}.toString,Vt={Wn(t,s){for(let i=0,n=t.length;n>i;++i)s(t,i,t[i])},_n(t,s){const i=Array(t.size);let n=-1;for(const s of t.entries())i[++n]=s;Vt["Wn"](i,s)},Gn(t,s){const i=Array(t.size);let n=-1;for(const s of t.keys())i[++n]=s;Vt["Wn"](i,s)},Jn(t,s){const i=Array(t);for(let s=0;t>s;++s)i[s]=s;Vt["Wn"](i,s)},Xn(t,s){},Yn(t,s){}},Dt={Wn:t=>t.length,_n:t=>t.size,Gn:t=>t.size,Jn:t=>t,Xn:()=>0,Yn:()=>0},IRenderable=kernel.DI.fn("IRenderable").Zn(),IViewFactory=kernel.DI.fn("IViewFactory").Zn(),Lt=Object.freeze(Object.create(null)),ILifecycle=kernel.DI.fn("ILifecycle").an(t=>t.singleton(Bt));class Bt{constructor(){this.th=0,this.sh=0,this.ih=0,this.nh=0,this.hh=this,this.eh=this,this.rh=this,this.oh=this,this.lh=this,this.uh=this,this.ah=this,this.fh=this,this.dh=this,this.bh=this,this.ph=this,this.vh=this,this.wh=this,this.mh=this,this.gh=this,this.yh=this,this.Ch=this,this.Oh=this,this.jh=this,this.Th=this,this.Ah=null,this.Sh=Promise.resolve(),this.Rh=0,this.Ih=0,this.Ph=0,this.kh=0,this.$h=0,this.Vh=0,this.Dh=0,this.Lh=0,this.Bh=0,this.Mh=0,this.ut=Lt,this.flush=kernel.PLATFORM.Sn,this.xh=Lt,this.connect=kernel.PLATFORM.Sn,this.Fh=Lt,this.bt=kernel.PLATFORM.Sn,this.Nh=Lt,this.bound=kernel.PLATFORM.Sn,this.Uh=Lt,this.Eh=kernel.PLATFORM.Sn,this.zh=Lt,this.qh=kernel.PLATFORM.Sn,this.Qh=Lt,this.Hh=kernel.PLATFORM.Sn,this.Kh=Lt,this.Wh=kernel.PLATFORM.Sn,this._h=Lt,this.us=kernel.PLATFORM.Sn,this.Gh=Lt,this.Jh=kernel.PLATFORM.Sn,this.Xh=null}static register(t){return kernel.Registration.singleton(ILifecycle,this).register(t)}Yh(t){null===this.Xh&&(this.Xh=new AggregateLifecycleTask),this.Xh.Zh(t)}te(t){null!==this.Xh&&(this.Xh===t?this.Xh=null:this.Xh.se(t))}T(s){return this.hh===this&&(this.Ah=this.Sh.then(()=>{this.ie(t.LifecycleFlags.ji)})),null===s.ut&&(s.ut=Lt,this.eh.ut=s,this.eh=s,++this.Rh),this.Ah}ie(s){for(s|=t.LifecycleFlags.Ti;this.Rh>0;){let i,n=this.hh.ut;this.hh=this.eh=this,this.Rh=0;do{i=n.ut,n.ut=null,n.flush(s),n=i}while(n!==Lt);if(s&t.LifecycleFlags.ot)break}}as(){++this.th}fs(t){null===t.Nh&&(t.Nh=Lt,this.fh.Nh=t,this.fh=t,++this.kh)}ne(t){null===t.xh&&(t.xh=Lt,this.oh.xh=t,this.oh=t,++this.Ih),null===t.Fh&&(t.Fh=Lt,this.uh.Fh=t,this.uh=t,++this.Ph)}he(t){if(this.Ih>0){this.Ih=0;let s,i=this.rh.xh;this.rh=this.oh=this;do{i.connect(t),s=i.xh,i.xh=null,i=s}while(i!==Lt)}}ee(s){for(s&t.LifecycleFlags.Si&&this.ie(s|t.LifecycleFlags.Ti);this.Ph>0;){this.Ph=0;let t,i=this.lh.Fh;this.lh=this.uh=this;do{i.bt(s),t=i.Fh,i.Fh=null,i=t}while(i!==Lt)}}bs(t){if(0==--this.th)return null===this.Xh||this.Xh.done?(this.re(t),LifecycleTask.done):(this.Xh.oe=this,this.Xh)}re(s){for(s&t.LifecycleFlags.Si&&this.ie(s|t.LifecycleFlags.Ti);this.kh>0;){this.kh=0;let t,i=this.ah.Nh;this.ah=this.fh=this;do{i.bound(s),t=i.Nh,i.Nh=null,i=t}while(i!==Lt)}}gs(){++this.nh}Cs(t){null===t.Gh&&(t.Gh=Lt,this.Th.Gh=t,this.Th=t,++this.Mh)}js(t){if(0==--this.nh)return null===this.Xh||this.Xh.done?(this.le(t),LifecycleTask.done):(this.Xh.oe=this,this.Xh)}le(t){for(;this.Mh>0;){this.Mh=0;let s,i=this.jh.Gh;this.jh=this.Th=this;do{i.Jh(t),s=i.Gh,i.Gh=null,i=s}while(i!==Lt)}}Bt(){++this.sh}qt(t){null===t.Uh&&(t.Uh=Lt,this.bh.Uh=t,this.bh=t,++this.$h)}Ft(t){null===t.zh&&(t.zh=Lt,this.vh.zh=t,this.vh=t,++this.Vh)}Nt(t){if(0==--this.sh)return null===this.Xh||this.Xh.done?(this.ce(t),LifecycleTask.done):(this.Xh.oe=this,this.Xh)}ce(s){if(this.ie(s|t.LifecycleFlags.Ti),this.$h>0){this.$h=0;let t,i=this.dh.Uh;this.dh=this.bh=this;do{i.Eh(s),t=i.Uh,i.Uh=null,i=t}while(i!==Lt)}if(this.he(t.LifecycleFlags.Y),this.Vh>0){this.Vh=0;let t,i=this.ph.zh;this.ph=this.vh=this;do{i.qh(s),t=i.zh,i.zh=null,i=t}while(i!==Lt)}}Qt(){++this.ih}Xt(t){if(null===t.Qh&&(t.Qh=Lt,this.mh.Qh=t,this.mh=t,++this.Dh),null!==t.Uh){let s=this.dh,i=s.Uh;for(;i!==t;)i=(s=i).Uh;s.Uh=i.Uh,i.Uh=null,this.bh===i&&(this.bh=this),--this.$h}}Wt(t){null===t.Kh&&(t.Kh=Lt,this.yh.Kh=t,this.yh=t,++this.Lh)}ue(t){null===t._h&&(t._h=Lt,this.Oh._h=t,this.Oh=t,++this.Bh)}_t(t){if(0==--this.ih)return null===this.Xh||this.Xh.done?(this.ae(t),LifecycleTask.done):(this.Xh.oe=this,this.Xh)}ae(s){if(this.ie(s|t.LifecycleFlags.ht|t.LifecycleFlags.ot),this.Dh>0){this.Dh=0;let t,i=this.wh.Qh;this.wh=this.mh=this;do{i.Hh(s),t=i.Qh,i.Qh=null,i=t}while(i!==Lt)}if(this.Lh>0){this.Lh=0;let t,i=this.gh.Kh;this.gh=this.yh=this;do{i.Wh(s),t=i.Kh,i.Kh=null,i=t}while(i!==Lt)}if(this.Bh>0){this.gs(),this.Bh=0;let t,i=this.Ch._h;this.Ch=this.Oh=this;do{i.us(s),t=i._h,i._h=null,i=t}while(i!==Lt);this.js(s)}}}class CompositionCoordinator{constructor($lifecycle){this.$lifecycle=$lifecycle,this.fe=kernel.PLATFORM.Sn,this.currentView=null,this.si=0,this.Zs=0,this.de=null,this.be=LifecycleTask.done}static register(t){return kernel.Registration.transient(this,this).register(t,this)}pe(value,t){this.be.done?value instanceof Promise?(this.ve(new Mt(this,value)),this.we()):this.me(value,t):(value instanceof Promise?this.ve(new Mt(this,value)):this.ve(value),this.be.ge()&&this.be.cancel())}ds(t,s){this.scope=s,this.Zs=1,null!==this.currentView&&this.currentView.ws(t,s)}xt(t){this.si=1,null!==this.currentView&&this.currentView.Et(t)}Kt(t){this.si=0,null!==this.currentView&&this.currentView.Zt(t)}Os(t){this.Zs=0,null!==this.currentView&&this.currentView.us(t)}ss(t){this.currentView=null}ve(t){null===this.de&&(this.de=[]),this.de.push(t)}me(t,s){if(this.currentView===t)return;const $lifecycle=this.$lifecycle,i=new AggregateLifecycleTask;let n,h=this.currentView;null===h?n=LifecycleTask.done:($lifecycle.ue(h),$lifecycle.Qt(),h.Zt(s),n=$lifecycle._t(s)),i.Zh(n),null===(h=this.currentView=t)?n=LifecycleTask.done:(this.Zs&&($lifecycle.as(),h.ws(s,this.scope),$lifecycle.bs(s)),this.si?($lifecycle.Bt(),h.Et(s),n=$lifecycle.Nt(s)):n=LifecycleTask.done),i.Zh(n),i.done?(this.be=LifecycleTask.done,this.fe()):(this.be=i,this.be.ye().then(()=>{this.fe(),this.we()}).catch(t=>{throw t}))}we(){if(null!==this.de&&this.de.length>0){const s=this.de.pop();this.de.length=0,Mt.is(s)?this.be=s.start():this.me(s,t.LifecycleFlags.ki)}else this.be=LifecycleTask.done}}CompositionCoordinator.inject=[ILifecycle];const LifecycleTask={done:{done:1,ge:()=>0,cancel(){},ye:()=>Promise.resolve()}};class AggregateLifecycleTask{constructor(){this.done=1,this.oe=null,this.resolve=null,this.Ce=[],this.Oe=null}Zh(t){t.done||(this.done=0,this.Ce.push(t),t.ye().then(()=>{this.je()}).catch(t=>{throw t}))}se(t){if(t.done){const s=this.Ce.indexOf(t);-1!==s&&this.Ce.splice(s,1)}0===this.Ce.length&&null!==this.oe&&(this.oe.te(this),this.oe=null)}ge(){return this.done?0:this.Ce.every(t=>t.ge())}cancel(){this.ge()&&(this.Ce.forEach(t=>{t.cancel()}),this.done=0)}ye(){return null===this.Oe&&(this.Oe=this.done?Promise.resolve():new Promise(t=>this.resolve=t)),this.Oe}je(){this.done||this.Ce.every(t=>t.done)&&this.complete(1)}complete(s){this.done=1,s&&null!==this.oe&&(this.oe.ae(t.LifecycleFlags.ki),this.oe.le(t.LifecycleFlags.ki),this.oe.re(t.LifecycleFlags.ki),this.oe.ce(t.LifecycleFlags.ki)),this.oe.te(this),null!==this.resolve&&this.resolve()}}class Mt{constructor(t,s){this.Te=t,this.done=0,this.Ae=0,this.Sh=s}static is(t){return"start"in t}start(){return this.Ae?LifecycleTask.done:(this.Sh=this.Sh.then(t=>(this.Se(t),t)),this)}ge(){return!this.done}cancel(){this.ge()&&(this.Ae=1)}ye(){return this.Sh}Se(value){this.Ae||(this.done=1,this.Te.pe(value,t.LifecycleFlags.ki))}}const xt=[],Ft=[];let Nt=-1;y(-1);const{oneTime,Ks:Ut,Gs:Et}=t.BindingMode,zt=Ut|oneTime;t.Binding=class{constructor(s,i,n,mode,h,e){this.ms=null,this.As=null,this.$state=0,this.$lifecycle=e.get(ILifecycle),this.xh=null,this.Fh=null,this.$scope=null,this.Re=e,this.mode=mode,this.st=h,this.Ie=s,this.target=i,this.Pe=n,this.ft=t.LifecycleFlags.Xs}ke(value,s){this.targetObserver.K(value,(s|=this.ft)|t.LifecycleFlags.W)}$e(value,s){this.Ie.assign((s|=this.ft)|t.LifecycleFlags.Oi,this.$scope,this.Re,value)}j(s,i,n){if(2&this.$state){if(n|=this.ft,this.mode===t.BindingMode.Gs&&(n&=~t.LifecycleFlags.W,n|=t.LifecycleFlags.Oi),n&t.LifecycleFlags.W){const t=this.targetObserver.H();return(10082!==this.Ie.J||this.Z>1)&&(s=this.Ie.evaluate(n,this.$scope,this.Re)),s!==t&&this.ke(s,n),void(0==(this.mode&oneTime)&&(this.version++,this.Ie.connect(n,this.$scope,this),this.unobserve(0)))}if(!(n&t.LifecycleFlags.Oi))throw kernel.Reporter.error(15,t.LifecycleFlags[n]);s!==this.Ie.evaluate(n,this.$scope,this.Re)&&this.$e(s,n)}}ws(s,i){if(2&this.$state){if(this.$scope===i)return;this.us(s|t.LifecycleFlags.et)}this.$state|=1,this.ft=s&t.LifecycleFlags.Ls,this.$scope=i;let n=this.Ie;hasBind(n)&&n.bind(s,i,this);let targetObserver=this.targetObserver;targetObserver||(targetObserver=this.targetObserver=this.mode&Et?this.st.tt(s,this.target,this.Pe):this.st.Ve(s,this.target,this.Pe)),targetObserver.bind&&targetObserver.bind(s),n=this.Ie,this.mode&zt&&this.ke(n.evaluate(s,i,this.Re),s),this.mode&Ut&&n.connect(s,i,this),this.mode&Et&&targetObserver.subscribe(this),this.$state|=2,this.$state&=-2}us(s){2&this.$state&&(this.$state|=64,this.ft=t.LifecycleFlags.Xs,hasUnbind(this.Ie)&&this.Ie.De(s,this.$scope,this),this.$scope=null,this.targetObserver.De&&this.targetObserver.De(s),this.targetObserver.unsubscribe&&this.targetObserver.unsubscribe(this),this.unobserve(1),this.$state&=-67)}connect(s){2&this.$state&&this.Ie.connect((s|=this.ft)|t.LifecycleFlags.Y,this.$scope,this)}bt(s){2&this.$state&&this.ke(this.Ie.evaluate((s|=this.ft)|t.LifecycleFlags.Y,this.$scope,this.Re),s)}},t.Binding=s([connectable()],t.Binding);class Call{constructor(s,i,n,h,e){this.ms=null,this.As=null,this.$state=0,this.Re=e,this.Ie=s,this.targetObserver=h.tt(t.LifecycleFlags.Xs,i,n)}Le(s){const i=this.$scope.en;Object.assign(i,s);const n=this.Ie.evaluate(t.LifecycleFlags.Y,this.$scope,this.Re);for(const t in s)Reflect.deleteProperty(i,t);return n}ws(s,i){if(2&this.$state){if(this.$scope===i)return;this.us(s|t.LifecycleFlags.et)}this.$state|=1,this.$scope=i,hasBind(this.Ie)&&this.Ie.bind(s,i,this),this.targetObserver.K(t=>this.Le(t),s),this.$state|=2,this.$state&=-2}us(t){2&this.$state&&(this.$state|=64,hasUnbind(this.Ie)&&this.Ie.De(t,this.$scope,this),this.$scope=null,this.targetObserver.K(null,t),this.$state&=-67)}nt(t,s,i){}j(t,s,i){}}const IExpressionParser=kernel.DI.fn("IExpressionParser").an(t=>t.singleton(qt));class qt{constructor(){this.Be=Object.create(null),this.Me=Object.create(null),this.xe=Object.create(null)}parse(t,s){switch(s){case 2048:{let i=this.xe[t];return void 0===i&&(i=this.xe[t]=this.Fe(t,s)),i}case 539:{let i=this.Me[t];return void 0===i&&(i=this.Me[t]=this.Fe(t,s)),i}default:{if(0===t.length&&55&s)return PrimitiveLiteral.En;let i=this.Be[t];return void 0===i&&(i=this.Be[t]=this.Fe(t,s)),i}}}cache(t){const{Me:s,Be:i,xe:n}=this;for(const h in t){const e=t[h];switch(e.J){case 24:n[h]=e;break;case 6199:s[h]=e;break;default:i[h]=e}}}Fe(t,s){try{const parts=t.split("."),s=parts[0];let i;i=s.endsWith("()")?new CallScope(s.replace("()",""),kernel.PLATFORM.qn):new AccessScope(parts[0]);let n=1;for(;parts.length>n;){const t=parts[n];i=t.endsWith("()")?new CallMember(i,t.replace("()",""),kernel.PLATFORM.qn):new AccessMember(i,parts[n]),n++}return i}catch(t){throw kernel.Reporter.error(3,t)}}}(BindingType=t.BindingType||(t.BindingType={}))[BindingType.Mi=0]="None",BindingType[BindingType.Interpolation=2048]="Interpolation",BindingType[BindingType.Ne=1280]="IsRef",BindingType[BindingType.Ue=512]="IsIterator",BindingType[BindingType.Ee=256]="IsCustom",BindingType[BindingType.ze=128]="IsFunction",BindingType[BindingType.qe=64]="IsEvent",BindingType[BindingType.Qe=32]="IsProperty",BindingType[BindingType.He=16]="IsCommand",BindingType[BindingType.Ke=48]="IsPropertyCommand",BindingType[BindingType.We=80]="IsEventCommand",BindingType[BindingType._e=6]="DelegationStrategyDelta",BindingType[BindingType.Ge=15]="Command",BindingType[BindingType.Je=49]="OneTimeCommand",BindingType[BindingType.Xe=50]="ToViewCommand",BindingType[BindingType.Ye=51]="FromViewCommand",BindingType[BindingType.Ze=52]="TwoWayCommand",BindingType[BindingType.tr=53]="BindCommand",BindingType[BindingType.sr=86]="TriggerCommand",BindingType[BindingType.ir=87]="CaptureCommand",BindingType[BindingType.nr=88]="DelegateCommand",BindingType[BindingType.hr=153]="CallCommand",BindingType[BindingType.er=26]="OptionsCommand",BindingType[BindingType.rr=539]="ForCommand",BindingType[BindingType.or=284]="CustomCommand";const{Ks:Qt,oneTime:Ht}=t.BindingMode;class MultiInterpolationBinding{constructor(s,i,n,h,mode,e){this.ms=null,this.As=null,this.$state=0,this.$scope=null,this.lr=i,this.Re=e,this.mode=mode,this.st=s,this.target=n,this.Pe=h;const r=i.X,parts=this.parts=Array(r.length);for(let o=0,l=r.length;l>o;++o)parts[o]=new t.InterpolationBinding(r[o],i,n,h,mode,s,e,0===o)}ws(t,s){if(2&this.$state){if(this.$scope===s)return;this.us(t)}this.$state|=2,this.$scope=s;const parts=this.parts;for(let i=0,n=parts.length;n>i;++i)parts[i].ws(t,s)}us(t){if(!(2&this.$state))return;this.$state&=-3,this.$scope=null;const parts=this.parts;for(let s=0,i=parts.length;i>s;++s)parts[s].us(t)}}t.InterpolationBinding=class{constructor(s,i,n,h,mode,e,r,o){this.$state=0,this.lr=i,this.cr=o,this.mode=mode,this.Re=r,this.st=e,this.Ie=s,this.target=n,this.Pe=h,this.targetObserver=e.Ve(t.LifecycleFlags.Xs,n,h)}ke(value,s){this.targetObserver.K(value,s|t.LifecycleFlags.W)}j(t,s,i){if(!(2&this.$state))return;const n=this.targetObserver.H(),h=this.lr.evaluate(i,this.$scope,this.Re);h!==n&&this.ke(h,i),0==(this.mode&Ht)&&(this.version++,this.Ie.connect(i,this.$scope,this),this.unobserve(0))}ws(t,s){if(2&this.$state){if(this.$scope===s)return;this.us(t)}this.$state|=2,this.$scope=s;const i=this.Ie;i.bind&&i.bind(t,s,this),this.cr&&this.ke(this.lr.evaluate(t,s,this.Re),t),this.mode&Qt&&i.connect(t,s,this)}us(t){if(!(2&this.$state))return;this.$state&=-3;const s=this.Ie;s.De&&s.De(t,this.$scope,this),this.$scope=null,this.unobserve(1)}},t.InterpolationBinding=s([connectable()],t.InterpolationBinding),t.LetBinding=class{constructor(t,s,i,n,toViewModel=0){this.ms=null,this.As=null,this.$state=0,this.$lifecycle=n.get(ILifecycle),this.$scope=null,this.Re=n,this.st=i,this.Ie=t,this.target=null,this.Pe=s,this.toViewModel=toViewModel}j(s,i,n){if(2&this.$state){if(!(n&t.LifecycleFlags.W))throw kernel.Reporter.error(15,n);{const{target:t,Pe:s}=this,i=t[s],h=this.Ie.evaluate(n,this.$scope,this.Re);h!==i&&(t[s]=h)}}}ws(s,i){if(2&this.$state){if(this.$scope===i)return;this.us(s|t.LifecycleFlags.et)}this.$state|=1,this.$scope=i,this.target=this.toViewModel?i.on:i.en;const n=this.Ie;n.bind&&n.bind(s,i,this),this.target[this.Pe]=this.Ie.evaluate(t.LifecycleFlags.et,i,this.Re),this.Ie.connect(s,i,this),this.$state|=2,this.$state&=-2}us(t){if(!(2&this.$state))return;this.$state|=64;const s=this.Ie;s.De&&s.De(t,this.$scope,this),this.$scope=null,this.unobserve(1),this.$state&=-67}},t.LetBinding=s([connectable()],t.LetBinding);class Ref{constructor(t,s,i){this.ms=null,this.As=null,this.$state=0,this.Re=i,this.Ie=t,this.target=s}ws(s,i){if(2&this.$state){if(this.$scope===i)return;this.us(s|t.LifecycleFlags.et)}this.$state|=1,this.$scope=i,hasBind(this.Ie)&&this.Ie.bind(s,i,this),this.Ie.assign(s,this.$scope,this.Re,this.target),this.$state|=2,this.$state&=-2}us(t){if(!(2&this.$state))return;this.$state|=64,this.Ie.evaluate(t,this.$scope,this.Re)===this.target&&this.Ie.assign(t,this.$scope,this.Re,null);const s=this.Ie;hasUnbind(s)&&s.De(t,this.$scope,this),this.$scope=null,this.$state&=-67}nt(t,s,i){}j(t,s,i){}}t.CollectionLengthObserver=class{constructor(t,s){this.N=t,this.U=s,this.q=t[s]}H(){return this.N[this.U]}ct(t){this.N[this.U]=t}bt(t){this.g(this.N[this.U],this.q,t),this.q=this.N[this.U]}subscribe(t){this.l(t)}unsubscribe(t){this.u(t)}},t.CollectionLengthObserver=s([targetObserver()],t.CollectionLengthObserver);const Kt=Array.prototype,Wt=Kt.push,_t=Kt.unshift,Gt=Kt.pop,Jt=Kt.shift,Xt=Kt.splice,Yt=Kt.reverse,Zt=Kt.sort,ts={push:Wt,unshift:_t,pop:Gt,shift:Jt,splice:Xt,reverse:Yt,sort:Zt},ss=["push","unshift","pop","shift","splice","reverse","sort"],is={push(){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return Wt.apply(s,arguments);const n=s.length,h=arguments.length;if(0===h)return n;s.length=i.at.length=n+h;let e=n;for(;s.length>e;)s[e]=arguments[e-n],i.at[e]=-2,e++;return i.g("push",arguments,i.ft|t.LifecycleFlags.gi),s.length},unshift(){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return _t.apply(s,arguments);const n=arguments.length,h=Array(n);let e=0;for(;n>e;)h[e++]=-2;_t.apply(i.at,h);const r=_t.apply(s,arguments);return i.g("unshift",arguments,i.ft|t.LifecycleFlags.gi),r},pop(){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return Gt.call(s);const n=i.at,h=Gt.call(s),e=n.length-1;return n[e]>-1&&n.wt.push(n[e]),Gt.call(n),i.g("pop",arguments,i.ft|t.LifecycleFlags.gi),h},shift(){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return Jt.call(s);const n=i.at,h=Jt.call(s);return n[0]>-1&&n.wt.push(n[0]),Jt.call(n),i.g("shift",arguments,i.ft|t.LifecycleFlags.gi),h},splice(s,i){let n=this;void 0!==n.Gi&&(n=n.Gi);const h=n.vt;if(void 0===h)return Xt.apply(n,arguments);const e=h.at;if(i>0){let t=isNaN(s)?0:s;const to=t+i;for(;to>t;)e[t]>-1&&e.wt.push(e[t]),t++}const r=arguments.length;if(r>2){const t=r-2,n=Array(t);let h=0;for(;t>h;)n[h++]=-2;Xt.call(e,s,i,...n)}else 2===r&&Xt.call(e,s,i);const o=Xt.apply(n,arguments);return h.g("splice",arguments,h.ft|t.LifecycleFlags.gi),o},reverse(){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return Yt.call(s),this;const n=s.length,h=n/2|0;let e=0;for(;e!==h;){const t=n-e-1,h=s[e],r=i.at[e],o=i.at[t];s[e]=s[t],i.at[e]=o,s[t]=h,i.at[t]=r,e++}return i.g("reverse",arguments,i.ft|t.LifecycleFlags.gi),this},sort(s){let i=this;void 0!==i.Gi&&(i=i.Gi);const n=i.vt;if(void 0===n)return Zt.call(i,s),this;const h=i.length;if(2>h)return this;M(i,n.at,0,h,L);let e=0;for(;h>e&&void 0!==i[e];)e++;return void 0!==s&&"function"==typeof s||(s=D),M(i,n.at,0,e,s),n.g("sort",arguments,n.ft|t.LifecycleFlags.gi),this}},ns={ur:1,Vs:0,Zi:1},def=Reflect.defineProperty;for(const t of ss)def(is[t],"observing",{value:1,ur:0,Zi:0,Vs:0});enableArrayObservation(),t.ArrayObserver=class{constructor(s,i,n){this.A=i,n.vt=this,this.C=n,this.flags=s&t.LifecycleFlags.Ls,this.pt()}},t.ArrayObserver=s([collectionObserver(9)],t.ArrayObserver);const hs=Map.prototype,es=hs.set,rs=hs.clear,os=hs.delete,ls={set:es,clear:rs,delete:os},cs=["set","clear","delete"],us={set(s,value){let i=this;void 0!==i.Gi&&(i=i.Gi);const n=i.vt;if(void 0===n)return es.call(i,s,value),this;const h=i.size;if(es.call(i,s,value),i.size===h){let t=0;for(const h of i.entries()){if(h[0]===s)return h[1]!==value&&(n.at[t]=-2),this;t++}return this}return n.at[h]=-2,n.g("set",arguments,n.ft|t.LifecycleFlags.gi),this},clear(){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return rs.call(s);if(s.size>0){const n=i.at;let h=0;for(const t of s.keys())n[h]>-1&&n.wt.push(n[h]),h++;rs.call(s),n.length=0,i.g("clear",arguments,i.ft|t.LifecycleFlags.gi)}},delete(value){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return os.call(s,value);if(0===s.size)return 0;let n=0;const h=i.at;for(const t of s.keys()){if(t===value)return h[n]>-1&&h.wt.push(h[n]),h.splice(n,1),os.call(s,value);n++}return i.g("delete",arguments,i.ft|t.LifecycleFlags.gi),0}},as={ur:1,Vs:0,Zi:1},fs=Reflect.defineProperty;for(const t of cs)fs(us[t],"observing",{value:1,ur:0,Zi:0,Vs:0});enableMapObservation(),t.MapObserver=class{constructor(s,i,n){this.A=i,n.vt=this,this.C=n,this.flags=s&t.LifecycleFlags.Ls,this.pt()}},t.MapObserver=s([collectionObserver(6)],t.MapObserver);const ds=Set.prototype,bs=ds.add,ps=ds.clear,vs=ds.delete,ws={add:bs,clear:ps,delete:vs},ms=["add","clear","delete"],gs={add(value){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return bs.call(s,value),this;const n=s.size;return bs.call(s,value),s.size===n?this:(i.at[n]=-2,i.g("add",arguments,i.ft|t.LifecycleFlags.gi),this)},clear(){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return ps.call(s);if(s.size>0){const n=i.at;let h=0;for(const t of s.keys())n[h]>-1&&n.wt.push(n[h]),h++;ps.call(s),n.length=0,i.g("clear",arguments,i.ft|t.LifecycleFlags.gi)}},delete(value){let s=this;void 0!==s.Gi&&(s=s.Gi);const i=s.vt;if(void 0===i)return vs.call(s,value);if(0===s.size)return 0;let n=0;const h=i.at;for(const t of s.keys()){if(t===value)return h[n]>-1&&h.wt.push(h[n]),h.splice(n,1),vs.call(s,value);n++}return i.g("delete",arguments,i.ft|t.LifecycleFlags.gi),0}},ys={ur:1,Vs:0,Zi:1},Cs=Reflect.defineProperty;for(const t of ms)Cs(gs[t],"observing",{value:1,ur:0,Zi:0,Vs:0});enableSetObservation(),t.SetObserver=class{constructor(s,i,n){this.A=i,n.vt=this,this.C=n,this.flags=s&t.LifecycleFlags.Ls,this.pt()}},t.SetObserver=s([collectionObserver(7)],t.SetObserver);const Os={ar:0,dr:0};t.CustomSetterObserver=class{constructor(t,s,i){this.N=t,this.U=s,this.q=this.oldValue=void 0,this.br=i,this.F=0}K(s){this.br.set.call(this.N,s),this.q!==s&&(this.oldValue=this.q,this.q=s,this.g(s,this.oldValue,t.LifecycleFlags.W))}subscribe(t){this.F||this.pr(),this.l(t)}unsubscribe(t){this.u(t)}pr(){this.F=1,this.q=this.N[this.U],Reflect.defineProperty(this.N,this.U,{set:t=>{this.K(t)}})}},t.CustomSetterObserver=s([subscriberCollection(t.MutationKind.m)],t.CustomSetterObserver),t.GetterObserver=class{constructor(t,s,i,n,h,e,r){this.N=i,this.U=n,this.vr=0,this.q=this.oldValue=void 0,this.wr=[],this.mr=[],this.gr=s,this.yr=0,this.br=h,this.O=new Proxy(i,(function t(s,i,n){return{get(h,e,r){if(n.Cr(e))return Reflect.get(h,e,r);switch(js.call(h)){case"[object Array]":if(n.Or(i.jr(s,h)),"length"===e)return Reflect.get(h,e,h);case"[object Map]":if(n.Or(i.Tr(s,h)),"size"===e)return Reflect.get(h,e,h);case"[object Set]":if(n.Or(i.Ar(s,h)),"size"===e)return Reflect.get(h,e,h);default:n.Sr(i.tt(s,h,e))}return(function(s,i,n,h,e){const value=Reflect.get(i,n,i);return"function"==typeof value?i[n].bind(i):"object"!=typeof value||null===value?value:new Proxy(value,t(s,h,e))})(s,h,e,i,n)}}})(t,e,this)),Reflect.defineProperty(i,n,{get:()=>this.H()})}Sr(t){-1===this.wr.indexOf(t)&&this.wr.push(t)}Or(t){-1===this.mr.indexOf(t)&&this.mr.push(t)}H(){return this.q=0===this.yr||this.vr?Reflect.apply(this.br.get,this.O,kernel.PLATFORM.qn):Reflect.apply(this.br.get,this.N,kernel.PLATFORM.qn),this.q}subscribe(t){this.l(t),1==++this.yr&&this.Rr(1)}unsubscribe(t){this.u(t),0==--this.yr&&this.Ir()}j(){const s=this.q,i=this.Rr(0);s!==i&&this.g(i,s,t.LifecycleFlags.W)}M(){const s=this.q,i=this.Rr(0);s!==i&&this.g(i,s,t.LifecycleFlags.ht|t.LifecycleFlags.W)}Rr(t){const s=!this.gr.ar||t;return s&&(this.Ir(),this.vr=1),this.q=this.H(),s&&(this.wr.forEach(t=>{t.subscribe(this)}),this.mr.forEach(t=>{t.jt(this)}),this.vr=0),this.q}Cr(t){return!this.vr||"$observers"===t}Ir(){this.wr.forEach(t=>{t.unsubscribe(this)}),this.wr.length=0,this.mr.forEach(t=>{t.Tt(this)}),this.mr.length=0}},t.GetterObserver=s([subscriberCollection(t.MutationKind.m)],t.GetterObserver);const js={}.toString,IDirtyChecker=kernel.DI.fn("IDirtyChecker").an(t=>t.singleton(Ts)),DirtyCheckSettings={Pr:6,disabled:0,warn:1,kr:0,$r(){this.Pr=6,this.disabled=0,this.warn=1,this.kr=0}};class Ts{constructor(){this.Vr=0,this.Dr=[]}Lr(s,i){if(DirtyCheckSettings.kr)throw kernel.Reporter.error(800);return DirtyCheckSettings.warn&&kernel.Reporter.write(801),new t.DirtyCheckProperty(this,s,i)}Br(t){this.Dr.push(t),1===this.Dr.length&&kernel.PLATFORM.Mr.add(this.xr,this)}removeProperty(t){this.Dr.splice(this.Dr.indexOf(t),1),0===this.Dr.length&&kernel.PLATFORM.Mr.remove(this.xr,this)}xr(s){if(DirtyCheckSettings.disabled)return;if(++this.Vr<DirtyCheckSettings.Pr)return;this.Vr=0;const i=this.Dr,n=i.length;let h,e=0;for(;n>e;++e)(h=i[e]).Fr()&&h.flush(t.LifecycleFlags.Ai)}}t.DirtyCheckProperty=class{constructor(t,s,i){this.N=s,this.U=i,this.Nr=t}Fr(){return this.oldValue!==this.N[this.U]}flush(s){const i=this.N[this.U];this.g(i,this.oldValue,s|t.LifecycleFlags.W),this.oldValue=i}subscribe(t){this.v()||(this.oldValue=this.N[this.U],this.Nr.Br(this)),this.l(t)}unsubscribe(t){this.u(t)&&!this.v()&&this.Nr.removeProperty(this)}},t.DirtyCheckProperty=s([propertyObserver()],t.DirtyCheckProperty);const As=kernel.PLATFORM.Sn;class PrimitiveObserver{constructor(t,s){this.Ur=1,"length"===s?(this.N=t,this.H=this.Er):this.H=this.zr}Er(){return this.N.length}zr(){}}PrimitiveObserver.prototype.K=As,PrimitiveObserver.prototype.subscribe=As,PrimitiveObserver.prototype.unsubscribe=As,PrimitiveObserver.prototype._=As;class PropertyAccessor{constructor(t,s){this.N=t,this.U=s}H(){return this.N[this.U]}K(value){this.N[this.U]=value}}const Ss={}.toString,IObserverLocator=kernel.DI.fn("IObserverLocator").Zn(),ITargetObserverLocator=kernel.DI.fn("ITargetObserverLocator").Zn(),ITargetAccessorLocator=kernel.DI.fn("ITargetAccessorLocator").Zn();class Rs{constructor(t,s,i,n){this.qr=[],this.Nr=s,this.A=t,this.Qr=i,this.Hr=n}static register(t){return kernel.Registration.singleton(IObserverLocator,this).register(t)}tt(s,i,n){if(s&t.LifecycleFlags.Dt&&"object"==typeof i)return t.ProxyObserver.xs(i,n);if((function(t){return 1==t.hn})(i))return i.ln(s).xs(s,i,n);let h,e=i.Ds;return e&&n in e?e[n]:((h=this.Kr(s,i,n)).Ur||(void 0===e&&(e=this.Wr(i)),e[n]=h),h)}_r(t){this.qr.push(t)}Ve(s,i,n){return this.Hr.Gr(s,i)?this.Qr.Jr(s,i,n)?this.tt(s,i,n):this.Hr.Ve(s,this.A,i,n):s&t.LifecycleFlags.Dt?t.ProxyObserver.xs(i,n):new PropertyAccessor(i,n)}jr(t,s){return x(t,this.A,s)}Tr(t,s){return F(t,this.A,s)}Ar(t,s){return N(t,this.A,s)}Wr(t){return t.Ds||this.Xr(t)}Xr(t){const value={};return Reflect.defineProperty(t,"$observers",{Vs:0,Zi:0,ur:0,value})||kernel.Reporter.write(0,t),value}Yr(t,s,i,n){for(let h=0,e=this.qr.length;e>h;h++){const e=this.qr[h].tt(t,s,i,n);if(e)return e}return null}Kr(s,i,n){if(!(i instanceof Object))return new PrimitiveObserver(i,n);let h=0;if(this.Qr.Gr(s,i)){const t=this.Qr.tt(s,this.A,this,i,n);if(null!==t)return t;if(null!==t)return t;h=1}switch(Ss.call(i)){case"[object Array]":return"length"===n?this.jr(s,i).Ot(s):this.Nr.Lr(i,n);case"[object Map]":return"size"===n?this.Tr(s,i).Ot(s):this.Nr.Lr(i,n);case"[object Set]":return"size"===n?this.Ar(s,i).Ot(s):this.Nr.Lr(i,n)}const e=(function(t,name){let s=Object.getOwnPropertyDescriptor(t,name),i=Object.getPrototypeOf(t);for(;void 0===s&&null!==i;)s=Object.getOwnPropertyDescriptor(i,name),i=Object.getPrototypeOf(i);return s})(i,n);if(e&&(e.get||e.set)){if(e.get&&e.get.tt)return e.get.tt(i);return this.Yr(s,i,n,e)||(h?this.Nr.Lr(i,n):(function(s,i,n,h,e,r,o){if(0==o.Zi)return n.Lr(e,r);if(o.get){const n=e.constructor.computed&&e.constructor.computed[r]||Os;return o.set?n.dr?new t.GetterObserver(s,n,e,r,o,i,h):new t.CustomSetterObserver(e,r,o):new t.GetterObserver(s,n,e,r,o,i,h)}throw kernel.Reporter.error(18,r)})(s,this,this.Nr,this.A,i,n,e))}return new t.SetterObserver(s,i,n)}}Rs.inject=[ILifecycle,IDirtyChecker,ITargetObserverLocator,ITargetAccessorLocator];const Is=kernel.PLATFORM.Sn;t.SelfObserver=class{constructor(s,i,n,h){this.ft=s&t.LifecycleFlags.Ls,t.ProxyObserver.Xi(i)?(i.vt.subscribe(this,n),this.N=i.Gi,this.U=n,this.q=i.Gi[n],this.Hs=h in i.Gi?i[h].bind(i):Is):(this.N=i,this.U=n,this.q=i[n],this.Hs=h in i?i[h].bind(i):Is)}j(t,s,i){this.K(t,i)}H(){return this.q}K(s,i){const n=this.q;if(n!==s&&(this.q=s,!(i&t.LifecycleFlags.et))){const t=this.Hs(s,n,i);void 0!==t&&(this.q=s=t),this.g(s,n,i)}}},t.SelfObserver=s([propertyObserver()],t.SelfObserver);const{oneTime:Ps,Ks:ks,Gs:$s,Js:Vs}=t.BindingMode;class BindingModeBehavior{constructor(mode){this.mode=mode}bind(t,s,i){i.Zr=i.mode,i.mode=this.mode}De(t,s,i){i.mode=i.Zr,i.Zr=null}}class OneTimeBindingBehavior extends BindingModeBehavior{constructor(){super(Ps)}}BindingBehaviorResource.mn("oneTime",OneTimeBindingBehavior);class ToViewBindingBehavior extends BindingModeBehavior{constructor(){super(ks)}}BindingBehaviorResource.mn("toView",ToViewBindingBehavior);class FromViewBindingBehavior extends BindingModeBehavior{constructor(){super($s)}}BindingBehaviorResource.mn("fromView",FromViewBindingBehavior);class TwoWayBindingBehavior extends BindingModeBehavior{constructor(){super(Vs)}}BindingBehaviorResource.mn("twoWay",TwoWayBindingBehavior);const Ds={},Ls=t.BindingMode.Gs;class DebounceBindingBehavior{bind(s,i,n,h=200){let e,r,o;n instanceof t.Binding?(e="handleChange",o=E,r=n.mode&Ls?t.LifecycleFlags.Oi:t.LifecycleFlags.W):(e="callSource",o=U,r=t.LifecycleFlags.W),n.Rt=n[e],n.Rt.so=e,n[e]=o,n.At={Pt:r,It:h,St:0,oldValue:Ds}}De(t,s,i){i[i.Rt.so]=i.Rt,i.Rt=null,kernel.PLATFORM.global.clearTimeout(i.At.St),i.At=null}}BindingBehaviorResource.mn("debounce",DebounceBindingBehavior);class SignalBindingBehavior{constructor(t){this.io=t}bind(t,s,i,...n){if(!i.ke)throw kernel.Reporter.error(11);if(4===arguments.length){const name=n[0];this.io.pn(name,i),i.no=name}else{if(4>=arguments.length)throw kernel.Reporter.error(12);{const t=[].slice.call(arguments,3);let s=t.length;for(;s--;)this.io.pn(t[s],i);i.no=t}}}De(t,s,i){const name=i.no;if(i.no=null,Array.isArray(name)){const t=name;let s=t.length;for(;s--;)this.io.vn(t[s],i)}else this.io.vn(name,i)}}SignalBindingBehavior.inject=[ISignaler],BindingBehaviorResource.mn("signal",SignalBindingBehavior);class ThrottleBindingBehavior{bind(s,i,n,h=200){let e;n.Vt=n[e=n instanceof t.Binding?n.mode===t.BindingMode.Js?"updateSource":"updateTarget":"callSource"],n.Vt.so=e,n[e]=z,n.kt={It:h,$t:0,St:-1}}De(t,s,i){i[i.Vt.so]=i.Vt,i.Vt=null,kernel.PLATFORM.global.clearTimeout(i.kt.St),i.kt=null}}BindingBehaviorResource.mn("throttle",ThrottleBindingBehavior);const Bs="custom-element",Ms="custom-attribute";(TargetedInstructionType=t.TargetedInstructionType||(t.TargetedInstructionType={})).ho="ra",TargetedInstructionType.eo="rb",TargetedInstructionType.ro="rc",TargetedInstructionType.oo="rd",TargetedInstructionType.setProperty="re",TargetedInstructionType.lr="rf",TargetedInstructionType.lo="rg",TargetedInstructionType.co="rh",TargetedInstructionType.uo="ri",TargetedInstructionType.ao="rj",TargetedInstructionType.fo="rk";const ITargetedInstruction=kernel.DI.fn("createInterface").Zn(),xs=Object.freeze({required:1,compiler:"default"}),Fs=Object.freeze({required:0,compiler:"default"});class Ns{constructor(){this.name="unnamed",this.template=null,this.cache=0,this.build=Fs,this.bindables=kernel.PLATFORM.Lt,this.instructions=kernel.PLATFORM.qn,this.dependencies=kernel.PLATFORM.qn,this.surrogates=kernel.PLATFORM.qn,this.containerless=0,this.shadowOptions=null,this.hasSlots=0,this.Dt=0}}const Us=["name","template","cache","build","containerless","shadowOptions","hasSlots","useProxies"],Es=["instructions","dependencies","surrogates"],INode=(kernel.Profiler.do("AttachLifecycle"),kernel.Profiler.do("BindLifecycle"),kernel.DI.fn("INode").Zn()),IRenderLocation=kernel.DI.fn("IRenderLocation").Zn(),IDOM=kernel.DI.fn("IDOM").Zn(),zs=function(){throw kernel.Reporter.error(1e3)},qs={addEventListener:zs,appendChild:zs,cloneNode:zs,bo:zs,createDocumentFragment:zs,createElement:zs,po:zs,dispatchEvent:zs,vo:zs,wo:zs,createTextNode:zs,insertBefore:zs,mo:zs,yo:zs,Co:zs,Oo:zs,Rs:zs,remove:zs,removeEventListener:zs,setAttribute:zs},DOM=Object.assign({},qs,{get jo(){return 1==Reflect.get(this,"$initialized")},initialize(dom){if(this.jo)throw kernel.Reporter.error(1001);const t={},s=[dom];let i=Object.getPrototypeOf(dom);for(;i&&i!==Object.prototype;)s.unshift(i),i=Object.getPrototypeOf(i);for(i of s)Object.assign(t,Object.getOwnPropertyDescriptors(i));const n=[];let h,e;for(h in t)(e=t[h]).Zi&&e.ur&&(Reflect.defineProperty(this,h,e),n.push(h));Reflect.set(this,"$domKeys",n),Reflect.set(this,"$initialized",1)},To(){if(!this.jo)throw kernel.Reporter.error(1002);Reflect.get(this,"$domKeys").forEach(t=>{Reflect.deleteProperty(this,t)}),Object.assign(this,qs),Reflect.set(this,"$domKeys",kernel.PLATFORM.qn),Reflect.set(this,"$initialized",0)}}),NodeSequence={empty:{childNodes:kernel.PLATFORM.qn,firstChild:null,lastChild:null,Ao:()=>kernel.PLATFORM.qn,insertBefore(t){},So(t){},remove(){}}};class Qs{constructor($lifecycle,cache){this.vs=null,this.Ts=null,this.Ut=null,this.Yt=null,this.Ut=null,this.Yt=null,this.zt=null,this.ts=null,this.Uh=null,this.Qh=null,this._h=null,this.$state=0,this.$scope=null,this.ls=0,this.$lifecycle=$lifecycle,this.cache=cache}Ro(t){this.ls=0,this.location=t}release(t){return this.ls=1,8&this.$state?this.cache.Io(this):!!this.Hh(t)}Po(t){this.$scope=t,this.ws=lt,this.us=ft}}class Hs{constructor(name,template,t){this.ko=0,this.$o=-1,this.cache=null,this.A=t,this.name=name,this.template=template}Vo(t,s){t&&("*"===t?t=Hs.Do:"string"==typeof t&&(t=parseInt(t,10)),-1!==this.$o&&s||(this.$o=t)),this.cache=this.$o>0?[]:null,this.ko=this.$o>0}Io(t){return null!==this.cache&&this.$o>this.cache.length}cs(s){return this.Io(s)?(s.hs(t.LifecycleFlags.Xs),this.cache.push(s),1):0}create(t){const cache=this.cache;let s;if(null!==cache&&cache.length>0)return(s=cache.pop()).$state&=-129,s;if(s=new Qs(this.A,this),this.template.Ps(s,null,null,t),!s.$nodes)throw kernel.Reporter.error(90);return s}}Hs.Do=65535,(t=>{t.ws=ot,t.us=at,t.Et=_,t.Zt=X,t.hs=tt,t.Eh=nt,t.Hh=ht})(Qs.prototype);const ITemplateCompiler=kernel.DI.fn("ITemplateCompiler").Zn();(ViewCompileFlags=t.ViewCompileFlags||(t.ViewCompileFlags={}))[ViewCompileFlags.Xs=1]="none",ViewCompileFlags[ViewCompileFlags.Lo=2]="surrogate",ViewCompileFlags[ViewCompileFlags.Bo=4]="shadowDOM";const ITemplateFactory=kernel.DI.fn("ITemplateFactory").Zn(),Ks={Mo:null,dom:null,Ps(t){t.$nodes=NodeSequence.empty,t.$context=null}},Ws="default",IInstructionRenderer=kernel.DI.fn("IInstructionRenderer").Zn(),IRenderer=kernel.DI.fn("IRenderer").Zn(),IRenderingEngine=kernel.DI.fn("IRenderingEngine").an(t=>t.singleton(_s));class _s{constructor(t,s,i,n){this.xo=new Map,this.Fo=t,this.No=s,this.Uo=new Map,this.A=i,this.Eo=new Map,this.zo=n.reduce((t,s)=>(t[s.name]=s,t),Object.create(null))}Us(dom,t,s,i){if(!t)return null;let n=this.Eo.get(t);return n||(n=this.qo(dom,t,s,i),this.Eo.set(t,n)),n}Qo(dom,t,s){if(!t)return null;let i=this.Uo.get(t);if(!i){const n=buildTemplateDefinition(null,t),template=this.qo(dom,n,s,null);(i=new Hs(n.name,template,this.A)).Vo(n.cache,1),this.Uo.set(t,i)}return i}Bs(t,s,i){let n=this.xo.get(s);n||(n=Ys.create(s),this.xo.set(s,n)),n.Ho(t,i,this.A)}qo(dom,s,i,n){if(null===i&&(i=this.Fo),null!==s.template){const h=createRenderContext(dom,i,s.dependencies,n);if(s.build.required){const i=s.build.compiler||Ws,compiler=this.zo[i];if(void 0===compiler)throw kernel.Reporter.error(20,i);s=compiler.compile(dom,s,new kernel.RuntimeCompilationResources(h),t.ViewCompileFlags.Lo)}return this.No.create(h,s)}return Ks}}_s.inject=[kernel.IContainer,ITemplateFactory,ILifecycle,kernel.all(ITemplateCompiler)];class Gs{constructor(){this.m=null}$s(t){this.m=t}resolve(t,s){if(void 0===this.m)throw kernel.Reporter.error(50);return this.m}_(){this.m=null}}class Js{$s(t,parts){this.Ko=t,this.Wo=parts||kernel.PLATFORM.Lt}resolve(t,s){const i=this.Ko;if(null==i)throw kernel.Reporter.error(50);if(!i.name||!i.name.length)throw kernel.Reporter.error(51);const n=this.Wo[i.name];if(n){const i=t.get(IRenderingEngine),dom=t.get(IDOM);return i.Qo(dom,n,s)}return i}_(){this.Ko=null,this.Wo=kernel.PLATFORM.Lt}}let Xs=class{constructor(t,customElement){this.yt=0,this.children=null,this.customElement=customElement,this.A=t,this.F=0}H(){return this.F||(this.F=1,this.customElement.rs._o(()=>{this.Go()}),this.children=dt(this.customElement.rs.children)),this.children}K(t){}flush(s){this.g(this.children,void 0,s|t.LifecycleFlags.W),this.yt=0}subscribe(t){this.l(t)}unsubscribe(t){this.u(t)}Go(){this.children=dt(this.customElement.rs.children),"$childrenChanged"in this.customElement&&this.customElement.Jo(),this.A.T(this).catch(t=>{throw t}),this.yt=1}};Xs=s([subscriberCollection(t.MutationKind.m)],Xs);class Ys{constructor(){}static create(t){const s=new Ys;return s.bindables=t.description.bindables,s}Ho(t,s,i){s.$lifecycle=i,"$projector"in s?this.Xo(t,i,s):this.Yo(t,s)}Xo(t,s,i){this.Yo(t,i).Zo=new Xs(s,i),Reflect.defineProperty(i,"$children",{Vs:0,get(){return this.Ds.Zo.H()}})}Yo(s,i){const n={},bindables=this.bindables,h=Object.getOwnPropertyNames(bindables);if(s&t.LifecycleFlags.Dt)for(let e=0,r=h.length;r>e;++e){const name=h[e];n[name]=new t.SelfObserver(s,t.ProxyObserver.xs(i).O,name,bindables[name].Hs)}else{for(let e=0,r=h.length;r>e;++e){const name=h[e];n[name]=new t.SelfObserver(s,i,name,bindables[name].Hs),bt(s,i,name)}Reflect.defineProperty(i,"$observers",{Vs:0,value:n})}return n}}const IProjectorLocator=kernel.DI.fn("IProjectorLocator").Zn(),CustomElementResource={name:Bs,G:q,wn(t){return t.kind===this},tl:Q,mn(t,s=null){if(!t)throw kernel.Reporter.error(70);const i=null===s?class{}:s,n=buildTemplateDefinition(i,t),h=i.prototype;return i.kind=CustomElementResource,i.description=n,i.register=pt,h.sl=mt,h.ws=rt,h.Et=W,h.Zt=J,h.us=ut,h.hs=Z,h.ts=null,h.zt=null,h._h=null,h.$scope=null,h.$hooks=0,h.vs=null,h.Ts=null,h.Ut=null,h.Yt=null,h.Eh=st,h.Hh=it,h.Uh=null,h.Qh=null,h.rs=null,"flush"in h&&(h.ut=null),"binding"in h&&(h.$hooks|=4),"bound"in h&&(h.$hooks|=8,h.Nh=null),"unbinding"in h&&(h.$hooks|=256),"unbound"in h&&(h.$hooks|=512,h.Gh=null),"render"in h&&(h.$hooks|=1024),"created"in h&&(h.$hooks|=2),"attaching"in h&&(h.$hooks|=16),"attached"in h&&(h.$hooks|=32,h.zh=null),"detaching"in h&&(h.$hooks|=64),"caching"in h&&(h.$hooks|=2048),"detached"in h&&(h.$hooks|=128,h.Kh=null),i}},Zs={mode:"open"},CustomAttributeResource=(kernel.Profiler.do("RenderLifecycle"),{name:Ms,G:H,wn(t){return t.kind===this},mn(s,i){const n=i,h=(function(def,s){const aliases=def.aliases,defaultBindingMode=def.defaultBindingMode;return{name:def.name,aliases:null==aliases?kernel.PLATFORM.qn:aliases,defaultBindingMode:null==defaultBindingMode?t.BindingMode.Ks:defaultBindingMode,zs:void 0===def.zs?0:def.zs,isTemplateController:void 0===def.isTemplateController?0:def.isTemplateController,bindables:Object.assign({},s.bindables,def.bindables),Dt:void 0===def.Dt?0:def.Dt}})("string"==typeof s?{name:s}:s,n),e=n.prototype;return n.kind=CustomAttributeResource,n.description=h,n.register=gt,e.sl=wt,e.ws=et,e.Et=K,e.Zt=G,e.us=ct,e.hs=Y,e.ts=null,e.zt=null,e._h=null,e.$scope=null,e.$hooks=0,e.$state=0,"flush"in e&&(e.ut=null),"binding"in e&&(e.$hooks|=4),"bound"in e&&(e.$hooks|=8,e.Nh=null),"unbinding"in e&&(e.$hooks|=256),"unbound"in e&&(e.$hooks|=512,e.Gh=null),"created"in e&&(e.$hooks|=2),"attaching"in e&&(e.$hooks|=16),"attached"in e&&(e.$hooks|=32,e.zh=null),"detaching"in e&&(e.$hooks|=64),"caching"in e&&(e.$hooks|=2048),"detached"in e&&(e.$hooks|=128,e.Kh=null),n}});class If{constructor(t,s,i){this.value=0,this.Te=i,this.il=null,this.nl=null,this.hl=t,this.el=null,this.location=s}ds(t){const s=this.rl(t);this.Te.pe(s,t),this.Te.ds(t,this.$scope)}xt(t){this.Te.xt(t)}Kt(t){this.Te.Kt(t)}Os(t){this.Te.Os(t)}ss(t){null!==this.el&&this.el.release(t)&&(this.el=null),null!==this.nl&&this.nl.release(t)&&(this.nl=null),this.Te.ss(t)}ol(s,i,n){if(3&this.$state)if(t.ProxyObserver.Xi(this)&&(n|=t.LifecycleFlags.Dt),n&t.LifecycleFlags.ht){const t=this.rl(n);this.Te.pe(t,n)}else this.$lifecycle.T(this).catch(t=>{throw t})}flush(s){t.ProxyObserver.Xi(this)&&(s|=t.LifecycleFlags.Dt);const i=this.rl(s);this.Te.pe(i,s)}rl(t){return this.value?this.el=this.ll(this.el,this.hl,t):null!==this.il?this.nl=this.ll(this.nl,this.il,t):null}ll(t,s,i){return null===t&&(t=s.create(i)),t.Ro(this.location),t}}If.inject=[IViewFactory,IRenderLocation,CompositionCoordinator],s([bindable],If.prototype,"value",void 0),CustomAttributeResource.mn({name:"if",isTemplateController:1},If);class Else{constructor(t){this.Ko=t}link(t){t.il=this.Ko}}Else.inject=[IViewFactory],CustomAttributeResource.mn({name:"else",isTemplateController:1},Else);class Repeat{constructor(t,s,i){this.Ko=i,this.cl=0,this.location=t,this.ul=null,this.al=s,this.fl=[],this.key=null,this.Hi=0}ds(s){this.dl(s);let i=this.al.vs;for(;null!==i;){if(t.ProxyObserver.Ji(i.target)===t.ProxyObserver.Ji(this)&&"items"===i.Pe){this.bl=i.Ie;break}i=i.ms}this.pl=this.bl.vl.evaluate(s,this.$scope,null),this.Hi||(s&t.LifecycleFlags.Di)>0?this.wl(null,s):this.ml(null,s)}xt(t){const{fl:s,location:i}=this;let n;for(let h=0,e=s.length;e>h;++h)(n=s[h]).Ro(i),n.Et(t)}Kt(t){const{fl:s}=this;let i;for(let n=0,h=s.length;h>n;++n)(i=s[n]).Zt(t),i.release(t)}Os(t){this.dl(t);const{fl:s}=this;let i;for(let n=0,h=s.length;h>n;++n)(i=s[n]).us(t)}gl(s,i,n){this.dl(n),n|=t.LifecycleFlags.W,this.Hi||(n&t.LifecycleFlags.Di)>0?this.wl(null,n):this.ml(null,n)}M(s,i){i|=t.LifecycleFlags.ht|t.LifecycleFlags.W,this.Hi||(i&t.LifecycleFlags.Di)>0?this.wl(s,i):this.ml(s,i)}ml(s,i){t.ProxyObserver.Xi(this)&&(i|=t.LifecycleFlags.Dt);const{fl:n,$lifecycle}=this;let h;if(3&this.$state){const{pl:t,$scope,Ko:e,bl:r,yl:o}=this,l=n.length,c=r.count(o);if(c>l){n.length=c;for(let t=l;c>t;++t)n[t]=e.create(i)}else if(l>c){$lifecycle.Qt();for(let t=c;l>t;++t)(h=n[t]).release(i),h.Zt(i);$lifecycle._t(i),$lifecycle.gs();for(let t=c;l>t;++t)(h=n[t]).us(i);if($lifecycle.js(i),n.length=c,0===c)return}else if(0===c)return;$lifecycle.as(),r.Cl(o,null===s?(s,e,r)=>{(h=n[e]).ws(i,Scope.un(i,$scope,h.$scope&&h.$scope.on[t]===r?h.$scope.on:BindingContext.create(i,t,r)))}:(e,r,o)=>{(h=n[r]).ws(i,Scope.un(i,$scope,!h.$scope||s[r]!==r&&h.$scope.on[t]!==o?BindingContext.create(i,t,o):h.$scope.on))}),$lifecycle.bs(i)}if(12&this.$state){const{location:t}=this;if($lifecycle.Bt(),null===s)for(let s=0,e=n.length;e>s;++s)(h=n[s]).Ro(t),h.Et(i);else for(let e=0,r=n.length;r>e;++e)s[e]!==e&&((h=n[e]).Ro(t),h.Et(i));$lifecycle.Nt(i)}}wl(s,i){t.ProxyObserver.Xi(this)&&(i|=t.LifecycleFlags.Dt);const{$lifecycle,pl:n,$scope,Ko:h,bl:e,yl:r}=this;let o=this.fl;if(null===s){if(3&this.$state){$lifecycle.Qt();const t=o.length;let s;for(let n=0;t>n;++n)(s=o[n]).release(i),s.Zt(i);$lifecycle._t(i),$lifecycle.gs();for(let n=0;t>n;++n)(s=o[n]).us(i);$lifecycle.js(i);const l=e.count(r);o=this.fl=Array(l),$lifecycle.as(),e.Cl(r,(t,e,r)=>{(s=o[e]=h.create(i)).ws(i,Scope.un(i,$scope,BindingContext.create(i,n,r)))}),$lifecycle.bs(i)}if(12&this.$state){const{location:t}=this;let s;$lifecycle.Bt();const n=o.length;for(let h=0;n>h;++h)(s=o[h]).Ro(t),s.Et(i);$lifecycle.Nt(i)}}else{const e=s.length;let l;const c=s.wt,u=c.length;let a=0;if(3&this.$state){if(u>0){for($lifecycle.Qt(),a=0;u>a;++a)(l=o[c[a]]).release(i),l.Zt(i);for($lifecycle._t(i),$lifecycle.gs(),a=0;u>a;++a)(l=o[c[a]]).us(i);$lifecycle.js(i),a=0;let t=0,n=0;for(c.sort();u>a;++a)for(o.splice(t=c[a]-a,1),n=0;e>n;++n)t>s[n]||--s[n]}for($lifecycle.as(),a=0;e>a;++a)-2===s[a]&&((l=h.create(i)).ws(i,Scope.un(i,$scope,BindingContext.create(i,n,r[a]))),o.splice(a,0,l));if($lifecycle.bs(i),o.length!==e)throw Error(`viewsLen=${o.length}, mapLen=${e}`)}if(12&this.$state){const{location:n}=this,h=(function(t){const s=t.length,i=s+(t.wt&&t.wt.length||0),n=255>i?Uint8Array:65535>i?Uint16Array:Uint32Array;s>ii&&(ii=s,ti=new n(s),si=new n(s));let h=0,e=0,r=0,o=0,l=0,c=0,u=0,a=0;for(;s>o;o++)if(-2!==(e=t[o])){if(-2!==(r=t[l=ti[h]])&&e>r){si[o]=l,ti[++h]=o;continue}for(c=0,u=h;u>c;)-2!==(r=t[ti[a=c+u>>1]])&&e>r?c=a+1:u=a;((r=t[ti[c]])>e||-2===r)&&(c>0&&(ti[o]=ti[c-1]),ti[c]=o)}const f=new n(o=++h);for(e=ti[h-1];h-- >0;)f[h]=e,e=si[e];for(;o-- >0;)ti[o]=0;return f})(s),e=h.length;$lifecycle.Qt(),$lifecycle.Bt(),$lifecycle.qt({Eh(){let r=n,c=e-1;for(a=s.length-1;a>=0;--a)if(-2===s[a]){(l=o[a]).$state|=4;let s=l.Ut;for(;null!==s;)s.Et(i|t.LifecycleFlags.Mt),s=s.zt;l.$nodes.insertBefore(r),l.$state|=24,l.$state&=-5,r=l.$nodes.firstChild}else if(0>c||1===e||a!==h[c]){(l=o[s[a]]).$state|=32;let n=l.Yt;for(;null!==n;)n.Zt(i|t.LifecycleFlags.Ht),n=n.ts;for(l.$nodes.remove(),l.$state&=-57,l.$state|=4,n=l.Ut;null!==n;)n.Et(i|t.LifecycleFlags.Mt),n=n.zt;l.$nodes.insertBefore(r),l.$state|=24,l.$state&=-5,r=l.$nodes.firstChild}else r=(l=o[a]).$nodes.firstChild,--c},Uh:null}),$lifecycle._t(i),$lifecycle.Nt(i)}}}dl(t){const s=this.ul;if(3&this.$state){const i=this.ul=getCollectionObserver(t,this.$lifecycle,this.yl);s!==i&&s&&s.Tt(this),i&&i.jt(this)}else s&&s.Tt(this)}}let ti,si;Repeat.inject=[IRenderLocation,IRenderable,IViewFactory],s([bindable],Repeat.prototype,"items",void 0),CustomAttributeResource.mn({name:"repeat",isTemplateController:1},Repeat);let ii=0;class Replaceable{constructor(t,s){this.Ko=t,this.currentView=this.Ko.create(),this.currentView.Ro(s)}ds(s){this.currentView.ws(s|t.LifecycleFlags.Vi,this.$scope)}xt(t){this.currentView.Et(t)}Kt(t){this.currentView.Zt(t)}Os(t){this.currentView.us(t)}}Replaceable.inject=[IViewFactory,IRenderLocation],CustomAttributeResource.mn({name:"replaceable",isTemplateController:1},Replaceable);class With{constructor(t,s){this.value=null,this.Ko=t,this.currentView=this.Ko.create(),this.currentView.Ro(s)}ol(){3&this.$state&&this.Ol(t.LifecycleFlags.Pi)}ds(t){this.Ol(t)}xt(t){this.currentView.Et(t)}Kt(t){this.currentView.Zt(t)}Os(t){this.currentView.us(t)}Ol(t){const s=Scope.un(t,this.$scope,this.value);this.currentView.ws(t,s)}}With.inject=[IViewFactory,IRenderLocation],s([bindable],With.prototype,"value",void 0),CustomAttributeResource.mn({name:"with",isTemplateController:1},With);const ISanitizer=kernel.DI.fn("ISanitizer").an(t=>t.singleton(class{jl(t){return t.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"")}}));class SanitizeValueConverter{constructor(t){this.Tl=t}Ks(t){return null==t?null:this.Tl.jl(t)}}SanitizeValueConverter.inject=[ISanitizer],ValueConverterResource.mn("sanitize",SanitizeValueConverter),kernel.Profiler.do("Aurelia.start"),kernel.Profiler.do("Aurelia.stop");class Aurelia{constructor(t=kernel.DI.Al()){this.Fo=t,this.Sl=[],this.Rl=[],this.Il=[],this.Pl=0,this.kl=null,kernel.Registration.m(Aurelia,this).register(t,Aurelia)}register(...t){return this.Fo.register(...t),this}app(s){const host=s.host;this.Fo.get(IDOMInitializer).initialize(s);let component,i=t.LifecycleFlags.Si,n=t.LifecycleFlags.Jt;s.Dt&&(i|=t.LifecycleFlags.Dt,n|=t.LifecycleFlags.Dt);const h=s.component;CustomElementResource.wn(h)?(this.Fo.register(h),component=this.Fo.get(CustomElementResource.G(h.description.name))):component=h,component=t.ProxyObserver.Ji(component);const e=()=>{host.$au=this,this.Sl.includes(component)||(this.kl=component,this.Sl.push(component),component.sl(i,this.Fo,host)),component.ws(i|t.LifecycleFlags.et,null),component.Et(i|t.LifecycleFlags.Mt)};return this.Rl.push(e),this.Il.push(()=>{component.Zt(n|t.LifecycleFlags.Ht),component.us(n|t.LifecycleFlags.ys),host.$au=null}),this.Pl&&e(),this}root(){return t.ProxyObserver._i(this.kl)}start(){for(const t of this.Rl)t();return this.Pl=1,this}stop(){this.Pl=0;for(const t of this.Il)t();return this}}kernel.PLATFORM.global.Aurelia=Aurelia;const IDOMInitializer=kernel.DI.fn("IDOMInitializer").Zn();class ni{constructor(t){const s=this.$l={};t.forEach(t=>{s[t._s]=t})}static register(t){return kernel.Registration.singleton(IRenderer,this).register(t)}Ps(t,dom,s,i,targets,n,host,parts){const h=n.instructions,e=this.$l;if(targets.length!==h.length)throw kernel.Reporter.error(targets.length>h.length?30:31);let instructions,r,o;for(let n=0,l=targets.length;l>n;++n){r=targets[n];for(let l=0,c=(instructions=h[n]).length;c>l;++l)e[(o=instructions[l]).type].Ps(t,dom,s,i,r,o,parts)}if(host){const h=n.surrogates;for(let n=0,r=h.length;r>n;++n)e[(o=h[n]).type].Ps(t,dom,s,i,host,o,parts)}}}ni.inject=[kernel.all(IInstructionRenderer)];let hi=class{Ps(t,dom,s,i,n,h){n[h.to]=h.value}};hi=s([instructionRenderer("re")],hi);let ei=class{Ps(t,dom,s,i,n,h){const e=s.ks(i,n,h,null,null,n,1),component=s.get(q(h.res)),r=s.get(IRenderer).$l,o=h.instructions;let l;component.sl(t,s,n,h);for(let n=0,h=o.length;h>n;++n)r[(l=o[n]).type].Ps(t,dom,s,i,component,l);addComponent(i,component),e._()}};ei=s([instructionRenderer("ra")],ei);let ri=class{Ps(t,dom,s,i,n,h){const e=s.ks(i,n,h),component=s.get(H(h.res)),r=s.get(IRenderer).$l,o=h.instructions;let l;component.sl(t,s);for(let n=0,h=o.length;h>n;++n)r[(l=o[n]).type].Ps(t,dom,s,i,component,l);addComponent(i,component),e._()}};ri=s([instructionRenderer("rb")],ri);let oi=class{constructor(t){this.Vl=t}Ps(t,dom,s,i,n,h,parts){const e=this.Vl.Qo(dom,h.def,s),r=s.ks(i,n,h,e,parts,dom.bo(n),0),component=s.get(H(h.res)),o=s.get(IRenderer).$l,l=h.instructions;let c;component.sl(t,s),h.link&&component.link(i.Yt);for(let n=0,h=l.length;h>n;++n)o[(c=l[n]).type].Ps(t,dom,s,i,component,c);addComponent(i,component),r._()}};oi.inject=[IRenderingEngine],oi=s([instructionRenderer("rc")],oi);let li=class{constructor(t,s){this.Dl=t,this.st=s}Ps(s,dom,i,n,h,e){dom.remove(h);const r=e.instructions,toViewModel=e.toViewModel;let o,l,c;for(let s=0,h=r.length;h>s;++s)l=ensureExpression(this.Dl,(o=r[s]).from,48),addBinding(n,c=new t.LetBinding(l,o.to,this.st,i,toViewModel))}};li.inject=[IExpressionParser,IObserverLocator],li=s([instructionRenderer("rd")],li);let ci=class{constructor(t,s){this.Dl=t,this.st=s}Ps(t,dom,s,i,n,h){const e=ensureExpression(this.Dl,h.from,153);addBinding(i,new Call(e,n,h.to,this.st,s))}};ci.inject=[IExpressionParser,IObserverLocator],ci=s([instructionRenderer("rh")],ci);let ui=class{constructor(t){this.Dl=t}Ps(t,dom,s,i,n,h){const e=ensureExpression(this.Dl,h.from,1280);addBinding(i,new Ref(e,n,s))}};ui.inject=[IExpressionParser],ui=s([instructionRenderer("rj")],ui);let ai=class{constructor(t,s){this.Dl=t,this.st=s}Ps(s,dom,i,n,h,e){let r;const o=ensureExpression(this.Dl,e.from,2048);addBinding(n,r=o.Ll?new MultiInterpolationBinding(this.st,o,h,e.to,t.BindingMode.Ks,i):new t.InterpolationBinding(o.Bl,o,h,e.to,t.BindingMode.Ks,this.st,i,1))}};ai.inject=[IExpressionParser,IObserverLocator],ai=s([instructionRenderer("rf")],ai);let fi=class{constructor(t,s){this.Dl=t,this.st=s}Ps(s,dom,i,n,h,e){const r=ensureExpression(this.Dl,e.from,48|e.mode);addBinding(n,new t.Binding(r,h,e.to,e.mode,this.st,i))}};fi.inject=[IExpressionParser,IObserverLocator],fi=s([instructionRenderer("rg")],fi);let di=class{constructor(t,s){this.Dl=t,this.st=s}Ps(s,dom,i,n,h,e){const r=ensureExpression(this.Dl,e.from,539);addBinding(n,new t.Binding(r,h,e.to,t.BindingMode.Ks,this.st,i))}};di.inject=[IExpressionParser,IObserverLocator],di=s([instructionRenderer("rk")],di);class bi{bind(t,s,i,n){i.target.key=n,i.target.Hi=1}De(t,s,i){i.target.key=null,i.target.Hi=0}}BindingBehaviorResource.mn("keyed",bi);const pi=Rs,vi=Bt,wi=ni,DefaultComponents=[pi,vi,wi],IfRegistration=If,ElseRegistration=Else,RepeatRegistration=Repeat,ReplaceableRegistration=Replaceable,WithRegistration=With,SanitizeValueConverterRegistration=SanitizeValueConverter,DebounceBindingBehaviorRegistration=DebounceBindingBehavior,OneTimeBindingBehaviorRegistration=OneTimeBindingBehavior,ToViewBindingBehaviorRegistration=ToViewBindingBehavior,FromViewBindingBehaviorRegistration=FromViewBindingBehavior,SignalBindingBehaviorRegistration=SignalBindingBehavior,ThrottleBindingBehaviorRegistration=ThrottleBindingBehavior,TwoWayBindingBehaviorRegistration=TwoWayBindingBehavior,DefaultResources=[IfRegistration,ElseRegistration,RepeatRegistration,ReplaceableRegistration,WithRegistration,SanitizeValueConverterRegistration,DebounceBindingBehaviorRegistration,bi,OneTimeBindingBehaviorRegistration,ToViewBindingBehaviorRegistration,FromViewBindingBehaviorRegistration,SignalBindingBehaviorRegistration,ThrottleBindingBehaviorRegistration,TwoWayBindingBehaviorRegistration],DefaultRenderers=[fi,di,ci,ui,ai,hi,ei,ri,oi,li],mi={register:t=>t.register(...DefaultComponents,...DefaultResources,...DefaultRenderers),Al(){return this.register(kernel.DI.Al())}};t.CallFunction=class{constructor(t,s){this.J=1162,this.assign=kernel.PLATFORM.Sn,this.Ml=t,this.Dn=s}evaluate(s,i,n){const h=this.Ml.evaluate(s,i,n);if("function"==typeof h)return h.apply(null,m(s,i,n,this.Dn));if(s&t.LifecycleFlags.Y||null!=h)throw kernel.Reporter.error(207,this)}connect(t,s,i){const n=this.Ml.evaluate(t,s,null);if(this.Ml.connect(t,s,i),"function"==typeof n){const n=this.Dn;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i)}}accept(t){return t.xl(this)}},t.connects=function(t){return 32==(32&t.J)},t.observes=function(t){return 64==(64&t.J)},t.callsFunction=function(t){return 128==(128&t.J)},t.hasAncestor=function(t){return 256==(256&t.J)},t.isAssignable=function(t){return 8192==(8192&t.J)},t.isLeftHandSide=function(t){return 1024==(1024&t.J)},t.isPrimary=function(t){return 512==(512&t.J)},t.isResource=function(t){return 32768==(32768&t.J)},t.hasBind=hasBind,t.hasUnbind=hasUnbind,t.isLiteral=isLiteral,t.arePureLiterals=arePureLiterals,t.isPureLiteral=isPureLiteral,t.BindingBehavior=class{constructor(t,name,s){this.J=38962,this.Fl=t,this.name=name,this.Dn=s,this.Nl=BindingBehaviorResource.G(this.name)}evaluate(t,s,i){return this.Fl.evaluate(t,s,i)}assign(t,s,i,value){return this.Fl.assign(t,s,i,value)}connect(t,s,i){this.Fl.connect(t,s,i)}bind(t,s,i){if(void 0===s)throw kernel.Reporter.error(250,this);if(null===s)throw kernel.Reporter.error(251,this);if(!i)throw kernel.Reporter.error(206,this);const n=i.Re;if(!n)throw kernel.Reporter.error(202,this);hasBind(this.Fl)&&this.Fl.bind(t,s,i);const h=this.Nl,e=n.get(h);if(!e)throw kernel.Reporter.error(203,this);null==i[h]?(i[h]=e,e.bind.apply(e,[t,s,i].concat(m(t,s,n,this.Dn)))):kernel.Reporter.write(204,this)}De(t,s,i){const n=this.Nl;null!=i[n]?(i[n].De(t,s,i),i[n]=null):kernel.Reporter.write(204,this),hasUnbind(this.Fl)&&this.Fl.De(t,s,i)}accept(t){return t.Ul(this)}},t.ValueConverter=class{constructor(t,name,s){this.J=36913,this.Fl=t,this.name=name,this.Dn=s,this.El=ValueConverterResource.G(this.name)}evaluate(t,s,i){if(!i)throw kernel.Reporter.error(202,this);const n=i.get(this.El);if(!n)throw kernel.Reporter.error(205,this);if("toView"in n){const h=this.Dn,e=h.length,r=Array(e+1);r[0]=this.Fl.evaluate(t,s,i);for(let n=0;e>n;++n)r[n+1]=h[n].evaluate(t,s,i);return n.Ks.apply(n,r)}return this.Fl.evaluate(t,s,i)}assign(t,s,i,value){if(!i)throw kernel.Reporter.error(202,this);const n=i.get(this.El);if(!n)throw kernel.Reporter.error(205,this);return"fromView"in n&&(value=n.Gs.apply(n,[value].concat(m(t,s,i,this.Dn)))),this.Fl.assign(t,s,i,value)}connect(t,s,i){if(void 0===s)throw kernel.Reporter.error(250,this);if(null===s)throw kernel.Reporter.error(251,this);if(!i)throw kernel.Reporter.error(206,this);const n=i.Re;if(!n)throw kernel.Reporter.error(202,this);this.Fl.connect(t,s,i);const h=this.Dn;for(let n=0,e=h.length;e>n;++n)h[n].connect(t,s,i);const e=n.get(this.El);if(!e)throw kernel.Reporter.error(205,this);const r=e.dn;if(void 0===r)return;const o=n.get(ISignaler);for(let t=0,s=r.length;s>t;++t)o.pn(r[t],i)}De(t,s,i){const n=i.Re,h=n.get(this.El).dn;if(void 0===h)return;const e=n.get(ISignaler);for(let t=0,s=h.length;s>t;++t)e.vn(h[t],i)}accept(t){return t.zl(this)}},t.Assign=class{constructor(t,value){this.J=8208,this.target=t,this.value=value}evaluate(t,s,i){return this.target.assign(t,s,i,this.value.evaluate(t,s,i))}connect(t,s,i){}assign(t,s,i,value){return this.value.assign(t,s,i,value),this.target.assign(t,s,i,value)}accept(t){return t.ql(this)}},t.Conditional=class{constructor(t,s,i){this.J=63,this.assign=kernel.PLATFORM.Sn,this.Ql=t,this.Hl=s,this.Kl=i}evaluate(t,s,i){return this.Ql.evaluate(t,s,i)?this.Hl.evaluate(t,s,i):this.Kl.evaluate(t,s,i)}connect(t,s,i){this.Ql.evaluate(t,s,null)?(this.Ql.connect(t,s,i),this.Hl.connect(t,s,i)):(this.Ql.connect(t,s,i),this.Kl.connect(t,s,i))}accept(t){return t.Wl(this)}},t.AccessThis=AccessThis,t.AccessScope=AccessScope,t.AccessMember=AccessMember,t.AccessKeyed=class{constructor(t,s){this.J=9324,this.object=t,this.key=s}evaluate(t,s,i){const n=this.object.evaluate(t,s,i);if(null!=n)return n[this.key.evaluate(t,s,i)]}assign(t,s,i,value){return this.object.evaluate(t,s,i)[this.key.evaluate(t,s,i)]=value}connect(t,s,i){const n=this.object.evaluate(t,s,null);if(this.object.connect(t,s,i),"object"==typeof n&&null!==n){this.key.connect(t,s,i);const h=this.key.evaluate(t,s,null);Array.isArray(n)&&(function(value){const t=typeof value;if("number"===t)return 1;if("string"!==t)return 0;const s=value.length;if(0===s)return 0;let i;for(let t=0;s>t;++t)if(48>(i=value.charCodeAt(t))||i>57)return 0;return 1})(h)||i.nt(t,n,h)}}accept(t){return t._l(this)}},t.CallScope=CallScope,t.CallMember=CallMember,t.Binary=class{constructor(t,s,i){this.J=46,this.assign=kernel.PLATFORM.Sn,this.Gl=t,this.left=s,this.right=i,this.evaluate=this[t]}evaluate(t,s,i){throw kernel.Reporter.error(208,this)}connect(t,s,i){const n=this.left.evaluate(t,s,null);this.left.connect(t,s,i),"&&"===this.Gl&&!n||"||"===this.Gl&&n||this.right.connect(t,s,i)}Jl(t,s,i){return this.left.evaluate(t,s,i)&&this.right.evaluate(t,s,i)}Xl(t,s,i){return this.left.evaluate(t,s,i)||this.right.evaluate(t,s,i)}Yl(t,s,i){return this.left.evaluate(t,s,i)==this.right.evaluate(t,s,i)}Zl(t,s,i){return this.left.evaluate(t,s,i)===this.right.evaluate(t,s,i)}tc(t,s,i){return this.left.evaluate(t,s,i)!=this.right.evaluate(t,s,i)}sc(t,s,i){return this.left.evaluate(t,s,i)!==this.right.evaluate(t,s,i)}ic(t,s,i){const n=this.right.evaluate(t,s,i);return"function"==typeof n?this.left.evaluate(t,s,i)instanceof n:0}nc(t,s,i){const n=this.right.evaluate(t,s,i);return null!==n&&"object"==typeof n?this.left.evaluate(t,s,i)in n:0}hc(t,s,i){return this.left.evaluate(t,s,i)+this.right.evaluate(t,s,i)}ec(t,s,i){return this.left.evaluate(t,s,i)-this.right.evaluate(t,s,i)}rc(t,s,i){return this.left.evaluate(t,s,i)*this.right.evaluate(t,s,i)}oc(t,s,i){return this.left.evaluate(t,s,i)/this.right.evaluate(t,s,i)}lc(t,s,i){return this.left.evaluate(t,s,i)%this.right.evaluate(t,s,i)}cc(t,s,i){return this.left.evaluate(t,s,i)<this.right.evaluate(t,s,i)}uc(t,s,i){return this.left.evaluate(t,s,i)>this.right.evaluate(t,s,i)}ac(t,s,i){return this.left.evaluate(t,s,i)<=this.right.evaluate(t,s,i)}fc(t,s,i){return this.left.evaluate(t,s,i)>=this.right.evaluate(t,s,i)}accept(t){return t.dc(this)}},t.Unary=class{constructor(t,s){this.J=39,this.assign=kernel.PLATFORM.Sn,this.Gl=t,this.Fl=s,this.evaluate=this[t]}evaluate(t,s,i){throw kernel.Reporter.error(208,this)}connect(t,s,i){this.Fl.connect(t,s,i)}bc(t,s,i){this.Fl.evaluate(t,s,i)}pc(t,s,i){return typeof this.Fl.evaluate(t,s,i)}vc(t,s,i){return!this.Fl.evaluate(t,s,i)}ec(t,s,i){return-this.Fl.evaluate(t,s,i)}hc(t,s,i){return+this.Fl.evaluate(t,s,i)}accept(t){return t.wc(this)}},t.PrimitiveLiteral=PrimitiveLiteral,t.HtmlLiteral=class{constructor(parts){this.J=51,this.assign=kernel.PLATFORM.Sn,this.parts=parts}evaluate(t,s,i){const n=this.parts;let value,h="";for(let e=0,r=n.length;r>e;++e)null!=(value=n[e].evaluate(t,s,i))&&(h+=value);return h}connect(t,s,i){for(let n=0,h=this.parts.length;h>n;++n)this.parts[n].connect(t,s,i)}accept(t){return t.mc(this)}},t.ArrayLiteral=ArrayLiteral,t.ObjectLiteral=ObjectLiteral,t.Template=Template,t.TaggedTemplate=class{constructor(t,s,i,n){this.J=1197,this.assign=kernel.PLATFORM.Sn,this.Hn=t,this.Hn.raw=s,this.Ml=i,this.X=void 0===n?kernel.PLATFORM.qn:n}evaluate(t,s,i){const n=this.X,h=n.length,e=Array(h);for(let r=0,o=h;o>r;++r)e[r]=n[r].evaluate(t,s,i);const r=this.Ml.evaluate(t,s,i);if("function"!=typeof r)throw kernel.Reporter.error(207,this);return r.apply(null,[this.Hn].concat(e))}connect(t,s,i){const n=this.X;for(let h=0,e=n.length;e>h;++h)n[h].connect(t,s,i);this.Ml.connect(t,s,i)}accept(t){return t.gc(this)}},t.ArrayBindingPattern=class{constructor(t){this.J=65556,this.elements=t}evaluate(t,s,i){}assign(t,s,i,n){}connect(t,s,i){}accept(t){return t.yc(this)}},t.ObjectBindingPattern=class{constructor(t,s){this.J=65557,this.keys=t,this.values=s}evaluate(t,s,i){}assign(t,s,i,n){}connect(t,s,i){}accept(t){return t.Cc(this)}},t.BindingIdentifier=class{constructor(name){this.J=65558,this.name=name}evaluate(t,s,i){return this.name}connect(t,s,i){}accept(t){return t.Oc(this)}},t.ForOfStatement=class{constructor(t,s){this.J=6199,this.assign=kernel.PLATFORM.Sn,this.vl=t,this.jc=s}evaluate(t,s,i){return this.jc.evaluate(t,s,i)}count(t){return Dt[$t.call(t)](t)}Cl(t,s){Vt[$t.call(t)](t,s)}connect(t,s,i){this.vl.connect(t,s,i),this.jc.connect(t,s,i)}bind(t,s,i){hasBind(this.jc)&&this.jc.bind(t,s,i)}De(t,s,i){hasUnbind(this.jc)&&this.jc.De(t,s,i)}accept(t){return t.Tc(this)}},t.Interpolation=class{constructor(parts,t){this.J=24,this.assign=kernel.PLATFORM.Sn,this.parts=parts,this.X=void 0===t?kernel.PLATFORM.qn:t,this.Ll=this.X.length>1,this.Bl=this.X[0]}evaluate(t,s,i){if(this.Ll){const n=this.X,parts=this.parts;let h=parts[0];for(let e=0,r=n.length;r>e;++e)h+=n[e].evaluate(t,s,i),h+=parts[e+1];return h}{const parts=this.parts;return parts[0]+this.Bl.evaluate(t,s,i)+parts[1]}}connect(t,s,i){}accept(t){return t.Ac(this)}},t.Call=Call,t.connectable=connectable,t.IExpressionParser=IExpressionParser,t.MultiInterpolationBinding=MultiInterpolationBinding,t.Ref=Ref,t.enableArrayObservation=enableArrayObservation,t.disableArrayObservation=function(){for(const t of ss)1==Kt[t].F&&def(Kt,t,Object.assign({},ns,{value:ts[t]}))},t.enableMapObservation=enableMapObservation,t.disableMapObservation=function(){for(const t of cs)1==hs[t].F&&fs(hs,t,Object.assign({},as,{value:ls[t]}))},t.enableSetObservation=enableSetObservation,t.disableSetObservation=function(){for(const t of ms)1==ds[t].F&&Cs(ds,t,Object.assign({},ys,{value:ws[t]}))},t.BindingContext=BindingContext,t.Scope=Scope,t.OverrideContext=OverrideContext,t.collectionObserver=collectionObserver,t.computed=function(t){return function(s,i){(s.computed||(s.computed={}))[i]=t}},t.IDirtyChecker=IDirtyChecker,t.DirtyCheckSettings=DirtyCheckSettings,t.IObserverLocator=IObserverLocator,t.ITargetObserverLocator=ITargetObserverLocator,t.ITargetAccessorLocator=ITargetAccessorLocator,t.getCollectionObserver=getCollectionObserver,t.PrimitiveObserver=PrimitiveObserver,t.PropertyAccessor=PropertyAccessor,t.propertyObserver=propertyObserver,t.ISignaler=ISignaler,t.subscriberCollection=subscriberCollection,t.batchedSubscriberCollection=batchedSubscriberCollection,t.targetObserver=targetObserver,t.bindingBehavior=function(t){return s=>BindingBehaviorResource.mn(t,s)},t.BindingBehaviorResource=BindingBehaviorResource,t.BindingModeBehavior=BindingModeBehavior,t.OneTimeBindingBehavior=OneTimeBindingBehavior,t.ToViewBindingBehavior=ToViewBindingBehavior,t.FromViewBindingBehavior=FromViewBindingBehavior,t.TwoWayBindingBehavior=TwoWayBindingBehavior,t.DebounceBindingBehavior=DebounceBindingBehavior,t.SignalBindingBehavior=SignalBindingBehavior,t.ThrottleBindingBehavior=ThrottleBindingBehavior,t.customAttribute=function(t){return s=>CustomAttributeResource.mn(t,s)},t.CustomAttributeResource=CustomAttributeResource,t.dynamicOptions=function(t){return void 0===t?yt:yt(t)},t.templateController=function(t){return s=>CustomAttributeResource.mn("string"==typeof t?{isTemplateController:1,name:t}:Object.assign({isTemplateController:1},t),s)},t.If=If,t.Else=Else,t.Repeat=Repeat,t.Replaceable=Replaceable,t.With=With,t.containerless=function(t){return void 0===t?vt:vt(t)},t.customElement=function(t){return s=>CustomElementResource.mn(t,s)},t.CustomElementResource=CustomElementResource,t.IProjectorLocator=IProjectorLocator,t.useShadowDOM=function(t){function s(t){return t.shadowOptions=i,t}const i="function"!=typeof t&&t?t:Zs;return"function"==typeof t?s(t):s},t.valueConverter=function(t){return s=>ValueConverterResource.mn(t,s)},t.ValueConverterResource=ValueConverterResource,t.ISanitizer=ISanitizer,t.SanitizeValueConverter=SanitizeValueConverter,t.bindable=bindable,t.Aurelia=Aurelia,t.IDOMInitializer=IDOMInitializer,t.IfRegistration=IfRegistration,t.ElseRegistration=ElseRegistration,t.RepeatRegistration=RepeatRegistration,t.ReplaceableRegistration=ReplaceableRegistration,t.WithRegistration=WithRegistration,t.SanitizeValueConverterRegistration=SanitizeValueConverterRegistration,t.DebounceBindingBehaviorRegistration=DebounceBindingBehaviorRegistration,t.OneTimeBindingBehaviorRegistration=OneTimeBindingBehaviorRegistration,t.ToViewBindingBehaviorRegistration=ToViewBindingBehaviorRegistration,t.FromViewBindingBehaviorRegistration=FromViewBindingBehaviorRegistration,t.SignalBindingBehaviorRegistration=SignalBindingBehaviorRegistration,t.ThrottleBindingBehaviorRegistration=ThrottleBindingBehaviorRegistration,t.TwoWayBindingBehaviorRegistration=TwoWayBindingBehaviorRegistration,t.BasicResources=DefaultResources,t.ObserverLocatorRegistration=pi,t.LifecycleRegistration=vi,t.RendererRegistration=wi,t.BasicConfiguration=mi,t.buildTemplateDefinition=buildTemplateDefinition,t.isTargetedInstruction=function(value){const type=value.type;return"string"==typeof type&&2===type.length},t.ITargetedInstruction=ITargetedInstruction,t.DOM=DOM,t.INode=INode,t.IRenderLocation=IRenderLocation,t.IDOM=IDOM,t.NodeSequence=NodeSequence,t.stringifyLifecycleFlags=function(s){const i=[];return s&t.LifecycleFlags.Y&&i.push("mustEvaluate"),s&t.LifecycleFlags.gi&&i.push("isCollectionMutation"),s&t.LifecycleFlags.yi&&i.push("isInstanceMutation"),s&t.LifecycleFlags.Ci&&i.push("updateTargetObserver"),s&t.LifecycleFlags.W&&i.push("updateTargetInstance"),s&t.LifecycleFlags.Oi&&i.push("updateSourceExpression"),s&t.LifecycleFlags.ji&&i.push("fromAsyncFlush"),s&t.LifecycleFlags.Ti&&i.push("fromSyncFlush"),s&t.LifecycleFlags.Si&&i.push("fromStartTask"),s&t.LifecycleFlags.Jt&&i.push("fromStopTask"),s&t.LifecycleFlags.et&&i.push("fromBind"),s&t.LifecycleFlags.ys&&i.push("fromUnbind"),s&t.LifecycleFlags.Mt&&i.push("fromAttach"),s&t.LifecycleFlags.Ht&&i.push("fromDetach"),s&t.LifecycleFlags.ns&&i.push("fromCache"),s&t.LifecycleFlags.Ri&&i.push("fromDOMEvent"),s&t.LifecycleFlags.Ii&&i.push("fromObserverSetter"),s&t.LifecycleFlags.Pi&&i.push("fromBindableHandler"),s&t.LifecycleFlags.ki&&i.push("fromLifecycleTask"),s&t.LifecycleFlags.Gt&&i.push("parentUnmountQueued"),s&t.LifecycleFlags.ot&&i.push("doNotUpdateDOM"),s&t.LifecycleFlags.$i&&i.push("isTraversingParentScope"),s&t.LifecycleFlags.Vi&&i.push("allowParentScopeTraversal"),s&t.LifecycleFlags.Dt&&i.push("useProxies"),i.join("|")},t.CallBindingInstruction=class{constructor(from,to){this.type="rh",this.from=from,this.to=to}},t.FromViewBindingInstruction=class{constructor(from,to){this.type="rg",this.from=from,this.mode=t.BindingMode.Gs,this.oneTime=0,this.to=to}},t.HydrateAttributeInstruction=class{constructor(res,instructions){this.type="rb",this.instructions=instructions,this.res=res}},t.HydrateElementInstruction=class{constructor(res,instructions,parts){this.type="ra",this.instructions=instructions,this.parts=parts,this.res=res}},t.HydrateTemplateController=class{constructor(def,res,instructions,link){this.type="rc",this.def=def,this.instructions=instructions,this.link=link,this.res=res}},t.InterpolationInstruction=class{constructor(from,to){this.type="rf",this.from=from,this.to=to}},t.IteratorBindingInstruction=class{constructor(from,to){this.type="rk",this.from=from,this.to=to}},t.LetBindingInstruction=class{constructor(from,to){this.type="ri",this.from=from,this.to=to}},t.LetElementInstruction=class{constructor(instructions,toViewModel){this.type="rd",this.instructions=instructions,this.toViewModel=toViewModel}},t.OneTimeBindingInstruction=class{constructor(from,to){this.type="rg",this.from=from,this.mode=t.BindingMode.oneTime,this.oneTime=1,this.to=to}},t.RefBindingInstruction=class{constructor(from){this.type="rj",this.from=from}},t.SetPropertyInstruction=class{constructor(value,to){this.type="re",this.to=to,this.value=value}},t.ToViewBindingInstruction=class{constructor(from,to){this.type="rg",this.from=from,this.mode=t.BindingMode.Ks,this.oneTime=0,this.to=to}},t.TwoWayBindingInstruction=class{constructor(from,to){this.type="rg",this.type="rg",this.from=from,this.mode=t.BindingMode.Js,this.oneTime=0,this.to=to}},t.AggregateLifecycleTask=AggregateLifecycleTask,t.CompositionCoordinator=CompositionCoordinator,t.ILifecycle=ILifecycle,t.IRenderable=IRenderable,t.IViewFactory=IViewFactory,t.LifecycleTask=LifecycleTask,t.PromiseTask=class{constructor(t,s){this.done=0,this.Ae=0,this.Hs=s,this.Sh=t.then(value=>{if(1!=this.Ae)return this.done=1,this.Hs(value),value})}ge(){return!this.done}cancel(){this.ge()&&(this.Ae=1)}ye(){return this.Sh}},t.instructionRenderer=instructionRenderer,t.ensureExpression=ensureExpression,t.addComponent=addComponent,t.addBinding=addBinding,t.CompiledTemplate=class{constructor(dom,t,s,i){this.dom=dom,this.Sc=t,this.Ko=s,this.Mo=i}Ps(s,host,parts,i=t.LifecycleFlags.Xs){const n=s.$nodes=this.Ko.Rc();s.$context=this.Mo,this.Sc.Dt&&(i|=t.LifecycleFlags.Dt),this.Mo.Ps(i,s,n.Ao(),this.Sc,host,parts)}},t.createRenderContext=createRenderContext,t.IInstructionRenderer=IInstructionRenderer,t.IRenderer=IRenderer,t.IRenderingEngine=IRenderingEngine,t.ITemplateCompiler=ITemplateCompiler,t.ITemplateFactory=ITemplateFactory,Object.defineProperty(t,"Ic",{value:1})});
