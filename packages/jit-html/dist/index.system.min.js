System.register("jitHtml",["@aurelia/jit","@aurelia/runtime-html","@aurelia/kernel","@aurelia/runtime"],function(e){"use strict";var getTarget,BindingCommandResource,PlainElementSymbol,CustomElementSymbol,LetElementSymbol,BindableInfo,BindingSymbol,TextSymbol,TemplateControllerSymbol,CustomAttributeSymbol,PlainAttributeSymbol,ReplacePartSymbol,ResourceModel,IAttributeParser,JitConfiguration,TriggerBindingInstruction,DelegateBindingInstruction,CaptureBindingInstruction,TextBindingInstruction,SetAttributeInstruction,HTMLRuntimeConfiguration,PLATFORM,DI,Registration,BindingMode,IDOM,LetBindingInstruction,LetElementInstruction,HydrateElementInstruction,HydrateTemplateController,SetPropertyInstruction,InterpolationInstruction,HydrateAttributeInstruction,RefBindingInstruction,IExpressionParser,ITemplateCompiler;return{h:[function(e){getTarget=e.getTarget,BindingCommandResource=e.BindingCommandResource,PlainElementSymbol=e.PlainElementSymbol,CustomElementSymbol=e.CustomElementSymbol,LetElementSymbol=e.LetElementSymbol,BindableInfo=e.BindableInfo,BindingSymbol=e.BindingSymbol,TextSymbol=e.TextSymbol,TemplateControllerSymbol=e.TemplateControllerSymbol,CustomAttributeSymbol=e.CustomAttributeSymbol,PlainAttributeSymbol=e.PlainAttributeSymbol,ReplacePartSymbol=e.ReplacePartSymbol,ResourceModel=e.ResourceModel,IAttributeParser=e.IAttributeParser,JitConfiguration=e.JitConfiguration},function(e){TriggerBindingInstruction=e.TriggerBindingInstruction,DelegateBindingInstruction=e.DelegateBindingInstruction,CaptureBindingInstruction=e.CaptureBindingInstruction,TextBindingInstruction=e.TextBindingInstruction,SetAttributeInstruction=e.SetAttributeInstruction,HTMLRuntimeConfiguration=e.HTMLRuntimeConfiguration},function(e){PLATFORM=e.PLATFORM,DI=e.DI,Registration=e.Registration},function(e){BindingMode=e.BindingMode,IDOM=e.IDOM,LetBindingInstruction=e.LetBindingInstruction,LetElementInstruction=e.LetElementInstruction,HydrateElementInstruction=e.HydrateElementInstruction,HydrateTemplateController=e.HydrateTemplateController,SetPropertyInstruction=e.SetPropertyInstruction,InterpolationInstruction=e.InterpolationInstruction,HydrateAttributeInstruction=e.HydrateAttributeInstruction,RefBindingInstruction=e.RefBindingInstruction,IExpressionParser=e.IExpressionParser,ITemplateCompiler=e.ITemplateCompiler}],s(){function h(e){const h=e.index,{length:s,input:t}=e;for(;s>e.index&&58!==t.charCodeAt(++e.index););return t.slice(h,e.index).trim()}function s(e){++e.index;const{length:h,input:s}=e;let t="",l=0;for(;h>e.index;){switch(l=s.charCodeAt(e.index)){case 59:return++e.index,t.trim();case 47:l=s.charCodeAt(++e.index),t+=`\\${n(l)}`;break;case 39:t+="'";break;default:t+=n(l)}++e.index}return t.trim()}function stringifyDOM(e,h){let s=" ".repeat(h);if(s+=`Node: ${e.nodeName}`,3===e.nodeType&&(s+=` "${e.textContent}"`),1===e.nodeType){let h,t=0;const l=e.attributes,c=l.length;for(;c>t;++t)s+=` ${(h=l[t]).name}=${h.value}`}if(s+="\n",1===e.nodeType){let t=0,childNodes=e.childNodes,l=childNodes.length;for(;l>t;++t)s+=stringifyDOM(childNodes[t],h+1);if("TEMPLATE"===e.nodeName)for(t=0,l=(childNodes=e.content.childNodes).length;l>t;++t)s+=stringifyDOM(childNodes[t],h+1)}return s}function stringifyInstructions(e,h){let s=" ".repeat(h);switch(e.type){case"ha":s+="textBinding\n";break;case"rh":s+="callBinding\n";break;case"rk":s+="iteratorBinding\n";break;case"hb":s+="listenerBinding\n";break;case"rg":s+="propertyBinding\n";break;case"rj":s+="refBinding\n";break;case"hc":s+="stylePropertyBinding\n";break;case"re":s+="setProperty\n";break;case"hd":s+="setAttribute\n";break;case"rf":s+="interpolation\n";break;case"rd":s+="hydrateLetElement\n",e.instructions.forEach(e=>{s+=stringifyInstructions(e,h+1)});break;case"rb":s+=`hydrateAttribute: ${e.res}\n`,e.instructions.forEach(e=>{s+=stringifyInstructions(e,h+1)});break;case"ra":s+=`hydrateElement: ${e.res}\n`,e.instructions.forEach(e=>{s+=stringifyInstructions(e,h+1)});break;case"rc":s+=`hydrateTemplateController: ${e.res}\n`,s+=stringifyTemplateDefinition(e.def,h+1),e.instructions.forEach(e=>{s+=stringifyInstructions(e,h+1)})}return s}function stringifyTemplateDefinition(def,e){const h=" ".repeat(e);let s=h;return s+=`TemplateDefinition: ${def.name}\n`,s+=stringifyDOM(def.template,e+1),s+=`${h} Instructions:\n`,def.instructions.forEach(t=>{s+=`${h}  Row:\n`,t.forEach(h=>{s+=stringifyInstructions(h,e+3)})}),s}e({stringifyDOM,stringifyInstructions,stringifyTemplateDefinition});class TriggerBindingCommand{constructor(){this.t=86}compile(e){return new TriggerBindingInstruction(e.l,getTarget(e,0))}}e("TriggerBindingCommand",TriggerBindingCommand),BindingCommandResource.i("trigger",TriggerBindingCommand);class DelegateBindingCommand{constructor(){this.t=88}compile(e){return new DelegateBindingInstruction(e.l,getTarget(e,0))}}e("DelegateBindingCommand",DelegateBindingCommand),BindingCommandResource.i("delegate",DelegateBindingCommand);class CaptureBindingCommand{constructor(){this.t=87}compile(e){return new CaptureBindingInstruction(e.l,getTarget(e,0))}}e("CaptureBindingCommand",CaptureBindingCommand),BindingCommandResource.i("capture",CaptureBindingCommand);const t={id:1,o:1,u:1},l={k:1,o:1,u:1};class TemplateBinder{constructor(dom,e,h,s){this.dom=dom,this.T=e,this.$=h,this.C=s,this.A=null,this.manifest=null,this.v=null,this.L=null,this.B=null}bind(e){const h=this.A,s=this.L,l=this.v,c=this.manifest,n=this.A=this.manifest=new PlainElementSymbol(e),r=e.attributes;let i=0;for(;r.length>i;){const e=r[i],h=this.$.parse(e.name,e.value);if(1==t[h.target])throw Error(`Invalid surrogate attribute: ${h.target}`);const s=this.T.M(h);if(null===s)this.D(h);else{if(s.isTemplateController)throw Error("Cannot have template controller on surrogate element.");this.O(h,s)}++i}return this.F(e),this.A=h,this.L=s,this.v=l,this.manifest=c,n}H(e,h){switch(h.nodeName){case"LET":return void this.J(e,h);case"SLOT":return void(this.A.hasSlots=1)}const s=this.L,t=this.v,l=this.manifest;let c;this.B=h.getAttribute("part");let name=h.getAttribute("as-element");null===name&&(name=h.nodeName.toLowerCase());const n=this.T.G(name);null===n?this.manifest=new PlainElementSymbol(h):(this.L=this.v,c=this.v=this.manifest=new CustomElementSymbol(this.dom,h,n)),this.F(h),this.K(h,e),void 0!==c&&c.U?h.parentNode.replaceChild(c.marker,h):this.manifest.W&&h.classList.add("au"),this.L=s,this.v=t,this.manifest=l}J(e,h){const s=new LetElementSymbol(this.dom,h);e.childNodes.push(s);const t=h.attributes;let l=0;for(;t.length>l;){const e=t[l];if("to-view-model"===e.name){h.removeAttribute("to-view-model"),s.toViewModel=1;continue}const c=this.$.parse(e.name,e.value),n=this.T.X(c),r=this.C.parse(c.Y,null===n?2048:n.t),to=PLATFORM.Z(c.target),i=new BindableInfo(to,BindingMode._);s.q.push(new BindingSymbol(n,i,r,c.Y,to)),++l}h.parentNode.replaceChild(s.marker,h)}K(e,h){const{L:s,v:t,manifest:c}=this;let n=c;const r=this.m(e);let i,f;const o=e.attributes;let u=0;for(;o.length>u;){const e=o[u];if(++u,1==l[e.name])continue;const h=this.$.parse(e.name,e.value),s=this.T.M(h);null===s?this.D(h):s.isTemplateController?(f=c.templateController=this.V(h,s),n===c?(f.template=c,n=f):(f.templateController=i,f.template=i.template,i.template=f),i=f):this.O(h,s)}(function(dom,e,h){const s=h.P;let t,l=e;for(;l!==h;)l.template===h?(s.parentNode.replaceChild(l.marker,s),"TEMPLATE"===s.nodeName?(l.P=s,s.remove()):(t=l.P=dom.N()).content.appendChild(s)):(t=l.P=dom.N()).content.appendChild(l.marker),s.removeAttribute(l.j.p),l=l.template})(this.dom,n,c),null===r?h.childNodes.push(n):(r.parent=h,r.template=n,(c===t?s:t).parts.push(r),(function(dom,e,h){let s,t;"TEMPLATE"===(s=512&h.flags?h.marker:h.P).nodeName?e.P=s:(t=e.P=dom.N()).content.appendChild(s)})(this.dom,r,n))}F(e){let h,s;for(h="TEMPLATE"===e.nodeName?e.content.firstChild:e.firstChild;null!==h;)switch(h.nodeType){case 1:s=h.nextSibling,this.H(this.manifest,h),h=s;break;case 3:h=this.R(h).nextSibling;break;case 4:case 7:case 8:case 10:h=h.nextSibling;break;case 9:case 11:h=h.firstChild}}R(e){const h=this.C.parse(e.wholeText,2048);if(null!==h){const s=new TextSymbol(this.dom,e,h);this.manifest.childNodes.push(s),(function(e){const h=e.P,s=h.parentNode;for(;null!==h.nextSibling&&3===h.nextSibling.nodeType;)s.removeChild(h.nextSibling);h.textContent="",s.insertBefore(e.marker,h)})(s)}for(;null!==e.nextSibling&&3===e.nextSibling.nodeType;)e=e.nextSibling;return e}V(e,h){let s;const t=this.T.X(e);if(null===t&&h.g)s=new TemplateControllerSymbol(this.dom,e,h,this.B),this.B=null,this.I(s,h,e.Y);else{s=new TemplateControllerSymbol(this.dom,e,h,this.B);const l=this.C.parse(e.Y,null===t?2048:t.t);s.q.push(new BindingSymbol(t,h.bindable,l,e.Y,e.target)),this.B=null}return s}O(e,h){const s=this.T.X(e);let t;if(null===s&&h.g)t=new CustomAttributeSymbol(e,h),this.I(t,h,e.Y);else{t=new CustomAttributeSymbol(e,h);const l=this.C.parse(e.Y,null===s?2048:s.t);t.q.push(new BindingSymbol(s,h.bindable,l,e.Y,e.target))}this.manifest.attributes.push(t),this.manifest.W=1}I(e,t,value){const l=(function(e){const t=[],l=new c(e),n=l.length;let name,value;for(;n>l.index;){if(0===(name=h(l)).length)return t;value=s(l),t.push({name,value})}return t})(value);let n;for(let h=0,s=l.length;s>h;++h){const s=this.$.parse((n=l[h]).name,n.value),c=this.T.X(s),r=this.C.parse(s.Y,null===c?2048:c.t);let bindable=t.bindables[s.target];void 0===bindable&&(bindable=t.bindables[s.target]=new BindableInfo(s.target,BindingMode._)),e.q.push(new BindingSymbol(c,bindable,r,s.Y,s.target))}}D(e){if(0===e.Y.length)return;const h=this.T.X(e),s=this.manifest,t=this.C.parse(e.Y,null===h?2048:h.t);if(16&s.flags){const bindable=s.bindables[e.target];void 0!==bindable?(s.q.push(new BindingSymbol(h,bindable,t,e.Y,e.target)),s.W=1):null!==t&&(s.attributes.push(new PlainAttributeSymbol(e,h,t)),s.W=1)}else null!==t||"ref"===e.target?(s.attributes.push(new PlainAttributeSymbol(e,h,t)),s.W=1):s===this.A&&s.attributes.push(new PlainAttributeSymbol(e,h,t))}m(e){const name=e.getAttribute("replace-part");return null===name?null:(e.removeAttribute("replace-part"),new ReplacePartSymbol(name))}}e("TemplateBinder",TemplateBinder);class c{constructor(e){this.input=e,this.index=0,this.length=e.length}}const n=String.fromCharCode,ITemplateElementFactory=e("ITemplateElementFactory",DI.ee("ITemplateElementFactory").S());class r{constructor(dom){this.dom=dom,this.template=dom.N()}N(e){if("string"==typeof e){const template=this.template;template.innerHTML=e;const h=template.content.firstElementChild;return null===h||"TEMPLATE"!==h.nodeName||null!==h.nextElementSibling?(this.template=this.dom.N(),template):(template.content.removeChild(h),h)}if("TEMPLATE"!==e.nodeName){const template=this.dom.N();return template.content.appendChild(e),template}return null!==e.parentNode&&e.parentNode.removeChild(e),e}}r.inject=[IDOM];const i=Object.freeze({required:0,compiler:"default"});class f{constructor(e,h,s){this.he=e,this.$=h,this.C=s,this.se=null}get name(){return"default"}compile(dom,e,h){const s=new TemplateBinder(dom,new ResourceModel(h),this.$,this.C),template=e.template=this.he.N(e.template),t=s.bind(template);void 0!==e.instructions&&e.instructions!==PLATFORM.te||(e.instructions=[]),1==t.hasSlots&&(e.hasSlots=1),this.se=e.instructions;const l=t.attributes,c=l.length;if(c>0){let surrogates;void 0!==e.surrogates&&e.surrogates!==PLATFORM.te||(e.surrogates=Array(c)),surrogates=e.surrogates;for(let e=0;c>e;++e)surrogates[e]=this.le(l[e])}return this.ce(t),this.se=null,e}ce(e){if(8192&e.flags){const{childNodes}=e;let h;const s=childNodes.length;for(let e=0;s>e;++e)if(128&(h=childNodes[e]).flags)this.se.push([new TextBindingInstruction(h.ne)]);else if(32&h.flags){const e=h.q,instructions=[];let s;const t=e.length;for(let h=0;t>h;++h)instructions[h]=new LetBindingInstruction((s=e[h]).l,s.target);this.se.push([new LetElementInstruction(instructions,h.toViewModel)])}else this.re(h)}}ie(e){const h=this.fe(e,1);h[0]=new HydrateElementInstruction(e.res,this.oe(e),this.ue(e)),this.se.push(h)}we(e){const h=this.fe(e,0);h.length>0&&this.se.push(h),this.ce(e)}re(e){switch(511&e.flags){case 16:this.ie(e);break;case 64:this.we(e);break;case 1:this.ke(e)}}ke(e){const h=this.oe(e),s=this.se,t=this.se=[];this.re(e.template),this.se=s,this.se.push([new HydrateTemplateController({name:null===e.B?e.res:e.B,template:e.P,instructions:t,build:i},e.res,h,"else"===e.res)])}oe(e){let h;if(4096&e.flags){const{q:s}=e,t=s.length;h=Array(t);let l=0;for(;t>l;++l)h[l]=this.Ee(s[l])}else h=PLATFORM.te;return h}Ee(e){return null===e.command?null===e.l?new SetPropertyInstruction(e.Y,e.bindable.Te):new InterpolationInstruction(e.l,e.bindable.Te):e.command.compile(e)}fe(e,h){let s;if(2048&e.flags){const{attributes:t}=e,l=t.length;s=Array(h+l);for(let e=0;l>e;++e)s[e+h]=this.le(t[e])}else s=h>0?Array(h):PLATFORM.te;return s}$e(e){const h=this.oe(e);return new HydrateAttributeInstruction(e.res,h)}Ce(e){return null===e.command?null===e.l?new SetAttributeInstruction(e.j.Y,e.j.target):new InterpolationInstruction(e.l,e.j.target):e.command.compile(e)}le(e){return"ref"===e.j.target?new RefBindingInstruction(e.j.Y):4&e.flags?this.$e(e):this.Ce(e)}ue(e){let parts;if(16384&e.flags){parts={};const h=e.parts,s=h.length;let t,l,c;for(let e=0;s>e;++e)c=h[e],t=this.se,l=this.se=[],this.re(c.template),parts[c.name]={name:c.name,template:c.P,instructions:l,build:i},this.se=t}else parts=PLATFORM.Ae;return parts}}f.inject=[ITemplateElementFactory,IAttributeParser,IExpressionParser];const o=[TriggerBindingCommand,DelegateBindingCommand,CaptureBindingCommand],HTMLJitConfiguration=e("HTMLJitConfiguration",{register(e){e.register(HTMLRuntimeConfiguration,JitConfiguration,Registration.singleton(ITemplateCompiler,f),Registration.singleton(ITemplateElementFactory,r),...o)},ve(){const e=DI.ve();return e.register(HTMLJitConfiguration),e}})}}});
