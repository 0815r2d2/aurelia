(function(t,s){"object"==typeof exports&&"undefined"!=typeof module?s(exports,require("@aurelia/kernel"),require("@aurelia/runtime")):"function"==typeof define&&define.t?define(["exports","@aurelia/kernel","@aurelia/runtime"],s):s((t=t||self).runtimeHtml={},t.kernel,t.runtime)})(this,function(t,kernel,runtime){"use strict";function s(t,s,i,h){var n,e,r=arguments.length,o=3>r?s:null===h?h=Object.getOwnPropertyDescriptor(s,i):h;if("object"==typeof Reflect&&"function"==typeof Reflect.s)o=Reflect.s(t,s,i,h);else for(e=t.length-1;e>=0;e--)(n=t[e])&&(o=(3>r?n(o):r>3?n(s,i,o):n(s,i))||o);return r>3&&o&&Object.defineProperty(s,i,o),o}function i(t){return t.i&&t.i()[0]||t.h&&t.h()[0]||t.path&&t.path[0]||t.target}function h(){this.o(),this.l=1}function n(t){t.l=0;let s=i(t);const n=[];for(;s;){if(s.u){const i=s.u[t.type];i&&(t.stopPropagation!==h&&(t.o=t.stopPropagation,t.stopPropagation=h),n.push(i))}s=s.parentNode}for(let s=n.length-1;s>=0&&!t.l;s--){const i=n[s];"handleEvent"in i?i.g(t):i(t)}}function e(t){t.l=0;let s=i(t);for(;s&&!t.l;){if(s.p){const i=s.p[t.type];i&&(t.stopPropagation!==h&&(t.o=t.stopPropagation,t.stopPropagation=h),"handleEvent"in i?i.g(t):i(t))}s=s.parentNode}}function r(t,s){return t===s}function o(t){const s=i(t);if(this.target===s)return this.m(t)}function isHTMLTargetedInstruction(value){const type=value.type;return"string"==typeof type&&2===type.length}function createElement(dom,t,s,i){return"string"==typeof t?(function(dom,s,i,h){const instructions=[],n=[],dependencies=[],e=dom.createElement(t);let r=0;return i&&Object.keys(i).forEach(to=>{const value=i[to];isHTMLTargetedInstruction(value)?(r=1,instructions.push(value)):dom.setAttribute(e,to,value)}),r&&(dom.v(e),n.push(instructions)),h&&c(dom,e,h,n,dependencies),new RenderPlan(dom,e,n,dependencies)})(dom,0,s,i):(function(dom,t,s,i){const h=t.description.name,instructions=[],n=[instructions],dependencies=[],e=[],bindables=t.description.bindables,r=dom.createElement(h);return dom.v(r),dependencies.includes(t)||dependencies.push(t),instructions.push(new runtime.HydrateElementInstruction(h,e)),s&&Object.keys(s).forEach(to=>{const value=s[to];if(isHTMLTargetedInstruction(value))e.push(value);else{e.push(bindables[to]?{type:"re",to,value}:new SetAttributeInstruction(value,to))}}),i&&c(dom,r,i,n,dependencies),new RenderPlan(dom,r,n,dependencies)})(dom,t,s,i)}function c(dom,t,s,i,dependencies){for(let h=0,n=s.length;n>h;++h){const n=s[h];switch(typeof n){case"string":dom.appendChild(t,dom.createTextNode(n));break;case"object":dom.C(n)?dom.appendChild(t,n):"mergeInto"in n&&n.j(t,i,dependencies)}}}var l,u;class Listener{constructor(dom,t,s,i,h,preventDefault,n,e){this.dom=dom,this.A=null,this.M=null,this.$state=0,this.O=s,this.T=e,this.preventDefault=preventDefault,this.k=i,this.target=h,this.L=t,this.V=n}N(t){const s=this.$scope.S;s.R=t;const i=this.k.evaluate(runtime.LifecycleFlags.B,this.$scope,this.T);return delete s.R,1!=i&&this.preventDefault&&t.preventDefault(),i}g(t){this.N(t)}U(t,s){if(2&this.$state){if(this.$scope===s)return;this.q(t|runtime.LifecycleFlags.F)}this.$state|=1,this.$scope=s;const i=this.k;runtime.hasBind(i)&&i.bind(t,s,this),this.G=this.V.addEventListener(this.dom,this.target,this.L,this,this.O),this.$state|=2,this.$state&=-2}q(t){if(!(2&this.$state))return;this.$state|=64;const s=this.k;runtime.hasUnbind(s)&&s.H(t,this.$scope,this),this.$scope=null,this.G.I(),this.G=null,this.$state&=-67}X(t,s){}Z(t,s,i){}}t.AttributeNSAccessor=class{constructor(t,s,i,h,n){this.$=1,this.attributeName=h,this._=t,this.D=s,this.oldValue=this.J=this.K(),this.P=i,this.W=n}K(){return this.D.getAttributeNS(this.W,this.attributeName)}Y(t){this.D.setAttributeNS(this.W,this.attributeName,t)}},t.AttributeNSAccessor=s([runtime.targetObserver("")],t.AttributeNSAccessor);const a=runtime.LifecycleFlags.tt|runtime.LifecycleFlags.st,f=runtime.LifecycleFlags.it|runtime.LifecycleFlags.ht,w=(t,s)=>t===s;t.CheckedObserver=class{constructor(t,s,i,h){this.$=1,this.G=i,this._=t,this.D=s,this.nt=h}K(){return this.J}Y(t,s){this.et||(this.et=this.D.rt&&(this.D.rt.ot||this.D.rt.value),this.et&&this.et.subscribe(this)),this.ct&&(this.ct.lt(this),this.ct=null),"checkbox"===this.D.type&&Array.isArray(t)&&(this.ct=this.nt.ut(t),this.ct.at(this)),this.ft()}wt(){this.ft(),this.dt(f)}Z(t,s,i){this.ft(),this.dt(i)}ft(){const value=this.J,t=this.D,s=t.hasOwnProperty("model")?t.ot:t.value,i=t.bt||w;t.checked="radio"===t.type?!!i(value,s):1==value?1:Array.isArray(value)?-1!==value.findIndex(t=>!!i(t,s)):0}dt(t){t&runtime.LifecycleFlags.F||this.J!==this.oldValue&&this.gt(this.J,this.oldValue,t)}g(){let value=this.J;const t=this.D,s=t.hasOwnProperty("model")?t.ot:t.value;let i;const h=t.bt||w;if("checkbox"===t.type){if(Array.isArray(value))return i=value.findIndex(t=>!!h(t,s)),void(t.checked&&-1===i?value.push(s):t.checked||-1===i||value.splice(i,1));value=t.checked}else{if(!t.checked)return;value=s}this.oldValue=this.J,this.J=value,this.dt(a)}subscribe(t){this.pt()||this.G.subscribe(this.D,this),this.vt(t)}unsubscribe(t){this.Ct(t)&&!this.pt()&&this.G.I()}H(){this.ct&&(this.ct.lt(this),this.ct=null),this.et&&this.et.unsubscribe(this)}},t.CheckedObserver=s([runtime.targetObserver()],t.CheckedObserver),t.ClassAttributeAccessor=class{constructor(t,s){this.$=1,this.Et=1,this._=t,this.jt=null,this.D=s,this.version=0}K(){return this.J}Y(t){const s=this.jt||{};let i,name,h=this.version;if(t.length){const n=this.D;for(let e=0,r=(i=t.split(/\s+/)).length;r>e;e++)(name=i[e]).length&&(s[name]=h,n.classList.add(name))}if(this.jt=s,this.version+=1,0!==h)for(name in h-=1,s)s.hasOwnProperty(name)&&s[name]===h&&this.D.classList.remove(name)}},t.ClassAttributeAccessor=s([runtime.targetObserver("")],t.ClassAttributeAccessor),t.DataAttributeAccessor=class{constructor(t,s,i){this.$=1,this._=t,this.D=s,this.oldValue=this.J=this.K(),this.P=i}K(){return this.D.getAttribute(this.P)}Y(t){null===t?this.D.removeAttribute(this.P):this.D.setAttribute(this.P,t)}},t.DataAttributeAccessor=s([runtime.targetObserver()],t.DataAttributeAccessor),t.ElementPropertyAccessor=class{constructor(t,s,i){this.$=1,this._=t,this.D=s,this.P=i}K(){return this.D[this.P]}Y(value){this.D[this.P]=value}},t.ElementPropertyAccessor=s([runtime.targetObserver("")],t.ElementPropertyAccessor);class ListenerTracker{constructor(dom,t,s,i){this.dom=dom,this.At=i,this.count=0,this.Mt=t,this.listener=s}Ot(){this.count++,1===this.count&&this.dom.addEventListener(this.Mt,this.listener,null,this.At)}Tt(){this.count--,0===this.count&&this.dom.removeEventListener(this.Mt,this.listener,null,this.At)}}class DelegateOrCaptureSubscription{constructor(t,s,i,h){this.kt=t,this.Lt=s,this.L=i,s[i]=h}I(){this.kt.Tt(),this.Lt[this.L]=null}}class TriggerSubscription{constructor(dom,t,s,i){this.dom=dom,this.target=t,this.L=s,this.Vt=i,dom.addEventListener(s,i,t)}I(){this.dom.removeEventListener(this.L,this.Vt,this.target)}}class EventSubscriber{constructor(dom,t){this.dom=dom,this.Nt=t,this.target=null,this.G=null}subscribe(t,s){this.target=t,this.G=s;const i=this.dom.addEventListener,h=this.Nt;for(let n=0,e=h.length;e>n;++n)i(h[n],s,t)}I(){const t=this.target,s=this.G,i=this.Nt,h=this.dom.removeEventListener;for(let n=0,e=i.length;e>n;++n)h(i[n],s,t);this.target=this.G=null}}const IEventManager=kernel.DI.Rt("IEventManager").St(t=>t.singleton(d));class d{constructor(){this.yt={},this.zt={},this.Bt={}}addEventListener(dom,t,s,i,strategy){let h,r,o;if(strategy===runtime.DelegationStrategy.Ut){(o=(h=this.zt)[s]||(h[s]=new ListenerTracker(dom,s,e,0))).Ot();const n=t.p||(t.p={});return new DelegateOrCaptureSubscription(o,n,s,i)}if(strategy===runtime.DelegationStrategy.qt){(o=(r=this.Bt)[s]||(r[s]=new ListenerTracker(dom,s,n,1))).Ot();const h=t.u||(t.u={});return new DelegateOrCaptureSubscription(o,h,s,i)}return new TriggerSubscription(dom,t,s,i)}}const b=runtime.LifecycleFlags.tt|runtime.LifecycleFlags.st,g={Ft:1,Gt:1,Ht:1};t.SelectValueObserver=class{constructor(t,s,i,h){this.$=1,this._=t,this.D=s,this.G=i,this.nt=h}K(){return this.J}Y(t,s){const i=Array.isArray(t);if(!i&&null!=t&&this.D.multiple)throw Error("Only null or Array instances can be bound to a multi-select.");this.ct&&(this.ct.lt(this),this.ct=null),i&&(this.ct=this.nt.ut(t),this.ct.at(this)),this.It(),this.dt(s)}wt(t){this.It(t)}Z(t,s,i){this.Xt(t,i)}dt(t){if(t&runtime.LifecycleFlags.F)return;const s=this.oldValue,i=this.J;i!==s&&this.gt(i,s,t)}g(){this.Zt()&&this.dt(b)}It(t){const s=this.J,i=Array.isArray(s),h=this.D,n=h.bt||r,e=h.options;let o=e.length;for(;o--;){const t=e[o],h=t.hasOwnProperty("model")?t.ot:t.value;t.selected=i?-1!==s.findIndex(t=>!!n(h,t)):!!n(h,s)}}Zt(){const t=this.D,s=t.options,i=s.length,h=this.J;let n=0;if(t.multiple){if(!Array.isArray(h))return 1;let e;const o=t.bt||r,c=[];for(;i>n;)(e=s[n]).selected&&c.push(e.hasOwnProperty("model")?e.ot:e.value),++n;for(n=0;h.length>n;){const t=h[n];-1===c.findIndex(s=>!!o(t,s))?h.splice(n,1):++n}for(n=0;c.length>n;){const t=c[n];-1===h.findIndex(s=>!!o(t,s))&&h.push(t),++n}return 0}let value=null;for(;i>n;){const t=s[n];if(t.selected){value=t.hasOwnProperty("model")?t.ot:t.value;break}++n}return this.oldValue=this.J,this.J=value,1}subscribe(t){this.pt()||this.G.subscribe(this.D,this),this.vt(t)}unsubscribe(t){this.Ct(t)&&!this.pt()&&this.G.I()}bind(){this.$t=new MutationObserver(this._t.bind(this)),this.$t.observe(this.D,g)}H(){this.$t.disconnect(),this.$t=null,this.ct&&(this.ct.lt(this),this.ct=null)}_t(){this.It(),this.Zt()&&this.dt(b)}},t.SelectValueObserver=s([runtime.targetObserver()],t.SelectValueObserver),t.StyleAttributeAccessor=class{constructor(t,s){this.$=1,this.oldValue=this.J=s.style.cssText,this._=t,this.D=s,this.Dt=null,this.version=0}K(){return this.D.style.cssText}Jt(t,value){let s="";null!=value&&"function"==typeof value.indexOf&&-1!==value.indexOf("!important")&&(s="important",value=value.replace("!important","")),this.D.style.setProperty(t,value,s)}Y(t){const s=this.Dt||{};let i,h=this.version;if(null!==t)if(t instanceof Object){let value;for(i in t)t.hasOwnProperty(i)&&(value=t[i],s[i=i.replace(/([A-Z])/g,t=>`-${t.toLowerCase()}`)]=h,this.Jt(i,value))}else if(t.length){const n=/\s*([\w\-]+)\s*:\s*((?:(?:[\w\-]+\(\s*(?:"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[\w\-]+\(\s*(?:[^"](?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^\)]*)\),?|[^\)]*)\),?|"(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^;]*),?\s*)+);?/g;let e;for(;null!==(e=n.exec(t));)(i=e[1])&&(s[i]=h,this.Jt(i,e[2]))}if(this.Dt=s,this.version+=1,0!==h)for(i in h-=1,s)s.hasOwnProperty(i)&&s[i]===h&&this.D.style.removeProperty(i)}},t.StyleAttributeAccessor=s([runtime.targetObserver()],t.StyleAttributeAccessor);const p={button:"",Kt:"on",color:"#000000",Pt:"",Qt:"",email:"",Wt:"",hidden:"",Yt:"",xt:"",number:"",password:"",ts:"on",range:"50",reset:"",search:"",submit:"",tel:"",text:"",time:"",url:"",ss:""},m=runtime.LifecycleFlags.tt|runtime.LifecycleFlags.st;t.ValueAttributeObserver=class{constructor(t,s,i,h){if(this.$=1,this.G=h,this._=t,this.D=s,this.P=i,"value"===i){const t=s.type;this.defaultValue=p[t||"text"],"file"===t&&(this.flush=this.hs)}else this.defaultValue="";this.oldValue=this.J=s[i]}K(){return this.D[this.P]}Y(t,s){this.D[this.P]=t,s&runtime.LifecycleFlags.F||this.gt(this.J,this.oldValue,s)}g(){const t=this.oldValue=this.J,s=this.J=this.K();t!==s&&(this.gt(s,t,m),this.oldValue=s)}subscribe(t){this.pt()||(this.oldValue=this.K(),this.G.subscribe(this.D,this)),this.vt(t)}unsubscribe(t){this.Ct(t)&&!this.pt()&&this.G.I()}hs(){const t=this.J;this.oldValue!==t&&""===t&&(this.Y(t,this.ns),this.oldValue=this.J)}},t.ValueAttributeObserver=s([runtime.targetObserver("")],t.ValueAttributeObserver);const v="http://www.w3.org/1999/xlink",C="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/2000/xmlns/",j=((l=Object.create(null))["es"]=["actuate",v],l["rs"]=["arcrole",v],l["os"]=["href",v],l["cs"]=["role",v],l["ls"]=["show",v],l["us"]=["title",v],l["as"]=["type",v],l["fs"]=["lang",C],l["ws"]=["space",C],l.ds=["xmlns",E],l["bs"]=["xlink",E],l),A=["change","input"],M=["change"],O=["change","input","blur","keyup","paste"],T=["scroll"],k=(function(t){return t.gs=1,t.style=1,t.ps=1,t.checked=1,t.value=1,t.ot=1,t["es"]=1,t["rs"]=1,t["os"]=1,t["cs"]=1,t["ls"]=1,t["us"]=1,t["as"]=1,t["fs"]=1,t["ws"]=1,t.ds=1,t["bs"]=1,t})(Object.create(null));class TargetObserverLocator{constructor(dom){this.dom=dom}ms(s,i,h,n){switch(n){case"checked":return new t.CheckedObserver(s,h,new EventSubscriber(this.dom,A),i);case"value":return"SELECT"===h.tagName?new t.SelectValueObserver(s,h,new EventSubscriber(this.dom,M),i):new t.ValueAttributeObserver(s,h,n,new EventSubscriber(this.dom,A));case"files":return new t.ValueAttributeObserver(s,h,n,new EventSubscriber(this.dom,A));case"textContent":case"innerHTML":return new t.ValueAttributeObserver(s,h,n,new EventSubscriber(this.dom,O));case"scrollTop":case"scrollLeft":return new t.ValueAttributeObserver(s,h,n,new EventSubscriber(this.dom,T));case"class":return new t.ClassAttributeAccessor(s,h);case"style":case"css":return new t.StyleAttributeAccessor(s,h);case"model":return new runtime.SetterObserver(h,n);case"role":return new t.DataAttributeAccessor(s,h,n);default:if(void 0!==j[n]){const i=j[n];return new t.AttributeNSAccessor(s,h,n,i[0],i[1])}const e=n.slice(0,5);if("aria-"===e||"data-"===e)return new t.DataAttributeAccessor(s,h,n)}return null}vs(t,s){return 1==k[s]}Cs(t){return this.dom.C(t)}}TargetObserverLocator.inject=[runtime.IDOM];class TargetAccessorLocator{constructor(dom){this.dom=dom}Es(s,i,h){switch(h){case"textContent":return new t.ElementPropertyAccessor(s,i,h);case"class":return new t.ClassAttributeAccessor(s,i);case"style":case"css":return new t.StyleAttributeAccessor(s,i);case"src":case"href":case"role":return new t.DataAttributeAccessor(s,i,h);default:if(void 0!==j[h]){const n=j[h];return new t.AttributeNSAccessor(s,i,h,n[0],n[1])}const n=h.slice(0,5);return"aria-"===n||"data-"===n?new t.DataAttributeAccessor(s,i,h):new t.ElementPropertyAccessor(s,i,h)}}Cs(t){return this.dom.C(t)}}TargetAccessorLocator.inject=[runtime.IDOM];const ISVGAnalyzer=kernel.DI.Rt("ISVGAnalyzer").St(t=>t.singleton(class{js(t,s){return 0}}));class AttrBindingBehavior{bind(s,i,h){h.targetObserver=new t.DataAttributeAccessor(h.T.get(runtime.ILifecycle),h.target,h.As)}H(t,s,i){}}runtime.BindingBehaviorResource.Ms("attr",AttrBindingBehavior);class SelfBindingBehavior{bind(t,s,i){if(!i.N||!i.L)throw kernel.Reporter.error(8);i.m=i.N,i.N=o}H(t,s,i){i.N=i.m,i.m=null}}runtime.BindingBehaviorResource.Ms("self",SelfBindingBehavior);class UpdateTriggerBindingBehavior{constructor(t){this.nt=t}bind(t,s,i,...h){if(0===h.length)throw kernel.Reporter.error(9);if(i.mode!==runtime.BindingMode.Os&&i.mode!==runtime.BindingMode.Ts)throw kernel.Reporter.error(10);const targetObserver=this.nt.ms(i.target,i.As);if(!targetObserver.G)throw kernel.Reporter.error(10);i.targetObserver=targetObserver,targetObserver.ks=i.targetObserver.G,targetObserver.G=new EventSubscriber(i.T.get(runtime.IDOM),h)}H(t,s,i){i.targetObserver.G.I(),i.targetObserver.G=i.targetObserver.ks,i.targetObserver.ks=null}}UpdateTriggerBindingBehavior.inject=[runtime.IObserverLocator],runtime.BindingBehaviorResource.Ms("updateTrigger",UpdateTriggerBindingBehavior);class SetAttributeInstruction{constructor(value,to){this.type="hd",this.to=to,this.value=value}}class RenderPlan{constructor(dom,t,instructions,dependencies){this.dom=dom,this.dependencies=dependencies,this.instructions=instructions,this.Ls=t}get Vs(){return this.Ns||(this.Ns=runtime.buildTemplateDefinition(null,null,this.Ls,null,"string"==typeof this.Ls,null,this.instructions,this.dependencies))}Ss(t,s){return t.Ss(this.dom,this.Vs,null,s)}Rs(t,s){return this.ys(t,s).create()}ys(t,s){return t.ys(this.dom,this.Vs,s)}j(t,instructions,dependencies){this.dom.appendChild(t,this.Ls),instructions.push(...this.instructions),dependencies.push(...this.dependencies)}}const L=["subject","composing"];class Compose{constructor(dom,t,s,i,h){this.dom=dom,this.subject=null,this.zs=0,this.Bs=h,this.Us=null,this.qs=t,this.Fs=i,this.Bs.Gs=(()=>{this.zs=0}),this.properties=s.instructions.filter(t=>!L.includes(t.to)).reduce((t,s)=>(s.to&&(t[s.to]=s),t),{})}Hs(t){this.Is(this.subject,null,t),this.Bs.Hs(t,this.$scope)}Xs(t){this.Bs.Xs(t)}Zs(t){this.Bs.Zs(t)}$s(t){this.Us=null,this.Bs.$s(t)}_s(t){this.Bs._s(t)}Ds(t,s,i){this.Is(t,s,i)}Is(t,s,i){this.Us!==t&&(this.Us=t,t=t instanceof Promise?t.then(t=>this.Js(t,i)):this.Js(t,i),this.zs=1,this.Bs.Ks(t,i))}Js(t,s){const i=this.Ps(t);return i?(i.Qs(this.Ws.host),i.Ys(this.qs.$scope),i):null}Ps(t){return t?"lockScope"in t?t:"createView"in t?t.Rs(this.Fs,this.qs.$context):"create"in t?t.create():"template"in t?this.Fs.ys(this.dom,t,this.qs.$context).create():createElement(this.dom,t,this.properties,this.Ws.children).Rs(this.Fs,this.qs.$context):null}}Compose.inject=[runtime.IDOM,runtime.IRenderable,runtime.ITargetedInstruction,runtime.IRenderingEngine,runtime.CompositionCoordinator],s([runtime.bindable],Compose.prototype,"subject",void 0),s([runtime.bindable],Compose.prototype,"composing",void 0),runtime.CustomElementResource.Ms({name:"au-compose",containerless:1},Compose);class HTMLDOM{constructor(t){this.xs=t}addEventListener(t,s,i,h){(i||this.xs).addEventListener(t,s,h)}appendChild(t,s){t.appendChild(s)}cloneNode(t,s){return t.cloneNode(0!=s)}ti(t){if(this.si(t))return t;if(null===t.parentNode)throw kernel.Reporter.error(52);const s=this.xs.createComment("au-end"),i=this.xs.createComment("au-start");return t.parentNode.replaceChild(s,t),s.parentNode.insertBefore(i,s),s.ii=i,i.$nodes=null,s}createDocumentFragment(t){if(null==t)return this.xs.createDocumentFragment();if(this.C(t)){if(void 0!==t.content)return t.content;const s=this.xs.createDocumentFragment();return s.appendChild(t),s}return this.hi(t).content}createElement(name){return this.xs.createElement(name)}hi(t){if(null==t)return this.xs.createElement("template");const template=this.xs.createElement("template");return template.innerHTML=""+t,template}createTextNode(t){return this.xs.createTextNode(t)}insertBefore(t,s){s.parentNode.insertBefore(t,s)}ni(t){return"AU-M"===t.nodeName}C(t){return t.nodeType>0}si(t){return"au-end"===t.textContent}v(t){t.className="au"}ei(t,s){t.ri(runtime.INode,s),t.ri(Node,s),t.ri(Element,s),t.ri(HTMLElement,s),t.ri(SVGElement,s)}remove(t){t.remove?t.remove():t.parentNode.removeChild(t)}removeEventListener(t,s,i,h){(i||this.xs).removeEventListener(t,s,h)}setAttribute(t,name,value){t.setAttribute(name,value)}}class V{constructor(dom,t){this.dom=dom,this.firstChild=t,this.lastChild=t,this.childNodes=[t],this.targets=[new R(t)]}oi(){return this.targets}insertBefore(t){t.parentNode.insertBefore(this.firstChild,t)}ci(t){t.appendChild(this.firstChild)}remove(){this.firstChild.remove()}}class N{constructor(dom,t){this.dom=dom,this.li=t;const s=t.querySelectorAll(".au");let i=0,h=s.length;const targets=this.targets=Array(h);for(;h>i;){const t=s[i];targets[i]="AU-M"===t.nodeName?this.dom.ti(t):t,++i}const n=t.childNodes;i=0;const childNodes=this.childNodes=Array(h=n.length);for(;h>i;)childNodes[i]=n[i],++i;this.firstChild=t.firstChild,this.lastChild=t.lastChild,this.start=this.end=null}oi(){return this.targets}insertBefore(t){if(t.parentNode.insertBefore(this.li,t),"au-end"===t.textContent){this.end=t;const s=this.start=t.ii;s.$nodes=null===s.$nodes?this:kernel.PLATFORM.ui}}ci(t){t.appendChild(this.li),this.start=this.end=null}remove(){const t=this.li;if(null!==this.start&&this.start.$nodes===this){const s=this.end;let i,h=this.start.nextSibling;for(;h!==s;)i=h.nextSibling,t.appendChild(h),h=i;this.start.$nodes=null,this.start=this.end=null}else{let s=this.firstChild;if(s.parentNode!==t){const i=this.lastChild;let h;for(;null!==s&&(h=s.nextSibling,t.appendChild(s),s!==i);)s=h}}}}class S{constructor(dom,t){this.dom=dom;const s=dom.createDocumentFragment(t),childNodes=s.childNodes;switch(childNodes.length){case 0:return void(this.ai=(()=>runtime.NodeSequence.empty));case 2:const t=childNodes[0];if("AU-M"===t.nodeName||"#comment"===t.nodeName){const t=childNodes[1];if(3===t.nodeType&&0===t.textContent.length)return this.fi=0,this.Ls=t,void(this.wi=V)}default:this.fi=1,this.Ls=s,this.wi=N}}ai(){return new this.wi(this.dom,this.Ls.cloneNode(this.fi))}}class R{get parentNode(){return this.nextSibling.parentNode}constructor(t){this.nextSibling=t,this.textContent=""}remove(){}}(u=R.prototype).previousSibling=null,u.childNodes=kernel.PLATFORM.di,u.nodeName="AU-M",u.nodeType=1;class y{constructor(t){this.bi=t}initialize(t){if(this.bi.has(runtime.IDOM,0))return this.bi.get(runtime.IDOM);let dom;return dom=void 0!==t?void 0!==t.dom?t.dom:new HTMLDOM(null!==t.host.ownerDocument?t.host.ownerDocument:document):new HTMLDOM(document),kernel.Registration.gi(runtime.IDOM,dom).register(this.bi,runtime.IDOM),dom}}y.inject=[kernel.IContainer];class z{constructor(dom){this.dom=dom}create(t,s){return new runtime.CompiledTemplate(this.dom,s,new S(this.dom,s.template),t)}}z.inject=[runtime.IDOM];let B=class{constructor(t,s){this.pi=t,this.nt=s}mi(dom,t,s,i,h){const n=i.nextSibling;let bindable;dom.ni(i)&&dom.remove(i);const e=runtime.ensureExpression(this.pi,h.from,2048);bindable=e.vi?new runtime.MultiInterpolationBinding(this.nt,e,n,"textContent",runtime.BindingMode.Ci,t):new runtime.InterpolationBinding(e.Ei,e,n,"textContent",runtime.BindingMode.Ci,this.nt,t,1),runtime.addBindable(s,bindable)}};B.inject=[runtime.IExpressionParser,runtime.IObserverLocator],B=s([runtime.instructionRenderer("ha")],B);let U=class{constructor(t,s){this.pi=t,this.V=s}mi(dom,t,s,i,h){const n=runtime.ensureExpression(this.pi,h.from,80|h.strategy+6),bindable=new Listener(dom,h.to,h.strategy,n,i,h.preventDefault,this.V,t);runtime.addBindable(s,bindable)}};U.inject=[runtime.IExpressionParser,IEventManager],U=s([runtime.instructionRenderer("hb")],U);let q=class{mi(dom,t,s,i,h){i.setAttribute(h.to,h.value)}};q=s([runtime.instructionRenderer("hd")],q);let F=class{constructor(t,s){this.pi=t,this.nt=s}mi(dom,t,s,i,h){const n=runtime.ensureExpression(this.pi,h.from,48|runtime.BindingMode.Ci),bindable=new runtime.Binding(n,i.style,h.to,runtime.BindingMode.Ci,this.nt,t);runtime.addBindable(s,bindable)}};F.inject=[runtime.IExpressionParser,runtime.IObserverLocator],F=s([runtime.instructionRenderer("hc")],F);const HTMLRenderer={register(t){t.register(B,U,q,F)}},G={mode:"open"};class H{ji(dom,t,host,def){if(def.shadowOptions||def.hasSlots){if(def.containerless)throw kernel.Reporter.error(21);return new X(t,host,def)}return def.containerless?new Z(dom,t,host):new $(t,host)}}const I={Ft:1};class X{constructor($customElement,host,t){let shadowOptions;this.host=host,this.shadowRoot=host.Ai(shadowOptions=null!=t.shadowOptions&&"object"==typeof t.shadowOptions&&"mode"in t.shadowOptions?t.shadowOptions:G),this.host.$customElement=$customElement,this.shadowRoot.$customElement=$customElement}get children(){return this.shadowRoot.childNodes}Mi(t){new MutationObserver(t).observe(this.shadowRoot,I)}Oi(){return this.shadowRoot}Ti(t){t.ci(this.shadowRoot)}ki(t){t.remove()}}class Z{constructor(dom,$customElement,host){this.childNodes=host.childNodes.length?kernel.PLATFORM.toArray(host.childNodes):kernel.PLATFORM.di,this.host=dom.ti(host),this.host.$customElement=$customElement}get children(){return this.childNodes}Mi(t){new MutationObserver(t).observe(this.host,I)}Oi(){return this.host.Li()}Ti(t){t.insertBefore(this.host)}ki(t){t.remove()}}class ${constructor($customElement,host){this.host=host,this.host.$customElement=$customElement}get children(){return this.host.childNodes}Mi(t){}Oi(){return this.host.Li()}Ti(t){t.ci(this.host)}ki(t){t.remove()}}const _=[AttrBindingBehavior,SelfBindingBehavior,UpdateTriggerBindingBehavior,Compose],HTMLRuntimeConfiguration={register(t){t.register(..._,runtime.RuntimeConfiguration,HTMLRenderer,kernel.Registration.singleton(runtime.IDOMInitializer,y),kernel.Registration.singleton(runtime.IProjectorLocator,H),kernel.Registration.singleton(runtime.ITargetAccessorLocator,TargetAccessorLocator),kernel.Registration.singleton(runtime.ITargetObserverLocator,TargetObserverLocator),kernel.Registration.singleton(runtime.ITemplateFactory,z))},Vi(){const t=kernel.DI.Vi();return t.register(HTMLRuntimeConfiguration),t}};t.Listener=Listener,t.ListenerTracker=ListenerTracker,t.DelegateOrCaptureSubscription=DelegateOrCaptureSubscription,t.TriggerSubscription=TriggerSubscription,t.IEventManager=IEventManager,t.EventSubscriber=EventSubscriber,t.TargetAccessorLocator=TargetAccessorLocator,t.TargetObserverLocator=TargetObserverLocator,t.ISVGAnalyzer=ISVGAnalyzer,t.AttrBindingBehavior=AttrBindingBehavior,t.SelfBindingBehavior=SelfBindingBehavior,t.UpdateTriggerBindingBehavior=UpdateTriggerBindingBehavior,t.Compose=Compose,t.HTMLRuntimeConfiguration=HTMLRuntimeConfiguration,t.createElement=createElement,t.RenderPlan=RenderPlan,t.isHTMLTargetedInstruction=isHTMLTargetedInstruction,t.HTMLDOM=HTMLDOM,t.HTMLRenderer=HTMLRenderer,t.CaptureBindingInstruction=class{constructor(from,to){this.type="hb",this.from=from,this.preventDefault=0,this.strategy=runtime.DelegationStrategy.qt,this.to=to}},t.DelegateBindingInstruction=class{constructor(from,to){this.type="hb",this.from=from,this.preventDefault=0,this.strategy=runtime.DelegationStrategy.Ut,this.to=to}},t.SetAttributeInstruction=SetAttributeInstruction,t.StylePropertyBindingInstruction=class{constructor(from,to){this.type="hc",this.from=from,this.to=to}},t.TextBindingInstruction=class{constructor(from){this.type="ha",this.from=from}},t.TriggerBindingInstruction=class{constructor(from,to){this.type="hb",this.from=from,this.preventDefault=1,this.strategy=runtime.DelegationStrategy.Ni,this.to=to}},Object.defineProperty(t,"Si",{value:1})});
